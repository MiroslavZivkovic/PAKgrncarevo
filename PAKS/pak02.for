C=======================================================================
C
CE       READ DATA: BASE, BLOCKS, STEPS
CS       UCITAVANJE PODATAKA: OSNOVNI, BLOKOVI, KORACI
C
C   SUBROUTINE UCDATA
C              WRITUL
C              UCBLOK
C              UCPRIN
C              UCGRAF
C              UCVRKR
C              PRKOR
C
C=======================================================================
      SUBROUTINE UCDATA
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO READ BASIC DATA FOR THE PROBLEM
CE.        /1/-/9/ USER MANUAL
CS.    P R O G R A M
CS.        ZA UCITAVANJE OSNOVNIH PODATAKA O PROBLEMU
C
C ......................................................................
C
      include 'paka.inc'
      CHARACTER*250 ACOZ
      CHARACTER*250 NASLOV
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /DUZINA/ LMAX,MTOT,LMAXM,LRAD,NRAD
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /RESTAR/ TSTART,IREST
      COMMON /restap/ irestp,lplas0,lstaz0
      COMMON /NEBACK/ INDBACK
      COMMON /PRIMER/ IPRBR,INDIZL,INDGRA,INDNEU
      COMMON /CVOREL/ ICVEL,LCVEL,LELCV,NPA,NPI,LCEL,LELC,NMA,NMI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /DINAMI/ IMASS,IDAMP,PIP,DIP,MDVI
      COMMON /ITERAC/ METOD,MAXIT,TOLE,TOLS,TOLM,KONVE,KONVS,KONVM
      COMMON /ABSTOL/ TOLA
      COMMON /AUTSTP/ DTUK,ALFG,DELS,IAUTO,ITEOPT,KPNOD,KPDIR,KEQ
      COMMON /AUTSTK/ DELUM,DELFM,KRAJP
      COMMON /RSN   / DETER,IPIVOT,IDETER
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /MASINA/ INDPC,ICRTA
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /IMPERF/ NMODS,LIDIM,LSCIM,MODES
      COMMON /NASLOV/ NASLOV
      COMMON /SRPSKI/ ISRPS
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /CDEBUG/ IDEBUG
      COMMON /GEORGE/ TOLG,ALFAG,ICCGG
      COMMON /CRACKC/ CBTC(1000,2),NBTC(1000,3),KBTC,ICRACK,NBRCR
      COMMON /CRACKS/ CONTE,SINTE,FK123(10,3),NODCR(10,14),NCRACK,LQST,
     1                LNERING,LMIE,LPSI,LQ,N100,IRING,NSEG,MAXRIN,MAXSEG
     1                ,MAXNOD,LXL,LYL,LZL,LSIF1,LXGG,LYGG,LZGG,LNNOD
      COMMON /CRXFEM/ NCXFEM,LNODTIP,LNSSN,LPSIE,LFIE,LHNOD,
     1                LPSIC,LFI,LHZNAK,LNSSE,LKELEM,LID1,LID2
      COMMON /gocajo/ LNGG,KOJEB
      COMMON /AKUSTI/ ROAKUS,IAKUS
      COMMON /MIXEDM/ MIXED,IOPGS(6),NDS
      common /krutot/ nlnc,nkrt,mxvez,lnkt,llncvz,lnbv,lncgl,lnvez,
     1                lncvez,lac,limpc,ljmpc,livez,mxvc,mxrac,lxmass
      common /krut3d/ kt3d,mmpogr
      COMMON /NIDEAS/ IDEAS
      COMMON /smumps/ imumps,ipar
      COMMON /DRILLI/ EL14(4),EN14(3,4),IDRIL
      COMMON /MESLESS/ IGBM,ndif,idif(50),NKI,IKI(10)
      COMMON /COMEFG/ RADIJ,NBASE,NCVP,NPEFG,NCVS,NS,LCORS,LNOC,LNOS
      COMMON /CNPE/ NPE
      COMMON /ODUZPOM/ KODUZ
      COMMON /EXPLICITNA/ INDEXPL
      COMMON /NEWMARK/ ALFAM,BETAK,DAMPC,NEWACC
      COMMON /INDABC/ INDVB
      COMMON /DJERDAP/ IDJERDAP
      COMMON /SLOBAR/ IOPIT
      DIMENSION KART(6)
C
CE    S T A R T    N U M B E R   O F   P O I N T E R
CS    P O C E T N I   B R O J   R E P E R A
C
      IF(IDEBUG.GT.0) PRINT *, ' UCDATA'
      INDEXPL=0
C     LMAX = 1
C
CE    H E A D I N G   F O R   T H E   P R O B L E M
CS    N A S L O V   P R O B L E M A
C
      INDFOR=2
      CALL ISPITA(ACOZ)
      KART(1)=KARTIC
      NASLOV=ACOZ
      INDFOR=1
      CALL ISPITA(ACOZ)
      KART(2)=KARTIC
      READ(IULAZ,1010) INDFOR,ind56,IDJERDAP,IOPIT
      write(*,*)'ind56=',ind56
      IF(INDFOR.EQ.0) INDFOR = 1
C
CE    B A S I C   D A T A   F O R   T H E   P R O B L E M
CS    O S N O V N I   P O D A C I  O  P R O B L E M U
C
      CALL ISPITA(ACOZ)
      KART(3)=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) NP,NGELEM,NMATM,NPER,JPS,nkrt,MIXED,NCRACK,NCXFEM,
     1              IGBM
      IF(INDFOR.EQ.2.and.ind56.eq.0)
     1READ(ACOZ,1010) NP,NGELEM,NMATM,NPER,JPS,nkrt,MIXED,NCRACK,NCXFEM,
     1                IGBM
      IF(INDFOR.EQ.2.and.ind56.eq.1)
     1READ(ACOZ,4010) NP,NGELEM,NMATM,NPER,JPS,nkrt,MIXED,NCRACK,NCXFEM,
     1                IGBM
      KOJEB=NCXFEM
      IF(NCXFEM.LT.0) NCXFEM=-NCXFEM
      IF(IGBM.GT.0) KOJEB=-1
      if(nkrt.gt.0) then
      CALL ISPITA(ACOZ)
      KART(6)=KARTIC
      IF(INDFOR.EQ.1)
     1read(iulaz,*) kt3d,nlnc,mxvez,mxrac
      IF(INDFOR.EQ.2)
     1read(acoz,1010) kt3d,nlnc,mxvez,mxrac
      endif
      IF(JPS.LE.0) JPS=1
      JPS1=JPS+1
      JPBR=JPS1
      NPG=NP
      CALL ISPITA(ACOZ)
      KART(4)=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) (IOPGL(I),I=1,6),NDIN,ISOPS,ICVEL,(IOPGS(I),I=1,6)
C    1READ(IULAZ,*) (IOPGL(I),I=1,6),KOSI,NDIN,ISOPS,ICVEL,ITEST
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1020) (IOPGL(I),I=1,6),NDIN,ISOPS,ICVEL,(IOPGS(I),I=1,6)
C    1READ(ACOZ,1020) (IOPGL(I),I=1,6),KOSI,NDIN,ISOPS,ICVEL,ITEST
C     INDIKATOR ZA DRILLING
      IDRIL=0
      IF(IOPGL(6).EQ.-1) THEN
         IOPGL(6)=0
         IDRIL=1
      ENDIF
c      IF(igbm.gt.0.AND.ICVEL.EQ.1) STOP 'STOP igbm.gt.0-MUST BE ICVEL=0'
      IF(nkrt.gt.0.AND.ICVEL.EQ.1) STOP 'STOP nkrt.gt.0-MUST BE ICVEL=0'
      IF(MIXED.gt.1.AND.ICVEL.EQ.1)STOP'STOP MIXED.GT.1-MUST BE ICVEL=0'
      IF(MIXED.gt.1.AND.JPS.GT.1) STOP 'STOP MIXED.GT.1-MUST BE JPS=1'
CS AKUSTIKA
      IAKUS=0
      IF(ISOPS.EQ.-1.AND.NDIN.EQ.1) THEN
         IAKUS=1
         ISOPS=1
      ELSE IF(ISOPS.EQ.-1.AND.NDIN.NE.1) THEN
         STOP 'PAK02 - (ISOPS.EQ.-1.AND.NDIN.NE.1)'
      ENDIF
CS BROJ KOSIH KOORDINATNIH SISTEMA (=0-NE; >0-DA)
      KOSI=0
CS RAD SA: FORMIRANIM MATRICAMA ITEST=0, UCITANIM MATRICAMA ITEST=1
      ITEST=0
      IF(JPS.GT.1) ICVEL=1
      IF(NP.GT.0) GO TO 10
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2020) NP
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6020) NP
      STOP
C
   10 IF(NPER.EQ.0) NPER = 1
      IF(NGELEM.EQ.0) NGELEM = 1
      IF(NMATM.EQ.0) NMATM=1
      DO 20 I=1,6
      IF(IOPGL(I).EQ.1) GO TO 20
      IDF=I
   20 CONTINUE
C
CE    B A S I C   D A T A   F O R   P O S T - P R O C E S S I N G
CS    O P S T I   P O D A C I   O   P O S T - P R O C E S I R A N J U
C
      CALL ISPITA(ACOZ)
      KART(5)=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) NULAZ,NBLPR,NBLGR,ISTKO,NCVPR,
     +              ISTEM,ISTVN,ISTSI,ISTDE,ISTNA,IDEAS
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1010) NULAZ,NBLPR,NBLGR,ISTKO,NCVPR,
     +              ISTEM,ISTVN,ISTSI,ISTDE,ISTNA,IDEAS
C      IDEAS=0
      ICRTA=1
      IF(NULAZ.EQ.0) NULAZ = 1
      IF(NULAZ.LT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(*,2063) NASLOV(1:78)
      IF(ISRPS.EQ.1)
     1WRITE(*,6063) NASLOV(1:78)
      ENDIF
C
CE    I N P U T   D A T A   F O R   B L O C K S
CS    U L A Z N I   P O D A C I   O   B L O K O V I M A
CE    /6/ USER MANUAL
C
      CALL UCBLOK(1)
C
CE    I N P U T   D A T A   F O R   R E S T A R T
CS    U L A Z N I   P O D A C I   O   R E S T A R T O V A NJ U
C
CR    KODUZ - Korak koji se koristi za oduzimanje pomeranja
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) IREST,NMODS,ICCGG,TOLG,ALFAG,ipar,koduz
C    1READ(IULAZ,*) IREST,TSTART,NMODS,ICCGG,TOLG,ALFAG
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1030) IREST,NMODS,ICCGG,TOLG,ALFAG,ipar,koduz
C    1READ(ACOZ,1030) IREST,TSTART,NMODS,ICCGG,TOLG,ALFAG
      INDBACK=0
      IF (IPAR.EQ.0) IPAR=1
      IF(IREST.EQ.-1) THEN
         IREST=0
         INDBACK=1
      ENDIF
      irestp=irest
C* SAMO ZA TESTIRANJE
      imumps=0
      if(iabs(iccgg).gt.10) then
         imumps=1
         if(iccgg.gt.0) then
            iccgg=iccgg-10
         else
            iccgg=iccgg+10
         endif
         write(*,*) imumps,iccgg
      endif
C*
      IF(TOLG.LT.1.D-14) TOLG=0.001
      IF(MIXED.EQ.1) ICCGG=2
C      IF(MIXED.GT.1) ICCGG=2 PROVERITI DA LI TREBA NESIMETRICAN SOLVER ZA 2 I 3
CE    TIME OF RESTARTING THE JOB
      TSTART=0.
C
CE    READ DATA ABOUT INITIAL IMPERFECTION
CS    UCITAVANJE PODATAKA O IMPERFEKCIJAMA
CE    /7-1/ USER MANUAL
C
      CALL UCBLOK(3)
C
CE    O P E N   O U T P U T   F I L E
CS    O T V A R A N J E   I Z L A Z N E    D A T O T E K E
C
C      IF((NULAZ.GE.0.OR.NBLPR.GE.0).AND.INDIZL.EQ.0) THEN
        CALL OTVIZL
        INDIZL=1
        CALL ZAGLAV
C      ENDIF
      IF(NBLPR.LT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(*,2064) NASLOV(1:78)
      IF(ISRPS.EQ.1)
     1WRITE(*,6064) NASLOV(1:78)
      ENDIF
C
CE    O P E N   F I L E   F O R   G R A P H I C S
CS    O T V A R A N J E   D A T O T E K E    Z A   G R A F I K U
C
C      IF(NBLGR.GE.0.AND.INDGRA.EQ.0) THEN
        CALL OTVGRA
        INDGRA=1
C      ENDIF
      IF(NBLGR.LT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(*,2065) NASLOV(1:78)
      IF(ISRPS.EQ.1)
     1WRITE(*,6065) NASLOV(1:78)
      ENDIF
C
CE    O P E N   F I L E   F O R   N E U   G R A P H I C S
CS    O T V A R A N J E   N E U   D A T O T E K E    Z A   G R A F I K U
C
C      IF(NBLGR.GE.0.AND.INDNEU.EQ.0) THEN
      IF(INDNEU.EQ.0) THEN
        CALL OTVNEU
        INDNEU=1
      ENDIF
      IF(NBLGR.LT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(*,2066) NASLOV(1:78)
      IF(ISRPS.EQ.1)
     1WRITE(*,6066) NASLOV(1:78)
      ENDIF
C
CE    P R I N T    I N P U T    F I L E
CS    S T A M P A N J E   U L A Z N E   D A D O T E K E
C
      IF((NULAZ.EQ.1.OR.NULAZ.EQ.2).AND.IPRBR.EQ.0) CALL WIMIDZ
      IF(IPRBR.EQ.0.AND.INDIZL.EQ.1) IPRBR=1
C
CE    P R I N T    G E N E R A L   I N P U T    D A T A
CS    S T A M P A N J E   O P S T I H   U L A Z N I H   P O D A T A K A
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) CALL WRITUL(KART)
      IF((NULAZ.LT.0.AND.NBLPR.GE.0).OR.NULAZ.EQ.2) THEN
        WRITE(IZLAZ,5010)
        WRITE(IZLAZ,1000) NASLOV
        WRITE(IZLAZ,5011)
      ENDIF
C
CE    P R I N T   D A T A   F O R   B L O C K S
CS    STAMPANJE  ULAZNIH  PODATAKA O BLOKOVIMA
C
      CALL UCBLOK(2)
C
CE    P R I N T   D A T A   F O R   R E S T A R T
CS    STAMPANJE PODATAKA O RESTARTOVANJU
C
CR      write(3,*)'ipar,koduz',ipar,koduz
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3)
     1CALL WBROJK(KARTIC,0)
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2070) IREST,NMODS,ICCGG,TOLG,ALFAG,ipar,koduz
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6070) IREST,NMODS,ICCGG,TOLG,ALFAG,ipar,koduz
      ENDIF
C     menjali Busarac i Dunic narednih 7 linija
C      IF(NBLPR.LT.0.AND.NBLGR.LT.0.AND.IREST.NE.2) THEN
c      IF(ISRPS.EQ.0)
c     1WRITE(IZLAZ,2075)
c      IF(ISRPS.EQ.1)
c     1WRITE(IZLAZ,6075)
c      STOP 'PAK02'
c      ENDIF

CE    WRITE DATA ABOUT INITIAL IMPERFECTION
CS    STAMPANJE PODATAKA O IMPERFEKCIJAMA
      CALL UCBLOK(4)
C
CE    R E A D    T I M E    S T E P S
CS    U C I T A V A NJ E   V R E M E N S K I H    K O R A K A
CE    /8/ USER MANUAL
C
      CALL UCVRKR
C
CE    I N P U T   D A T A   F O R   D Y N A M I C S
CS    U L A Z N I   P O D A C I   O   D I N A M I C I
C
      IMASS=1
      IDAMP=0
      MDVI =0
      IF(NDIN.EQ.0) GO TO 30
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) IMASS,IDAMP,INDVB
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1010) IMASS,IDAMP,INDVB
      IF(IMASS.EQ.0) IMASS = 1
      IF(INDEXPL.EQ.1) IMASS = 2
c      IF(IDAMP.GT.0.AND.IDAMP.NE.IMASS) STOP 
c     +'STOP - MATRICA MASA I PRIGUSENJA MORAJU BITI ISTOG OBLIKA -PAK02'
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      CALL WBROJK(KARTIC,0)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2080) IMASS,IDAMP
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6080) IMASS,IDAMP
      ENDIF
C
      NEWACC=0
      IF(ISOPS.GT.0) GO TO 30
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) MDVI,PIP,DIP,ALFAM,BETAK,DAMPC
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1040) MDVI,PIP,DIP,ALFAM,BETAK,DAMPC
      IF(MDVI.EQ.0) MDVI = 2
      IF(MDVI.EQ.1.AND.DABS(PIP).LT.1.0D-20) PIP=1.4D0
      IF(MDVI.EQ.2.AND.DABS(PIP).LT.1.0D-20) PIP=0.5D0
      IF(MDVI.EQ.2.AND.DABS(DIP).LT.1.0D-20) DIP=0.25D0*(PIP+0.5D0)**2
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      CALL WBROJK(KARTIC,0)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2090) MDVI,PIP,DIP,ALFAM,BETAK,DAMPC
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6090) MDVI,PIP,DIP,ALFAM,BETAK,DAMPC
      ENDIF
      IF(MDVI.EQ.-2) THEN
         NEWACC=1
         MDVI=2
      ENDIF
C
CE    INPUT DATA FOR EIGEN VALUE
CS    ULAZNI PODACI O SOPSTVENIM VREDNOSTIMA
C
   30 IF(ISOPS.GT.0) THEN
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) ISTYP,NSOPV
C    1READ(IULAZ,*) ISTYP,NSOPV,ISTSV,IPROV
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1010) ISTYP,NSOPV
C    1READ(ACOZ,1010) ISTYP,NSOPV,ISTSV,IPROV
CS    INDIKATOR STAMPANJA U ITERACIJAMA
      ISTSV=0
CS    INDIKATOR PROVERE NIZOVA
      IPROV=0
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      CALL WBROJK(KARTIC,0)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2095) ISTYP,NSOPV
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6095) ISTYP,NSOPV
      ENDIF
      ENDIF
C
CE    INPUT FOR INTEGRATION AND ITERATION
CS    ULAZNI PODACI O INTEGRACIJI I ITERACIJAMA
C
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) METOD,MAXIT,KONVE,KONVS,KONVM,TOLE,TOLS,TOLM,TOLA,
     1              NBRCR
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1050) METOD,MAXIT,KONVE,KONVS,KONVM,TOLE,TOLS,TOLM,TOLA,
     1                NBRCR
      IF(METOD.EQ.0) METOD = 1
      IAUTO=0
      IF(METOD.GE.60) IAUTO = 1
      IF(METOD.GE.70) IAUTO = 2
      IF(MAXIT.EQ.0) MAXIT=10
      IF(DABS(TOLE).LT.1.0D-20) TOLE=.010
      IF(DABS(TOLS).LT.1.0D-20) TOLS=.010
      IF(DABS(TOLM).LT.1.0D-20) TOLM=.010
      IF(DABS(TOLA).LT.1.0D-20) TOLA=1.0D-10
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      CALL WBROJK(KARTIC,0)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2100) METOD,MAXIT
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6100) METOD,MAXIT
      ENDIF
C
      IF(METOD.EQ.61) METOD = 6
      IF(METOD.EQ.63) METOD = 7
      IF(METOD.EQ.71) METOD = 8
      IF(METOD.EQ.73) METOD = 9
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2110) KONVE,KONVS,KONVM,TOLE,TOLS,TOLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6110) KONVE,KONVS,KONVM,TOLE,TOLS,TOLM
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2111) TOLA,NBRCR
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6111) TOLA,NBRCR
      ENDIF
C
CE    D A T A   F O R   A U T O M A T I C  L O A D
CS    P O D A C I  O  A U T O M A T S K O M  O P T E R E C I V A N J U
C
      IF(METOD.GT.5.AND.ISOPS.GT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2300)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6300)
      STOP ' UCDATA - PAK02'
      ENDIF
      IPIVOT=0
      IDETER=0
      IF(IAUTO.EQ.0) GO TO 40
      IPIVOT=1
      IDETER=1
      CALL ISPITA(ACOZ)
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) ITEOPT,KPNOD,KPDIR,DTUK,ALFG,DELS,DELUM,DELFM
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1060) ITEOPT,KPNOD,KPDIR,DTUK,ALFG,DELS,DELUM,DELFM
      IF(ITEOPT.EQ.0) ITEOPT = 4
      IF(DABS(ALFG).LT.1.0D-20) ALFG = 1.D0
      IF(DABS(DELS).LT.1.0D-20) DELS = 1.D0
C
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3)
     1CALL WBROJK(KARTIC,0)
      IF(NULAZ.EQ.1.OR.NULAZ.EQ.3) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2160) ITEOPT,KPNOD,KPDIR,DTUK,ALFG,DELS,DELUM,DELFM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6160) ITEOPT,KPNOD,KPDIR,DTUK,ALFG,DELS,DELUM,DELFM
      ENDIF
C
CE    DATA FOR SKEW COORDINATE SYSTEMS
CS    P O D A C I  O  K O S I M  S I S T E M I M A
C
   40 IF(KOSI.EQ.0) RETURN
      RETURN
C
 1000 FORMAT(/' ',A76/)
 1010 FORMAT(14I5)
 4010 FORMAT(I10,I5,12I5)
 1020 FORMAT(6I2,3X,3I5,38X,6I2)
C1020 FORMAT(6I2,I3,11I5)
 1030 FORMAT(I5,10X,I5,I5,2F10.0,i5,i5)
C1030 FORMAT(I5,F10.0,I5,I5,2F10.0)
 5010 FORMAT(//'1'/,' ',76('*'))
 5011 FORMAT(' ',76('*')/)
 1050 FORMAT(5I5,4F10.0,I5)
 1040 FORMAT(I5,5F10.0)
 1060 FORMAT(3I5,5F10.0)
 1111 FORMAT(I5,I5)
C-----------------------------------------------------------------------
 2020 FORMAT(/' GRESKA U ULAZNIM PODACIMA :'/' BROJ CVOROVA - NP =',I5/
     1' A MORA BITI VECI OD NULE !'//' PROGRAM STOP'/)
 2063 FORMAT(/' NE STAMPAJU SE ULAZNI PODACI ZA PROBLEM POD NASLOVOM'/
     1'"',A78,'"'/)
 2064 FORMAT(/' NE STAMPAJU SE REZULTATI ZA PROBLEM POD NASLOVOM :'/
     1'"',A78,'"'/)
 2065 FORMAT(/' NE STAMPAJU SE PODACI ZA GRAFIKU ZA PROBLEM POD NASLOVOM
     1 :'/'"',A78,'"'/)
 2066 FORMAT(/' NE STAMPAJU SE PODACI ZA NEU GRAFIKU ZA PROBLEM POD NASL
     1OVOM :'/'"',A78,'"'/)
 2070 FORMAT(6X,
     1'P O D A C I   O   R E S T A R T O V A N J U'/6X,43('-')///
     111X,'INDIKATOR IZVRSENJA PROGRAMA ................... IREST =',I5/
     116X,'EQ.0; IZVRSENJE PROGRAMA'/
     116X,'EQ.1; RESTARTOVANJE'/
     116X,'EQ.2; KONTROLA ULAZNIH PODATAKA'///
     411X,'BROJ MODOVA U INICIJALNOJ IMPERFEKCIJI ......... NMODS =',I5/
     416X,'EQ.0; NEMA IMPERFEKCIJE'/
     416X,'GT.0; MODOVI SE UCITAVAJU SA JEDINICE (MODES)'///
     111X,'VRSTA SOLVERA .................................. ICCGG =',I5/
     116X,'EQ. 0 ; DIREKTNA METODA - SIMETRICAN'/
     116X,'EQ.-11; MUMPS SOLVER'/
     116X,'EQ.-1 ; ITERATIVNA ICCG METODA'/
     116X,'EQ. 1 ; ITERATIVNA PCG METODA'/
     116X,'EQ. 2 ; DIREKTNA METODA - NESIMETRICAN'///
     111X,'ICCG TOLERANCIJA ........................... TOLG =',1PD10.3/
     1//
     111X,'ICCG SHIFT VREDNOST ....................... ALFAG =',1PD10.3/
     1//
     111X,'INDIKATOR ZA BROJ PROCESORA ..................... IPAR =',I5/
     1//
     111X,'KORAK U KOME SE RESETUJU POMERANJA.............. KODUZ =',I5/
     1)
 2075 FORMAT(///' POSTO SE NE STAMPAJU REZULTATI - NBLPR<0, I'/
     1' POSTO SE NE FORMIRA DATOTEKA ZA GRAFIKU - NBLGR<0,'/
     2' DALJI RAD PROGRAMA IMA SMISLA SAMO ZA KONTROLU ULAZNIH PODATAKA
     3- IREST=2'//' STOP'//)
 2080 FORMAT(6X,
     1'P O D A C I   O   D I N A M I C I'/6X,33('-')///
     111X,'OBLIK MATRICE MASA ............................. IMASS =',I5/
     916X,'EQ.0; IMASS = 1'/
     916X,'EQ.1; PUNA'/
     916X,'EQ.2; DIJAGONALNA'///
     111X,'INDIKATOR PRIGUSENJA ........................... IDAMP =',I5/
     916X,'EQ.0; NEMA'/
     916X,'EQ.1; PUNA'/
     916X,'EQ.2; DIJAGONALNA'/
     916X,'EQ.3; RAYLEIGH')
 2090 FORMAT(///
     111X,'METOD DIREKTNE VREMENSKE INTEGRACIJE ............ MDVI =',I5/
     916X,'EQ. 0; MDVI = 2'/
     916X,'EQ. 1; VILSON TETA'/
     916X,'EQ. 2; NEWMARK METOD (pomeranja)'/
     916X,'EQ.-2; NEWMARK METOD (ubrzanja)'/
     916X,'EQ. 3; CENTRALNE RAZLIKE'///
     111X,'PRVI INTEGRACIONI PARAMETAR ................. PIP =',1PD10.3/
     916X,'EQ.0;'/
     916X,'      MDVI=1 ----- TETA=1.4'/
     916X,'      MDVI=2 ---- DELTA=0.5'///
     111X,'DRUGI INTEGRACIONI PARAMETAR ................ DIP =',1PD10.3/
     916X,'EQ.0;'/
     916X,'      MDVI=1 ----- NEPOTREBAN'/
     916X,'      MDVI=2 ---- ALFA=.25*(DELTA+.5)**2'/
     911X,'RAYLEIGH COEFICIJENT ALFA ................. ALFAM =',1PD10.3/
     911X,'RAYLEIGH COEFICIJENT BETA ................. BETAK =',1PD10.3/
     911X,'KOEFICIJENT PRIGUSENJA .................... DAMPC =',1PD10.3)
 2095 FORMAT(6X,
     1'P O D A C I   O   S O P S T V E N I M   V R E D N O S T I M A'/
     16X,61('-')///
     111X,'VRSTA ANALIZE SOPSTVENIH VREDNOSTI ............. ISTYP =',I5/
     916X,'EQ.0; ISTYP = 1'/
     916X,'EQ.1; SUBSPACE METOD'/
     916X,'EQ.2; SUBSPACE METOD (VRLO VELIKE KRITICNE SILE)'/
     916X,'EQ.3; LANCHOZ METOD'///
     111X,'BROJ SOPSTVENIH VREDNOSTI ...................... NSOPV =',I5/
     916X,'EQ.0; NSOPV = 1')  
C    111X,'INDIKATOR STAMPANJA U ITERACIJAMA .............. ISTSV =',I5/
C    916X,'EQ.0; NE STAMPA'/
C    916X,'EQ.1; STAMPA'///
C    111X,'INDIKATOR PROVERE NIZOVA ....................... IPROV =',I5/
C    916X,'EQ.0; BEZ PROVERE'/
C    916X,'EQ.1; SA PROVEROM')
 2100 FORMAT(6X,
     1'P O D A C I    O    I T E R A C I J A M A'/6X,41('-')///
     111X,'PRIMENJEN ITERATIVNI METOD ..................... METOD =',I5/
     116X,'LT. 0; ITERACIJE SA ELASTICNOM TANGENTNOM MATRICOM'/
     116X,'EQ. 0; METOD = 1'/
     116X,'EQ. 1; MODIFIKOVAN NEWTON'/
     116X,'EQ. 2; MODIFIKOVAN NEWTON SA AIETKEN UBRZANJEM'/
     116X,'EQ. 3; PUN NEWTON'/
     116X,'EQ. 4; PUN NEWTON SA LINIJSKIM PRETRAZIVANJEM'/
     116X,'EQ. 5; BFGS'/
     116X,'       AUTOMATSKO OPTERECIVANJE - KONSTATAN LUK'/
     116X,'EQ.61;            KOMBINACIJA SA METODOM (1)'/
     116X,'EQ.63;            KOMBINACIJA SA METODOM (3)'/
     116X,'       AUTOMATSKO OPTERECIVANJE - KONTROLA POMERANJA '/
     116X,'EQ.71;            KOMBINACIJA SA METODOM (1)'/
     116X,'EQ.73;            KOMBINACIJA SA METODOM (3)'///
     111X,'MAKSIMALAN BROJ ITERACIJA U KORAKU ............. MAXIT =',I5/
     116X,'EQ.0; MAXIT = 10')
 2110 FORMAT(//
     111X,'KRITERIJUM ZA KONVERGENCIJU - ENERGIJA ......... KONVE =',I5/
     116X,'EQ.0; NE KORISTI SE'/
     116X,'EQ.1; KORISTI SE'///
     111X,'KRITERIJUM ZA KONVERGENCIJU - SILA ............. KONVS =',I5/
     116X,'EQ.0; NE KORISTI SE'/
     116X,'EQ.1; KORISTI SE'///
     111X,'KRITERIJUM ZA KONVERGENCIJU - MOMENT ........... KONVM =',I5/
     116X,'EQ.0; NE KORISTI SE'/
     116X,'EQ.1; KORISTI SE'///
     611X,'TOLERANCIJA ZA NEURAVNOTEZENU ENERGIJU ..... TOLE =',1PD10.3/
     616X,'EQ.0; TOLE = 0.01'///
     611X,'TOLERANCIJA ZA NEURAVNOTEZENE SILE ......... TOLS =',1PD10.3/
     6//
     611X,'TOLERANCIJA ZA NEURAVNOTEZENI MOMENT ....... TOLM =',1PD10.3)
 2111 FORMAT(//
     611X,'APSOLUTNA TOLERANCIJA ZA ENERGIJU .......... TOLA =',1PD10.3/
     616X,'EQ.0; TOLA = 1.D-10'///
     111X,'BROJ DISKRETNIH DOGADJAJA ...................... NBRCR =',I5/
     116X,'BETON - BROJ PRSLINA U ITERACIJA ZA GRUPU ELEMENATA'/ 
     116X,'KONTAKT - BROJ KONTAKTNIH PROMENA U ITERACIJI')
 2160 FORMAT(//6X,
     1'P O D A C I   O   A U T O M A T S K O M   O P T E R E C I V A N J
     1 U'/6X,67('-')///
     111X,'OPTIMALAN BROJ ITERACIJA ...................... ITEOPT =',I5/
     1//
     111X,'CVOR SA KONTROLISANIM POMERANJEM ............... KPNOD =',I5/
     1//
     111X,'KONTROLISANI STEPEN SLOBODE CVORA KPNOD ........ KPDIR =',I5/
     1//
     611X,'VELICINA KONTROLISANOG POMERANJA ........... DTUK =',1PD10.3/
     1//
     611X,'KOEFICIJENT RASTA POMERANJA ................ ALFG =',1PD10.3/
     1//
     611X,'KOEFICIJENT RASTA LUCNE DUZINE (6X) ........ DELS =',1PD10.3/
     611X,'KOEFICIJENT MAKSIMALNOG RASTA SILA (7X)'//
     611X,'MAKSIMALNO MOGUCE POMERANJE ............... DELUM =',1PD10.3/
     1//
     611X,'MAKSIMALNA MOGUCA SILA .................... DELFM =',1PD10.3)
 2300   FORMAT(//' NE MOGU SE RACUNATI SOPSTVENE VREDNOSTI ZA METOD.GT.5
     1'/' PROGRAM STOP ')
C-----------------------------------------------------------------------
 6020 FORMAT(/' ERROR IN INPUT DATA:'/
     1' NUMBER OF NODAL POINT - NP =',I5/
     1' MUST BE GREATER THAN ZERO !')
 6063 FORMAT(/' NO PRINTOUT INPUT DATA FOR PROBLEM UNDER TITLE'/
     1'"',A78,'"'/)
 6064 FORMAT(/' NO PRINTOUT RESULTS FOR PROBLEM UNDER TITLE:'/
     1'"',A78,'"'/)
 6065 FORMAT(/' NO PRINTOUT DATA FOR GRAPHICS FOR PROBLEM UNDER TITLE:'/
     1'"',A78,'"'/)
 6066 FORMAT(/' NO PRINTOUT DATA FOR NEU GRAPHICS FOR PROBLEM UNDER TITL
     1E:'/'"',A78,'"'/)
 6070 FORMAT(6X,
     1'D A T A    F O R    R E S T A R T '/6X,33('-')///
     111X,'INDICATOR FOR JOB EXECUTION  ................... IREST =',I5/
     116X,'EQ.0; JOB EXECUTION'/
     116X,'EQ.1; RESTART OF JOB'/
     116X,'EQ.2; INPUT DATA CHECK'///
     411X,'NUMBER OF EIGEN MODES USED FOR IMPERFECTION .... NMODS =',I5/
     416X,'EQ.0; NO IMPERFECTION'/
     416X,'GT.0; READ EIGEN VECTORS FROM I/O UNIT "ZMODES"'///
     111X,'SOLVER TYPE .................................... ICCGG =',I5/
     116X,'EQ. 0 ; DIRECT SOLUTION - SYMMETRIC'/
     116X,'EQ.-11; MUMPS SYMMETRIC'/
     116X,'EQ.-1 ; ITERATIVE ICCG SOLUTION'/
     116X,'EQ. 1 ; ITERATIVE PCG SOLUTION'/
     116X,'EQ. 2 ; DIRECT SOLUTION - NONSYMMETRIC'///
     111X,'ICCG TOLERANCE ............................. TOLG =',1PD10.3/
     1//
     111X,'ICCG SHIFT VALUE .......................... ALFAG =',1PD10.3/
     1//
     111X,'INDICATOR FOR NUMBER OF PROCESSORS............... IPAR =',I5/
     1//
     111X,'A STEP IN WHICH THE RESET DISPLACEMENT WILL BE.. KODUZ =',I5/
     1)
 6075 FORMAT(///' NO PRINTOUT OF RESULTS - NBLPR.LT.0,'/
     1' NO FORMING FILE FOR GRAPHICS - NBLGR.LT.0,'/
     2' ONLY CHECK INPUT DATA - IREST=2'//
     3' STOP'//)
 6080 FORMAT(6X,
     1'D Y N A M I C   A N A L Y S I S'/6X,31('-')///
     111X,'MASS MATRIX CODE ............................... IMASS =',I5/
     916X,'EQ.0; IMASS = 1'/
     916X,'EQ.1; CONSISTENT'/
     916X,'EQ.2; LUMPED (DIAGONAL)'///
     111X,'DAMPING MATRIX CODE ............................ IDAMP =',I5/
     916X,'EQ.0; NO DAMP MATRIX'/
     916X,'EQ.1; COSISTENT'/
     916X,'EQ.2; LUMPED (DIAGONAL)'/
     916X,'EQ.3; RAYLEIGH')
 6090 FORMAT(///
     111X,'TIME INTEGRATION CODE ........................... MDVI =',I5/
     916X,'EQ. 0; MDVI = 2'/
     916X,'EQ. 1; WILSON THETA METHOD'/
     916X,'EQ. 2; NEWMARK METHOD'/
     916X,'EQ. 2; NEWMARK METHOD (displacement)'/
     916X,'EQ.-2; NEWMARK METHOD (acceleration)'/
     916X,'EQ. 3; CENTRAL DIFFERENCE METHOD'///
     111X,'FIRST INTEGRATION PARAMETER ................. PIP =',1PD10.3/
     916X,'EQ.0;'/
     916X,'      MDVI=1 ----- TETA=1.4'/
     916X,'      MDVI=2 ---- DELTA=0.5'///
     111X,'SECOND INTEGRATION PARAMETER ................ DIP =',1PD10.3/
     916X,'EQ.0;'/
     916X,'      MDVI=1 ----- NOT USED'/
     916X,'      MDVI=2 ---- ALFA=.25*(DELTA+.5)**2'/
     911X,'RAYLEIGH COEFFICIENT ALPHA ................ ALFAM =',1PD10.3/
     911X,'RAYLEIGH COEFFICIENT BETA ................. BETAK =',1PD10.3/
     911X,'DAMPING COEFFICIENT ....................... DAMPC =',1PD10.3)
 6095 FORMAT(6X,
     1'E I G E N P R O B L E M   D A T A'/
     16X,33('-')///
     111X,'EIGENPROBLEM INDICATOR ......................... ISTYP =',I5/
     916X,'EQ.0; ISTYP = 1'/
     916X,'EQ.1; SUBSPACE METHOD'/
     916X,'EQ.2; SUBSPACE METHOD (CRITICAL LOADS ARE LARGE)'/
     916X,'EQ.3; LANCHOZ METHOD'///
     111X,'NUMBER OF EIGENVALUES .......................... NSOPV =',I5/
     916X,'EQ.0; NSOPV = 1')  
 6100 FORMAT(6X,
     1'D A T A    F O R    E Q U I L I B R I U M    I T E R A T I O N S'
     1/6X,64('-')///
     111X,'ITERATION METHOD EMPLOYED ...................... METOD =',I5/
     116X,'LT. 0; ITERATION WITH ELASTIC TANGENT MATRIX'/
     116X,'EQ. 0; METOD = 1'/
     116X,'EQ. 1; MODIFIED NEWTON'/
     116X,'EQ. 2; MODIFIED NEWTON + AEITKEN ACCELERATION'/
     116X,'EQ. 3; FULL NEWTON'/
     116X,'EQ. 4; FULL NEWTON + LINE SEARCH'/
     116X,'EQ. 5; BFGS'//
     116X,'       AUTOMATIC LOADING - CONSTANT ARC LENGTH'/
     116X,'EQ.61;                     COMBINED WITH (1)'/
     116X,'EQ.63;                     COMBINED WITH (3)'//
     116X,'       AUTOMATIC LOADING - DISPLACEMENT CONTROL'/
     116X,'EQ.71;                     COMBINED WITH (1)'/
     116X,'EQ.73;                     COMBINED WITH (3)'///
     111X,'MAXIMUM NUMBER OF ITERATIONS IN A STEP ......... MAXIT =',I5/
     116X,'EQ.0; MAXIT = 10')
 6110 FORMAT(//
     111X,'CONVERGENCE CRITERION  - ENERGY ................ KONVE =',I5/
     116X,'EQ.0; NOT USED'/
     116X,'EQ.1; USED'///
     111X,'CONVERGENCE CRITERION  - FORCE ................. KONVS =',I5/
     116X,'EQ.0; NOT USED'/
     116X,'EQ.1; USED'///
     111X,'CONVERGENCE CRITERION  - MOMENT ................ KONVM =',I5/
     116X,'EQ.0; NOT USED'/
     116X,'EQ.1; USED'///
     611X,'TOLERANCE FOR UNBALANCED ENERGY ............ TOLE =',1PD10.3/
     616X,'EQ.0; TOLE = 0.01'///
     611X,'TOLERANCE FOR UNBALANCED FORCE ............. TOLS =',1PD10.3/
     6//
     611X,'TOLERANCE FOR UNBALANCED MOMENT ............ TOLM =',1PD10.3)
 6111 FORMAT(//
     611X,'ABSOLUTE TOLERANCE FOR ENERGY .............. TOLA =',1PD10.3/
     616X,'EQ.0; TOLA = 1.D-10'///
     111X,'NUMBER DISCRETE EVENTS ......................... NBRCR =',I5/
     116X,'CONCRETE - NUMBER OF CRACKS PER ITERATION IN ELEMENT GROUP'/
     116X,'CONTACT - NUMBER OF CHANGED CONTACT CONDITIONS')
 6160 FORMAT(//6X,
     1'D A T A   F O R   A U T O M A T I C   L O A D'/
     16X,66('-')///
     111X,'OPTIMUM NUMBER OF ITERATIONS .................. ITEOPT =',I5/
     1//
     111X,'NODE WITH CONTROLLED DISPLACEMENT .............. KPNOD =',I5/
     1//
     111X,'CONTROLLED DEGREE OF FREEDOM OF NODE (KPNOD) ... KPDIR =',I5/
     1//
     611X,'VALUE OF CONTROLLED DISPLACEMENT ........... DTUK =',1PD10.3/
     1//
     611X,'COEFFICIENT OF INCREASE OF DISPLACEMENT .... ALFG =',1PD10.3/
     1//
     611X,'COEFFICIENT OF ARC LENGTH INCREASE (6X) .... DELS =',1PD10.3/
     611X,'COEFFICIENT OF MAXIMUM FORCE INCREASE (7X)'//
     611X,'MAXIMAL ALLOWED DISPLACEMENT .............. DELUM =',1PD10.3/
     1//
     611X,'MAXIMAL ALLOWED FORCE ..................... DELFM =',1PD10.3)
 6300   FORMAT(//' EIGENVALUES CAN NOT CALCULATED FOR METOD.GT.5'/
     1' PROGRAM STOP ')
C-----------------------------------------------------------------------
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE WRITUL(KART)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO PRINT BASIC DATA FOR THE PROBLEM
CS.    P R O G R A M
CS.        ZA STAMPANJE OSNOVNIH PODATAKA O PROBLEMU
C .
C ......................................................................
C
      CHARACTER*250 NASLOV
      include 'paka.inc'
      
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /NASLOV/ NASLOV
      COMMON /MASINA/ INDPC,ICRTA
      COMMON /CVOREL/ ICVEL,LCVEL,LELCV,NPA,NPI,LCEL,LELC,NMA,NMI
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /SRPSKI/ ISRPS
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /MIXEDM/ MIXED,IOPGS(6),NDS
      common /krutot/ nlnc,nkrt,mxvez,lnkt,llncvz,lnbv,lncgl,lnvez,
     1                lncvez,lac,limpc,ljmpc,livez,mxvc,mxrac,lxmass
      common /krut3d/ kt3d,mmpogr
      COMMON /CRACKS/ CONTE,SINTE,FK123(10,3),NODCR(10,14),NCRACK,LQST,
     1                LNERING,LMIE,LPSI,LQ,N100,IRING,NSEG,MAXRIN,MAXSEG
     1                ,MAXNOD,LXL,LYL,LZL,LSIF1,LXGG,LYGG,LZGG,LNNOD
      COMMON /CRXFEM/ NCXFEM,LNODTIP,LNSSN,LPSIE,LFIE,LHNOD,
     1                LPSIC,LFI,LHZNAK,LNSSE,LKELEM,LID1,LID2
      COMMON /MESLESS/ IGBM,ndif,idif(50),NKI,IKI(10)
      COMMON /COMEFG/ RADIJ,NBASE,NCVP,NPEFG,NCVS,NS,LCORS,LNOC,LNOS
      COMMON /CNPE/ NPE
      COMMON /CDEBUG/ IDEBUG
      COMMON /ODUZPOM/ KODUZ
      COMMON /DJERDAP/ IDJERDAP
      COMMON /SLOBAR/ IOPIT
      DIMENSION KART(6)
C
      IF(IDEBUG.GT.0) PRINT *, ' WRITUL'
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000) KART(1)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000) KART(1)
      WRITE(IZLAZ,5010)
      WRITE(IZLAZ,1000) NASLOV
      WRITE(IZLAZ,5010)
C
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2005) KART(2)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6005) KART(2)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2020) INDFOR,IND56,IDJERDAP,IOPIT
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6020) INDFOR,IND56,IDJERDAP,IOPIT
C
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2005) KART(3)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6005) KART(3)
      IF(JPS.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2030) NP,NGELEM,NMATM,NPER,JPS,nkrt,MIXED,NCRACK,
     1                  NCXFEM,IGBM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6030) NP,NGELEM,NMATM,NPER,JPS,nkrt,MIXED,NCRACK,
     1                  NCXFEM,IGBM
      ELSE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2031) NP,NMATM,NPER,JPS
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6031) NP,NMATM,NPER,JPS
      ENDIF
      if(nkrt.gt.0) then
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2005) KART(6)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6005) KART(6)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2032) kt3d,nlnc,mxvez,mxrac
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6032) kt3d,nlnc,mxvez,mxrac
      endif
C
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2005) KART(4)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6005) KART(4)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) (IOPGL(I),I=1,6)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) (IOPGL(I),I=1,6)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2050) NDIN,ISOPS,ICVEL
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6050) NDIN,ISOPS,ICVEL
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2041) (IOPGS(I),I=1,6)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6041) (IOPGS(I),I=1,6)
C
CE    D A T A   F O R  P O S T - P R O C E S S I N G
CS    P O D A C I   O   P O S T - P R O C E S I R A N J U
C
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2005) KART(5)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6005) KART(5)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2060) NULAZ,NBLPR,NBLGR,ISTKO
      IF(ISRPS.EQ.0)
     +WRITE(IZLAZ,2061) NCVPR,ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6060) NULAZ,NBLPR,NBLGR,ISTKO
      IF(ISRPS.EQ.1)
     +WRITE(IZLAZ,6061) NCVPR,ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      RETURN
C
 1000 FORMAT(/' ',A76/)
 5010 FORMAT(' ',76('*'))
C-----------------------------------------------------------------------
 2000 FORMAT(///'1'/' KARTICA BROJ',I5///)
 2005 FORMAT(//////' KARTICA BROJ',I5///)
 2020 FORMAT(
     111X,'NACIN UCITAVANJA ULAZNIH PODATAKA ............. INDFOR =',I5/
     116X,'EQ.0; INDFOR = 1'/
     116X,'EQ.1; U SLOBODNOM FORMATU'/
     116X,'EQ.2; U OPISANOM FORMATU'///
     111X,'FORMAT ZA CITANJE CVOROVA I ELEMENATA........... IND56 =',I5/
     116X,'EQ.0; I5'/
     116X,'EQ.1; I10'///
     111X,'UCITAVANJE TEMPERATURA PO LAMELAMA .......... IDJERDAP =',I5/
     116X,'EQ.0; NE'/
     116X,'EQ.1; DA'///
     111X,'INDIKATOR OPITA ................................ IOPIT =',I5/
     116X,'EQ.0; NE'/
     116X,'EQ.1; BS'/
     116X,'EQ.2; SS'/
     116X,'EQ.3; VJ'/
     116X,'EQ.4; HJ')
     
 2030 FORMAT(6X,
     1'O S N O V N I   P O D A C I   O   P R O B L E M U'/6X,49('-')///
     111X,'BROJ CVORNIH TACAKA .......................... NP =',I10/
     116X,'EQ.0; PREKIDA SE IZVRSAVANJE PROGRAMA'///
     211X,'BROJ GRUPA ELEMENATA .......................... NGELEM =',I5/
     216X,'EQ.0; JEDNA GRUPA ELEMENATA'///
     311X,'BROJ MODELA MATERIJALA ......................... NMATM =',I5/
     316X,'EQ.0; JEDAN MODEL MATERIJALA'///
     511X,'BROJ PERIODA SA KONSTANTNIM VREMENSKIM KORACIMA . NPER =',I5/
     516X,'EQ.0; JEDAN PERIOD'///
     611X,'BROJ PODSTRUKTURA ...............................  JPS =',I5/
     616X,'EQ.0; JPS = 1'///
     611X,'BROJ KRUTIH TELA ................................ NKRT =',I5/
     616X,'EQ.0; NEMA KRUTIH TELA'///
     611X,'JAKO SPREGNUTI PROBLEMI ........................ MIXED =',I5/
     616X,'EQ.0; NE'/
     616X,'EQ.1; MESOVITA METODA POMERANJA-NAPONI'/
     616X,'EQ.2; POMERANJA-PORNI PRITISAK u-p'/
     616X,'EQ.3; POMERANJA-PORNI PRITISAK-RELATIVNA POMERANJA u-p-U'///
     611X,'BROJ PRSLINA ZA J INTEGRAL .................... NCRACK =',I5/
     616X,'EQ.0; NEMA PRSLINA'///
     611X,'BROJ PRSLINA ZA XFEM METOD .................... NCXFEM =',I5/
     616X,'EQ.0; NEMA PRSLINA'///
     611X,'BROJ PRSLINA ZA BEZMREZNI METOD (GBM) ........... IGBM =',I5/
     616X,'EQ.0; NEMA PRSLINA'///)
 2031 FORMAT(6X,
     1'O S N O V N I   P O D A C I   O   P R O B L E M U'/6X,49('-')///
     111X,'BROJ CVORNIH TACAKA ............................... NP =',I5/
     116X,'EQ.0; PREKIDA SE IZVRSAVANJE PROGRAMA'///
     311X,'BROJ MODELA MATERIJALA ......................... NMATM =',I5/
     316X,'EQ.0; JEDAN MODEL MATERIJALA'///
     511X,'BROJ PERIODA SA KONSTANTNIM VREMENSKIM KORACIMA . NPER =',I5/
     516X,'EQ.0; JEDAN PERIOD'///
     611X,'BROJ PODSTRUKTURA ................................ JPS =',I5/
     616X,'EQ.0; JPS = 1')
 2032 FORMAT(6X,
     1'P O D A C I   O   K R U T I M   T E L I M A'/
     16X,43('-')///
     111X,'IDIKATOR VRSTE KRUTIH TELA ...................... KT3D =',I5/
     116X,'EQ.0; 2D KRUTO TELO'/
     116X,'EQ.1; 3D KRUTO TELO'///
     111X,'BROJ LANACA KRUTIH TELA U KONSTRUKCIJI .......... NLNC =',I5/
     116X,'GE.1; '///
     111X,'MAKSIMALAN BROJ KRUTIH TELA U LANCU ...........  MXVEZ =',I5/
     116X,'GE.1; '///
     111X,'MAKSIMALAN BROJ GRANA KRUTIH TELA U CVORU .....  MXRAC =',I5/
     116X,'GE.0; ')
 2040 FORMAT(11X,
     9'INDIKATORI GLOBALNIH OGRANICENJA: POMERANJA I ROTACIJA CVOROVA'/
     916X,'EQ.0; SLOBODAN'/
     916X,'EQ.1; OGRANICEN'/
     916X,'      GLAVNO POMERANJE DUZ X - OSE ..... IOPGL(1) =',I5/
     916X,'      GLAVNO POMERANJE DUZ Y - OSE ..... IOPGL(2) =',I5/
     916X,'      GLAVNO POMERANJE DUZ Z - OSE ..... IOPGL(3) =',I5/
     916X,'      GLAVNA ROTACIJA OKO X/V1 - OSE ... IOPGL(4) =',I5/
     916X,'      GLAVNA ROTACIJA OKO Y/V2 - OSE ... IOPGL(5) =',I5/
     916X,'      GLAVNA ROTACIJA OKO Z/VN - OSE ... IOPGL(6) =',I5)
 2041 FORMAT(//11X,
     9'INDIKATORI GLOBALNIH OGRANICENJA: NAPONI U CVOROVIMA'/
     916X,'EQ.0; POSTOJI'/
     916X,'EQ.1; NE POSTOJI'/
     916X,'      NORMALNI NAPON U X - PRAVCU ...... IOPGS(1) =',I5/
     916X,'      NORMALNI NAPON U Y - PRAVCU ...... IOPGS(2) =',I5/
     916X,'      NORMALNI NAPON U Z - PRAVCU ...... IOPGS(3) =',I5/
     916X,'      SMICUCI NAPON U XY - RAVNI  ...... IOPGS(4) =',I5/
     916X,'      SMICUCI NAPON U YZ - RAVNI  ...... IOPGS(5) =',I5/
     916X,'      SMICUCI NAPON U ZX - RAVNI  ...... IOPGS(6) =',I5)
 2050 FORMAT(//
C    111X,'BROJ KOSIH KOORDINATNIH SISTEMA ................. KOSI =',I5/
C    1//
     511X,'VRSTA ANALIZE ................................... NDIN =',I5/
     516X,'EQ.0; STATICKA'/
     516X,'EQ.1; DINAMICKA'///
     511X,'INDIKATOR PROBLEMA SOPSTVENIH VREDNOSTI ........ ISOPS =',I5/
     516X,'EQ.0; NE RACUNA'/
     516X,'EQ.1; RACUNA'///
     511X,'INDIKATOR OZNACAVANJA CVOROVA I ELEMENATA ...... ICVEL =',I5/
     516X,'EQ.0; STANDARDNO'/
     516X,'EQ.1; PROIZVOLJNO')
C    511X,'INDIKATOR TESTIRANJA PROGRAMA .................. ITEST =',I5/
C    516X,'EQ.0; MATRICE SE FORMIRAJU'/
C    516X,'EQ.1; MATRICE SE UCITAVAJU')
 2060 FORMAT(                                                       6X,'
     1P O D A C I   O   P O S T - P R O C E S I R A N J U'/6X,51('-')///
     111X,'NACIN STAMPANJA ULAZNIH PODATAKA ............... NULAZ =',I5/
     116X,'EQ.0; NULAZ = 1'/
     116X,'EQ.1; ULAZNA DATOTEKA, ULAZNI PODACI UCITANI I GENERISANI'/
     116X,'EQ.2; ULAZNA DATOTEKA'/
     116X,'EQ.3; ULAZNI PODACI UCITANI I GENERISANI'/
     116X,'LT.0; NE STAMPAJU SE ULAZNI PODACI'///
     111X,'BROJ BLOKOVA ZA STAMPANJE REZULTATA ............ NBLPR =',I5/
     116X,'EQ.0; STAMPANJE REZULTATA U SVIM KORACIMA'/
     116X,'LT.0; NE STAMPAJU SE REZULTATI'///
     111X,'BROJ BLOKOVA ZA CRTANJE REZULTATA .............. NBLGR =',I5/
     116X,'EQ.0; MOGUCE CRTANJE REZULTATA U SVIM KORACIMA'/
     116X,'LT.0; NE CRTAJU SE REZULTATI'///
     111X,'INDIKATOR STAMPANJA SVAKOG KORAKA POSEBNO ...... ISTKO =',I5/
     116X,'EQ.0; NE STAMPA'/
     116X,'EQ.1; STAMPA'///)
 2061 FORMAT(
     111X,'BROJ CVOROVA U KOJIMA SE STAMPAJU REZULTATI .... NCVPR =',I5/
     116X,'EQ.0; STAMPA U SVIM CVOROVIMA'///
     111X,'INDIKATOR STAMPANJA TEMPERATURA ZA GRAFIKU ..... ISTEM =',I5/
     116X,'EQ.-1; NE STAMPA'///
     111X,'INDIKATOR STAMPANJA VEKTORA NORMALA ZA GRAFIKU . ISTVN =',I5/
     116X,'EQ.-1; NE STAMPA'///
     111X,'INDIKATOR STAMPANJA SILA ZA GRAFIKU ............ ISTSI =',I5/
     116X,'EQ.-1; NE STAMPA'///
     111X,'INDIKATOR STAMPANJA DEFORMACIJA ................ ISTDE =',I5/
     116X,'EQ.-1; NE STAMPA'///
     111X,'INDIKATOR STAMPANJA REZULTATA PO ELEMENTIMA .... ISTNA =',I5/
     116X,'EQ. 1; U TEZISTU'/
     116X,'EQ. 2; MAKSIMALNA VREDNOST')
C-----------------------------------------------------------------------
 6000 FORMAT(///'1'/' CARD NUMBER',I5///)
 6005 FORMAT(//////' CARD NUMBER',I5///)
 6020 FORMAT(
     111X,'FORMAT FOR INPUT DATA ......................... INDFOR =',I5/
     116X,'EQ.0; INDFOR = 1'/
     116X,'EQ.1; FREE FORMAT'/
     116X,'EQ.2; FIXED FORMAT'///
     111X,'FORMAT FOR NODE AND ELEMENT READING ............ IND56 =',I5/
     116X,'EQ.0; I5'/
     116X,'EQ.1; I10'///
     111X,'READ TEMPERATURE BY SEGMENTS ................ IDJERDAP =',I5/
     116X,'EQ.0; NO'/
     116X,'EQ.1; YES'///
     111X,'INDICATOR OF EXPERIMENT......................... IOPIT =',I5/
     116X,'EQ.0; NO'/
     116X,'EQ.1; BS'/
     116X,'EQ.2; SS'/
     116X,'EQ.3; VJ'/
     116X,'EQ.4; HJ')
 6030 FORMAT(6X,
     1'B A S I C   D A T A   F O R   T H E   P R O B L E M'/
     16X,51('-')///
     111X,'TOTAL NUMBER OF NODAL POINTS ................. NP =',I10/
     116X,'LE.0; PROGRAM STOP'///
     211X,'TOTAL NUMBER OF DIFFERENT ELEMENT GROUPS ...... NGELEM =',I5/
     216X,'EQ.0; DEFAULT SET "1"'///
     311X,'TOTAL NUMBER OF DIFFERENT MATERIAL MODELS ...... NMATM =',I5/
     316X,'EQ.0; DEFAULT SET "1"'///
     511X,'NUMBER OF PERIODS WITH CONSTANT TIME STEPS ...... NPER =',I5/
     516X,'EQ.0; DEFAULT SET TO "1"'///
     611X,'TOTAL NUMBER SUBSTRUCTURES ......................  JPS =',I5/
     616X,'EQ.0; JPS = 1'///
     611X,'TOTAL NUMBER OF RIGID BODIES .................... NKRT =',I5/
     616X,'EQ.0; NO RIGID BODIES'///
     611X,'STRONG COUPLED PROBLEMS ........................ MIXED =',I5/
     616X,'EQ.0; NO'/
     616X,'EQ.1; DISPLACEMENT-STRESS MIXED METHOD'/
     616X,'EQ.2; DISPLACEMENT-PORE PRESSURE u-p'/
     616X,'EQ.3; DISPLACEMENT-PORE PRESSURE-RELATIVE DISPLACEMENT u-p-U'
     6///
     611X,'NUMBER OF CRACKS FOR J INTEGRAL ............... NCRACK =',I5/
     616X,'EQ.0; NO CRACKS'///
     611X,'NUMBER OF CRACKS FOR XFEM METHOD .............. NCXFEM =',I5/
     616X,'EQ.0; NO CRACKS'///
     611X,'NUMBER OF CRACKS FOR MESLESS (GBM) .............. IGBM =',I5/
     616X,'EQ.0; NO CRACKS')
 6032 FORMAT(6X,
     1'B A S I C   D A T A   F O R   T H E   R I G I D   B O D Y'/
     16X,57('-')///
     111X,'IDICATOR KIND OF RIGID BODY ..................... KT3D =',I5/
     116X,'EQ.0; 2D RIGID BODY'/
     116X,'EQ.1; 3D RIGID BODY'///
     111X,'NUMBER CHAINS OF RIGID BODY IN STRUCTURE ........ NLNC =',I5/
     116X,'GE.1; '///
     111X,'MAXIMUM NUMBER RIGID BODY IN CHAIN ............  MXVEZ =',I5/
     116X,'GE.1; '///
     111X,'MAXIMUM NUMBER OF BRANCH IN A NODE ............  MXRAC =',I5/
     116X,'GE.0; ')
 6031 FORMAT(6X,
     1'B A S I C   D A T A   F O R   T H E   P R O B L E M'/
     16X,51('-')///
     111X,'TOTAL NUMBER OF NODAL POINTS ...................... NP =',I5/
     116X,'LE.0; PROGRAM STOPS'///
     311X,'TOTAL NUMBER OF DIFFERENT MATERIAL MODELS ...... NMATM =',I5/
     316X,'EQ.0; DEFAULT SET "1"'///
     511X,'NUMBER OF PERIODS WITH CONSTANT TIME STEPS ...... NPER =',I5/
     516X,'EQ.0; DEFAULT SET TO "1"'///
     611X,'TOTAL NUMBER SUBSTRUCTURES ....................... JPS =',I5/
     616X,'EQ.0; DEFAULT SET TO "1"')
 6040 FORMAT(11X,
     9'INDICATORS FOR GLOBAL CONSTRAINTS OF TRANSLATIONS AND ROTATIONS'/
     916X,'EQ.0; FREE'/
     916X,'EQ.1; RESTRAINED'/
     916X,'      GLOBAL TRANSLATION IN X DIRECTION  IOPGL(1) =',I5/
     916X,'      GLOBAL TRANSLATION IN Y DIRECTION  IOPGL(2) =',I5/
     916X,'      GLOBAL TRANSLATION IN Z DIRECTION  IOPGL(3) =',I5/
     916X,'      GLOBAL ROTATION AROUND X/V1 AXIS . IOPGL(4) =',I5/
     916X,'      GLOBAL ROTATION AROUND Y/V2 AXIS . IOPGL(5) =',I5/
     916X,'      GLOBAL ROTATION AROUND Z/VN AXIS . IOPGL(6) =',I5)
 6041 FORMAT(//11X,
     9'INDICATORS FOR GLOBAL CONSTRAINTS OF NODAL STRESSES'/
     916X,'EQ.0; NO CONSTRAINTS'/
     916X,'EQ.1; CONSTRAINT EXISTS'/
     916X,'      NORMAL STRESS IN X DIRECTION ..... IOPGS(1) =',I5/
     916X,'      NORMAL STRESS IN Y DIRECTION ..... IOPGS(2) =',I5/
     916X,'      NORMAL STRESS IN Z DIRECTION ..... IOPGS(3) =',I5/
     916X,'      SHEAR STRESS IN XY PLANE ......... IOPGS(4) =',I5/
     916X,'      SHEAR STRESS IN YZ PLANE ......... IOPGS(5) =',I5/
     916X,'      SHEAR STRESS IN ZX PLANE ......... IOPGS(6) =',I5)
 6050 FORMAT(//
C    111X,'NUMBER OF SKEW COORDINATE SISTEMS ............... KOSI =',I5/
C    1//
     511X,'TYPE OF ANALYSIS ................................ NDIN =',I5/
     516X,'EQ.0; STATICS'/
     516X,'EQ.1; DYNAMICS'///
     511X,'INDICATOR FOR EIGENVALUE COMPUTATIONS .......... ISOPS =',I5/
     516X,'EQ.0; NO COMPUTATIONS'/
     516X,'EQ.1; YES'///
     511X,'INDICATOR FOR NUMERATION OF NODES AND ELEMENTS . ICVEL =',I5/
     516X,'EQ.0; INCREASING'/
     516X,'EQ.1; FREE')
C    511X,'INDICATOR FOR PROGRAM TESTING .................. ITEST =',I5/
C    516X,'EQ.0; MATRICES ARE FORMED'/
C    516X,'EQ.1; MATRICES ARE READ AS INPUT DATA'///
 6060 FORMAT(                                                       6X,'
     1D A T A   F O R   P O S T - P R O C E S S I N G'/6X,47('-')///
     111X,'KIND OF PRINTOUT OF THE INPUT DATA ............. NULAZ =',I5/
     116X,'LT.0; NO  PRINTOUT'/
     116X,'EQ.0; NULAZ = 1'/
     116X,'EQ.1; CARD IMAGE, INPUT DATA READ AND GENERATED ARE PRINTED'/
     116X,'EQ.2; CARD IMAGE PRINTED'/
     116X,'EQ.3; INPUT DATA READ AND GENERATED ARE PRINTED'///
     111X,'NUMBER OF BLOCKS FOR RESULTS PRINTOUT .......... NBLPR =',I5/
     116X,'EQ.0; RESULTS ARE PRINTED IN ALL TIME STEPS'/
     116X,'LT.0; NO PRINTOUT OF RESULTS'///
     111X,'NUMBER BLOCKS FOR PLOTTING OF RESULTS .......... NBLGR =',I5/
     116X,'EQ.0; RESULTS ARE PLOTTED IN ALL TIME STEPS'/
     116X,'LT.0; NO PLOTTING OF RESULTS'///
     111X,'INDICATOR FOR PRINTING OUTPUT IN SEPARATE FILE . ISTKO =',I5/
     116X,'EQ.0; ALL STEPS PRINTED IN ONE FILE'/
     116X,'EQ.1; RESULTS PRINTED SEPARATELY'///)
 6061 FORMAT(
     111X,'NUMBER OF NODES FOR RESULTS PRINTOUT ........... NCVPR =',I5/
     116X,'EQ.0; PRINTING AT ALL NODES'///
     111X,'INDICATOR FOR PLOTTING TEMPERATURES ............ ISTEM =',I5/
     116X,'EQ.-1; NO PLOTTING'///
     111X,'INDICATOR FOR PLOTTING NODAL NORMAL VECTORS .... ISTVN =',I5/
     116X,'EQ.-1; NO PLOTTING'///
     111X,'INDICATOR FOR PLOTTING NODAL FORCES  ........... ISTSI =',I5/
     116X,'EQ.-1; NO PLOTTING'///
     111X,'INDICATOR FOR PRINTING STRAINS ................. ISTDE =',I5/
     116X,'EQ.-1; NO PRINTING'///
     111X,'INDICATOR FOR PRINTING RESULTS WITHIN ELEMENT .. ISTNA =',I5/
     116X,'EQ. 0; PRINTING AT INTEGRATION POINTS'/
     116X,'EQ. 1; IN ELEMENT CENTER'/
     116X,'EQ. 2; MAXIMUM VALUES')
C-----------------------------------------------------------------------
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE UCBLOK(KREST)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO FORM POINTERS AND CALL ROUTINE FOR READ BLOCKS FOR
CE.        PRINT RESULTS
CS.    P R O G R A M
CS.        ZA FORMIRANJE REPERA I POZIVANJE PROGRAMA
CS.        ZA UCITAVANJE BLOKOVA ZA STAMPANJE REZULTATA
C .
CE.    P O I N T E R S
CE.        LNDTPR - BLOCKS FOR RESULTS PRINTOUT
CE.        LNDTGR - BLOCKS FOR RESULTS PLOTING
CS.    R E P E R I
CS.        LNDTPR - BLOKOVI ZA STAMPANJE REZULTATA
CS.        LNDTGR - BLOKOVI ZA GRAFICKO PRIKAZIVANJE REZULTATA
CE.    V A R I A B L E S
CE.        NBLPR  - NUMBER OF BLOCKS FOR RESULTS PRINTOUT /5/
CE.        NBLGR  - NUMBER OF BLOCKS FOR PLOTTING OF RESULTS /5/
CE.        NMODS  - TOTAL NUMBER OF EIGEN MODES USED FOR IMPERFECTION
CE.                 DEFINITION /7/
C .
C ......................................................................
C
      include 'paka.inc'
      
      COMMON /DUZINA/ LMAX,MTOT,LMAXM,LRAD,NRAD
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /IMPERF/ NMODS,LIDIM,LSCIM,MODES
      COMMON /DUPLAP/ IDVA
      COMMON /CDEBUG/ IDEBUG
C
      IF(IDEBUG.GT.0) PRINT *, ' UCBLOK'
      IF(KREST.GT.2)THEN
        IF(NMODS.LE.0) RETURN
        GO TO (5,7),KREST-2
    5   LIDIM=LMAX
        LMAX=LIDIM+NMODS*3
        CALL DELJIV(LMAX,2,INDL)
        IF(INDL.EQ.0) LMAX=LMAX+1
        LSCIM=LMAX
        LMAX =LSCIM+NMODS*IDVA
        IF(LMAX.GT.MTOT) CALL ERROR(1)
    7   CALL UCIMPR(A(LIDIM),A(LSCIM),NMODS,KREST)
        RETURN
      ENDIF
C
      IF(NBLPR.LE.0) GO TO 10
      GO TO (15,20),KREST
   15 LNDTPR=LMAX
      LMAX=LNDTPR+NBLPR*4
      IF(LMAX.GT.MTOT) CALL ERROR(1)
   20 CALL UCPRIN(A(LNDTPR),NBLPR,4,KREST)
   10 IF(NBLGR.LE.0) RETURN
      GO TO (25,30),KREST
   25 LNDTGR=LMAX
      LMAX=LNDTGR+NBLGR*4
      IF(LMAX.GT.MTOT) CALL ERROR(1)
   30 CALL UCGRAF(A(LNDTGR),NBLGR,4,KREST)
      RETURN
      END
C=======================================================================
      SUBROUTINE UCIMPR(IDIM,SCIM,NMODS,KREST)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
CE.    P R O G R A M
CE.        TO READ BLOCKS FOR IMPERFECTION CASE
CS.    P R O G R A M
CS.        ZA UCITAVANJE PODATAKA O IMPERFEKCIJI
C
      CHARACTER*250 ACOZ
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /BROJKB/ KARTP1,KARTP2,KARTG1,KARTG2,KARTR1,KARTR2
      COMMON /SRPSKI/ ISRPS
      COMMON /CDEBUG/ IDEBUG
      DIMENSION IDIM(NMODS,*),SCIM(*)
C
      IF(IDEBUG.GT.0) PRINT *, ' UCIMPR'
      GO TO(1,2),KREST-2
CE    INPUT 
CS    FAZA UCITAVANJA
    1 DO 10 K=1,NMODS
      CALL ISPITA(ACOZ)
      IF(K.EQ.1) KARTR1=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) (IDIM(K,J),J=1,3),SCIM(K)
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1000) (IDIM(K,J),J=1,3),SCIM(K)
   10 CONTINUE
      KARTR2=KARTIC
      RETURN
C
CE    PRINT BLOCKS   
CS    STAMPANJE BLOKOVA
C
    2 IF(NULAZ.NE.1.AND.NULAZ.NE.3) RETURN
      KARTI=KARTIC
      KARTIC=KARTR2
      CALL WBROJK(KARTR1,0)
      KARTIC=KARTI
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000)
      DO 20 I=1,NMODS
   20 WRITE(IZLAZ,5010) (IDIM(I,J),J=1,3),SCIM(I)
      RETURN
C
 1000 FORMAT(3I5,F10.3)
 5010 FORMAT(11X,I5,8X,I5,9X,I5,8X,D12.5)
C-----------------------------------------------------------------------
 2000 FORMAT(6X,
     1'P O D A C I    O    I M P E R F E K C I J I'/
     16X,43('-')///11X,
     2'MOD BROJ     CVOR BROJ   STEPEN SLOBODE    AMPLITUDA    ')
C-----------------------------------------------------------------------
 6000 FORMAT(6X,
     1'D A T A    A B O U T   I M P E R F E K T I O N'/
     16X,46('-')///11X,
     2'MOD NUM.        NODE         D. O. F.      AMPLITUDE    ')
C-----------------------------------------------------------------------
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE UCPRIN(NPRGR,NBL,IDIM,KREST)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO READ BLOCKS FOR RESULTS PRINTOUT
CS.    P R O G R A M
CS.        ZA UCITAVANJE BLOKOVA ZA STAMPANJE REZULTATA
C .
C .        J=1,IDIM  (IDIM=4)
CE.        NBL - BLOCK SEQUENCE NUMBER
CS.        NBL - BLOK BROJ
C .
CE.        NPRGR(NBL,1) - FIRST STEP
CE.        NPRGR(NBL,2) - INCREMENT
CE.        NPRGR(NBL,3) - LAST STEP
CE.        NPRGR(NBL,4) - IDICATOR FOR PRINTOUT
CE.        NPRGR(NBL,4) - IDICATOR FOR PRINTOUT (=0, ALL;
CE.                                              =1, DISPLACEMENTS;
CE.                                              =2, STRESSES;)
CS.        NPRGR(NBL,1) - PRVI KORAK
CS.        NPRGR(NBL,2) - PRIRASTAJ
CS.        NPRGR(NBL,3) - ZADNJI KORAK
CS.        NPRGR(NBL,4) - IDIKATOR (=0,SVE; =1,POMERANJA; =2,NAPONI)
C .
C ......................................................................
C
      CHARACTER*250 ACOZ
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /BROJKB/ KARTP1,KARTP2,KARTG1,KARTG2,KARTR1,KARTR2
      COMMON /SRPSKI/ ISRPS
      COMMON /CDEBUG/ IDEBUG
      DIMENSION NPRGR(NBL,*)
C
      IF(IDEBUG.GT.0) PRINT *, ' UCPRIN'
      GO TO(1,2),KREST
CE    READ BLOCKS
CS    FAZA UCITAVANJA
    1 DO 10 K=1,NBL
      CALL ISPITA(ACOZ)
      IF(K.EQ.1) KARTP1=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) I,(NPRGR(I,J),J=1,IDIM)
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1000) I,(NPRGR(I,J),J=1,IDIM)
      IF(I.GT.NBL) GO TO 35
   10 CONTINUE
      KARTP2=KARTIC
      RETURN
C
CE    PRINT BLOCKS
CS    STAMPANJE BLOKOVA
    2 DO 15 I=1,NBL
      IF(NPRGR(I,3).EQ.NPRGR(I,1).AND.NPRGR(I,2).EQ.0) GO TO 15
        IPG=1
        IF(NPRGR(I,2).NE.0)
     1  CALL DELJIV(NPRGR(I,3)-NPRGR(I,1),NPRGR(I,2),IPG)
        IF(IPG.EQ.1) GO TO 30
   15 CONTINUE
C
      IF(NULAZ.NE.1.AND.NULAZ.NE.3) RETURN
      KARTI=KARTIC
      KARTIC=KARTP2
      CALL WBROJK(KARTP1,0)
      KARTIC=KARTI
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000)
      DO 20 I=1,NBL
      WRITE(IZLAZ,5010) I,(NPRGR(I,J),J=1,IDIM)
   20 CONTINUE
      RETURN
C
   30 CONTINUE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2020) I,NPRGR(I,3),NPRGR(I,1),NPRGR(1,2)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6020) I,NPRGR(I,3),NPRGR(I,1),NPRGR(1,2)
      STOP
C
   35 CONTINUE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2030) I,NBL
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6030) I,NBL
      STOP
C
 1000 FORMAT(14I5)
 5010 FORMAT(11X,I5,8X,I5,9X,I5,10X,I5,9X,I5)
C-----------------------------------------------------------------------
 2000 FORMAT(6X,
     1'P O D A C I    O    B L O K O V I M A    Z A   S T A M P U'/
     16X,58('-')///11X,
     2'BLOK BROJ    PRVI KORAK    PRIRASTAJ    ZADNJI KORAK    ',
     3'INDIKATOR (=0-SVE;=1-POMERANJA;=2-NAPONI)')
 2020 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'U BLOKU BROJ =',I5,'   ZADNJI KORAK =',I5,'    NE DOBIJA SE KADA
     1SE NA PRVI KORAK =',I5,'    SABERE KONACAN BROJ PRIRASTAJA =',I5)
 2030 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'UCITANI BROJ BLOKA I =',I5/' VECI JE OD UKUPNOG BROJA BLOKOVA ZA
     1STAMPANJE REZULTATA NBL =',I5)
C-----------------------------------------------------------------------
 6000 FORMAT(6X,
     1'DATA FOR BLOCKS USED FOR RESULTS PRINTOUT'/
     16X,41('-')///11X,
     2'BLOCK NUMBER FIRST STEP    INCREMENT    LAST STEP       ',
     3'INDICATOR (=0-ALL;=1-DISPLACEMENT;=2-STRESSES)')
 6020 FORMAT(/////' E R R O R   I N   I N P U T   D A T A'//
     1'IN BLOCK NUMBER =',I5,'   LAST STEP =',I5,'    MUST BE EQUAL TO T
     1HE SUM OF FIRST STEP =',I5,'    AND FINITE NUMBER OF INCREMENTS ='
     1,I5)
 6030 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'UCITANI BROJ BLOKA I =',I5/' VECI JE OD UKUPNOG BROJA BLOKOVA ZA
     1STAMPANJE REZULTATA NBL =',I5)
C-----------------------------------------------------------------------
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE UCGRAF(NPRGR,NBL,IDIM,KREST)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO READ BLOCKS FOR PLOTTING RESULTS
CS.    P R O G R A M
CS.        ZA UCITAVANJE BLOKOVA ZA CRTANJE REZULTATA
C .
C .        J=1,IDIM  (IDIM=4)
CE.        NBL - BLOCK SEQUENCE NUMBER
CS.        NBL - BLOK BROJ
C .
CE.        NPRGR(NBL,1) - FIRST STEP
CE.        NPRGR(NBL,2) - INCREMENT
CE.        NPRGR(NBL,3) - LAST STEP
CE.        NPRGR(NBL,4) - IDICATOR FOR GRAPHIC (=0, ALL;
CE.                                             =1, DISPLACEMENTS;
CE.                                             =2, STRESSES;)
CS.        NPRGR(NBL,1) - PRVI KORAK
CS.        NPRGR(NBL,2) - PRIRASTAJ
CS.        NPRGR(NBL,3) - ZADNJI KORAK
CS.        NPRGR(NBL,4) - IDIKATOR (=0,SVE; =1,POMERANJA; =2,NAPONI)
C .
C ......................................................................
C
      CHARACTER*250 ACOZ
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /BROJKB/ KARTP1,KARTP2,KARTG1,KARTG2,KARTR1,KARTR2
      COMMON /SRPSKI/ ISRPS
      COMMON /CDEBUG/ IDEBUG
      DIMENSION NPRGR(NBL,*)
C
      IF(IDEBUG.GT.0) PRINT *, ' UCGRAF'
      GO TO (1,2),KREST
C
CE    READ BLOCKS
CS    FAZA UCITAVANJA
    1 DO 10 K=1,NBL
      CALL ISPITA(ACOZ)
      IF(K.EQ.1) KARTG1=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) I,(NPRGR(I,J),J=1,IDIM)
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1000) I,(NPRGR(I,J),J=1,IDIM)
      IF(I.GT.NBL) GO TO 35
   10 CONTINUE
      KARTG2=KARTIC
      RETURN
C
CE    PRINT BLOCKS
CS    STAMPANJE BLOKOVA
    2 DO 15 I=1,NBL
      IF(NPRGR(I,3).EQ.NPRGR(I,1).AND.NPRGR(I,2).EQ.0) GO TO 15
        IPG=1
        CALL DELJIV(NPRGR(I,3)-NPRGR(I,1),NPRGR(I,2),IPG)
        IF(IPG.EQ.1) GO TO 30
   15 CONTINUE
      IF(NULAZ.NE.1.AND.NULAZ.NE.3) RETURN
      KARTI=KARTIC
      KARTIC=KARTG2
      CALL WBROJK(KARTG1,0)
      KARTIC=KARTI
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000)
      DO 20 I=1,NBL
      WRITE(IZLAZ,5010) I,(NPRGR(I,J),J=1,IDIM)
   20 CONTINUE
      RETURN
C
   30 CONTINUE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2020) I,NPRGR(I,3),NPRGR(I,1),NPRGR(1,2)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6020) I,NPRGR(I,3),NPRGR(I,1),NPRGR(1,2)
      STOP
C
   35 CONTINUE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2030) I,NBL
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6030) I,NBL
      STOP
C
 1000 FORMAT(14I5)
 5010 FORMAT(11X,I5,8X,I5,9X,I5,10X,I5,9X,I5)
C-----------------------------------------------------------------------
 2000 FORMAT(6X,
     1'P O D A C I    O    B L O K O V I M A    Z A   G R A F I K U'/
     16X,60('-')///11X,
     2'BLOK BROJ    PRVI KORAK    PRIRASTAJ    ZADNJI KORAK    ',
     3'INDIKATOR (=0-SVE;=1-POMERANJA;=2-NAPONI)')
 2020 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'U BLOKU BROJ =',I5,'   ZADNJI KORAK =',I5,'    NE DOBIJA SE KADA
     1SE NA PRVI KORAK =',I5,'    SABERE KONACAN BROJ PRIRASTAJA =',I5)
 2030 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'UCITANI BROJ BLOKA I =',I5/' VECI JE OD UKUPNOG BROJA BLOKOVA ZA
     1GRAFIKU NBL =',I5)
C-----------------------------------------------------------------------
 6000 FORMAT(6X,
     1'DATA FOR BLOCKS USED IN PREPARING RESULTS FOR GRAPHICS'/
     16X,54('-')///11X,
     2'BLOCK NUMBER FIRST STEP    INCREMENT    LAST STEP       ',
     3'INDICATOR (=0-ALL;=1-DISPLACEMENTS;=2-STRESSES)')
 6020 FORMAT(/////' E R R O R   I N   I N P U T   D A T A'//
     1'IN BLOCK NUMBER =',I5,'   LAST STEP =',I5,'    MUST BE EQUAL TO T
     1HE SUM OF FIRST STEP =',I5,'    AND FINITE NUMBER OF INCREMENTS ='
     1,I5)
 6030 FORMAT(/////' G R E S K A   U   U L A Z N I M   P O D A C I M A'//
     1'UCITANI BROJ BLOKA I =',I5/' VECI JE OD UKUPNOG BROJA BLOKOVA ZA
     1GRAFIKU NBL =',I5)
C-----------------------------------------------------------------------
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE UCVRKR
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO FORM POINTERS AND CALL ROUTINE FOR READING TIME PERIODS
CE.        AND STEPS
CS.    P R O G R A M
CS.        ZA FORMIRANJE REPERA I POZIVANJE PROGRAMA
CS.        ZA UCITAVANJE VREMENSKIH PERIODA RESAVANJA I KORAKA
C .
CE.    P O I N T E R S
CE.        LNKDT - NUMBER OF STEP IN PERIOD
CE.        LDTDT - TIME INCREMENT IN PERIOD
CS.    R E P E R I
CS.        LNKDT - BROJ KORAKA U PERIODIMA
CS.        LDTDT - VREMENSKI PRIRASTAJ U PERIODIMA
CE.    V A R I A B L E S
CE.        NPER  - TOTAL NUMBER PERIODS WITH CONSTANT TIME STEP /3/
C .
C ......................................................................
C
      include 'paka.inc'
      
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /DUZINA/ LMAX,MTOT,LMAXM,LRAD,NRAD
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /DUPLAP/ IDVA
      COMMON /CDEBUG/ IDEBUG
C
CE    SPACE IN WORKING ARRAY FOR INPUT DATA
CS    PROSTOR U RADNOM VEKTORU ZA ULAZNE PODATKE
C
      IF(IDEBUG.GT.0) PRINT *, ' UCVRKR'
      VREME=0.0D0
      LNKDT=LMAX
      LMAX=LNKDT+NPER
      CALL DELJIV(LMAX,2,INDL)
      IF(INDL.EQ.0) LMAX=LMAX+1
      LDTDT=LMAX
      LMAX=LDTDT+NPER*IDVA
      IF(LMAX.GT.MTOT) CALL ERROR(1)
C
CE    INPUT DATA FOR TIME STEPS
CS    ULAZNI PODACI O VREMENSKIM KORACIMA
C
      CALL PRKOR(A(LNKDT),A(LDTDT),VREME,NPER,NDT)
      LVDT=LMAX
      RETURN
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE PRKOR(NKDT,DTDT,VREME,NPER,NDT)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        TO READ TIME PERIODS AND STEPS
CS.    P R O G R A M
CS.        ZA UCITAVANJE VREMENSKIH PERIODA RESAVANJA I KORAKA
C .
CE.        I=1,NPER (NPER - NUMBER OF TIME PERIODS)
CS.        I=1,NPER (NPER - BROJ VREMENSKIH PERIODA)
C .
CE.        NKDT(I) - NUMBER OF STEPS IN PERIOD
CS.        NKDT(I) - BROJ KORAKA U PERIODU
C .
CE.        DTDT(I) - TIME STEP IN PERIOD
CS.        DTDT(I) - VREMENSKI PRIRASTAJ-KORAK U PERIODU
C .
CE.            NDT - TOTAL NUMBER OF TIME PERIOD
CS.            NDT - UKUPAN BROJ VREMENSKIH KORAKA
C .
C ......................................................................
C
      CHARACTER*250 ACOZ
      COMMON /BROJUK/ KARTIC,INDFOR,NULAZ
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /SRPSKI/ ISRPS
      COMMON /CDEBUG/ IDEBUG
      DIMENSION NKDT(*),DTDT(*)
C
      IF(IDEBUG.GT.0) PRINT *, ' PRKOR'
      DO 10 J=1,NPER
      CALL ISPITA(ACOZ)
      IF(J.EQ.1) KARTI=KARTIC
      IF(INDFOR.EQ.1)
     1READ(IULAZ,*) I,NKDT(I),DTDT(I)
      IF(INDFOR.EQ.2)
     1READ(ACOZ,1000) I,NKDT(I),DTDT(I)
   10 CONTINUE
      NDT=0
      VREME=0.0D0 
      DO 30 I=1,NPER
        NDT=NDT+NKDT(I)
        DO 30 J=1,NKDT(I)
   30 VREME=VREME+DTDT(I)
C
      IF(NULAZ.NE.1.AND.NULAZ.NE.3) RETURN
      CALL WBROJK(KARTI,0)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000)
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000)
      DO 20 I=1,NPER
      WRITE(IZLAZ,5010) I,NKDT(I),DTDT(I)
   20 CONTINUE
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2020) NDT,VREME
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6020) NDT,VREME
      RETURN
C
 1000 FORMAT(2I5,F10.0)
 5010 FORMAT(11X,I10,18X,I5,16X,1PD12.5)
C-----------------------------------------------------------------------
 2000 FORMAT(6X,
     1'P O D A C I   O   V R E M E N S K I M   K O R A C I M A'/
     16X,55('-')///11X,
     2' PERIOD RESAVANJA       BROJ VREM. KORAKA         VREM. KORAK')
 2020 FORMAT(' ',11X,60('-')/11X,' BROJ VREMENSKIH KORAKA NDT =',I4,2X,
     1'UKUPNO VREME =',1PD12.5)
C-----------------------------------------------------------------------
 6000 FORMAT(6X,
     1'D A T A   F O R   T I M E   S T E P S'/
     16X,37('-')///11X,
     2' SOLUTION PERIOD        NUM. OF TIME STEP          TIME STEP')
 6020 FORMAT(' ',11X,60('-')/11X,' NUMBER OF TIME STEPS   NDT =',I4,4X,
     1'TOTAL TIME =',1PD12.5)
C-----------------------------------------------------------------------
      END
