C=======================================================================
C
C   SUBROUTINE S02NAP
C              STANP1
C              STAN11
C              STAN13
C              STAN15
C              STAN24
C              STA130
C
C=======================================================================
      SUBROUTINE S02NAP
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
CS     GLAVNI PROGRAM ZA POZIVANJE PROGRAMA ZA STAMPANJE NAPONA
CE     MAIN PROGRAM FOR PRINTOUT STRESS IN SHELLS 
C
      include 'paka.inc'
      
      COMMON /DUZINA/ LMAX,MTOT,LMAXM,LRAD,NRAD
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEMAU/ MXAU,LAU,LLMEL,LNEL,LNMAT,LTHID,LIPGC,LIPRC,LISNA,
     1 LMXAU,LAPRS
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /PLASTI/ LPLAST,LPLAS1,LSIGMA
      COMMON /POSTPR/ LNDTPR,LNDTGR,NBLPR,NBLGR,INDPR,INDGR
      COMMON /ZAPISI/ LSTAZA(5)
      COMMON /DUPLAP/ IDVA
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
C
      LAU=LMAX
CS     UCITAVANJE PODATAKA O ELEMENTIMA I NAPONA SA DISKA
CE     READ DATA FROM DISK 
      CALL READE1(A(LAU),1)
CS     PODPROGRAM ZA STAMPANJE NAPONA
CE     PRINT STRESS
      IF(INDPR.EQ.0.OR.INDPR.EQ.2) CALL STANP1(A(LAU))
CS     PODPROGRAM ZA STAMPANJE NAPONA ZA POSTPROCESIRANJE
CE     PRINT STRESS FOR POSTPROCESSING 
      IF(INDGR.EQ.0.OR.INDGR.EQ.2) CALL STANG1(A(LAU))
      IF(IATYP.EQ.0) RETURN
      IF(NMODM.LE.4.OR.NMODM.EQ.11.OR.NMODM.EQ.12) RETURN
C....  ZAPIS NAPONA TECENJA I PLASTICNIH DEF. NA KRAJU KORAKA
      NPROS=NE*MODPR1( NMODM )*IDVA
      LMA8=LSTAZA(3)-1
      CALL WRITDD(A(LPLAS1),NPROS/IDVA,IELEM,LMA8,LDUZI)
      RETURN
      END
C======================================================================
      SUBROUTINE STANP1(AU)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /ELEMAU/ MXAU,LAU,LLMEL,LNEL,LNMAT,LTHID,LIPGC,LIPRC,LISNA,
     1 LMXAU,LAPRS
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TEMPCV/ LTECV,ITEMP
      COMMON /PLASTI/ LPLAST,LPLAS1,LSIGMA
      COMMON /CVOREL/ ICVEL,LCVEL,LELCV,NPA,NPI,LCEL,LELC,NMA,NMI
      COMMON /DUPLAP/ IDVA
      DIMENSION AU(*)
      REAL AU
C
      GO TO (     1,999,  3,999,  5,999,999,999,999,999,
     1            1,  1,999,  5,999,999,999,999,999,999,
     2          999,999,999, 24,999,999,999,999,999, 30,
     3          999,999,999,999,999,999,999,999,999,999,
     4          999,999,999,999,999,999,999,999,999,999,
     5          999,999,999,999,999,999,999,999,999,999,
     6          999,999,999,999,999,999,999,999,999,999,
     7          999,999,999,999,999,999,999,999,999,999,
     8          999,999,999,999,999,999,999,999,999,999,
     9          999,999,999,999,999,999,999,999,999,999),NMODM
    1 CALL STAN11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,AU(LAPRS))
      RETURN
    3 CALL STAN13(A(LSIGMA),A(LAU),AU(LISNA),AU(LNEL),A(LTECV),AU(LCEL),
     1            ICVEL,AU(LAPRS))
      RETURN
    5 LTEQ  =LPLAS1
      LDEFP =LTEQ  +NE*IDVA
      LSIGMA=LDEFP +NE*IDVA
      LDEF  =LSIGMA+NE*IDVA
      CALL STAN15(A(LSIGMA),A(LDEF ),A(LDEFP),A(LTEQ),A(LAU),AU(LISNA),
     1            AU(LCEL),ICVEL,AU(LAPRS))
      RETURN
C     VISKOELASTICAN
   24 LTAUT = LPLAS1
      NLL = NE*IDVA 
      LTAUVT = LTAUT + NLL
      LEPST = LTAUVT + NLL
      LEPSVT = LEPST + NLL
      LFT = LEPSVT + NLL  
      CALL STAN24(A(LTAUT),A(LTAUVT),A(LEPST),A(LEPSVT),A(LFT),
     1            A(LAU),AU(LISNA),AU(LCEL),ICVEL)
      RETURN 
C
   30 NLL=NE*IDVA
      LEL=LPLAS1
      LSH = LEL + 2*NLL
      LSIG = LSH + NLL
      LEPS = LSIG + NLL
      LFT = LEPS + NLL
      LEPSV = LEL + 16*NE*IDVA
      CALL STA130(A(LEL),A(LSH),A(LSIG),A(LEPS),A(LFT),
     1            A(LEPSV),A(LAU),AU(LISNA),AU(LCEL),ICVEL)
  999 RETURN
      END
C======================================================================
      SUBROUTINE STAN11(SIGMA,AU,ISNA,MCVEL,ICVEL,APRS)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      DIMENSION SIGMA(NE,*),ISNA(*),MCVEL(*),APRS(*)
      DIMENSION AU(*)
      REAL AU
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) NLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) NLM
         GO TO 20
         ENDIF
C
         ISN=ISNA(NLM)
         IF(ISN.GT.0) GO TO 20
      IF(ISRPS.EQ.0.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,2010)
      IF(ISRPS.EQ.1.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,6010)
         INDSN=1
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         FORC=SIGMA(NLM,1)*APRS(NLM)
         WRITE(IZLAZ,5000) NMM,SIGMA(NLM,2),SIGMA(NLM,1),FORC
   20 CONTINUE
      RETURN
 5000 FORMAT(I5,15X,3(1PE12.4))
C-----------------------------------------------------------------------
 2010 FORMAT('1'/' ELEM. BR.',7X,'D E F O R M A C I J  E   I   N A P O N
     1 I   S T A P O V A'/21X,'DEFORMACIJA',7X,'NAPON',8X,'SILA')
 2040 FORMAT(/' NESTAO JE ELEMENT -',I5)
 6010 FORMAT('1'/' ELEM. NU.',7X,'T R U S S     S T R A I N    A N D     
     1S T R E S S       '/21X,'     STRAIN',6X,'STRESS',7X,'FORCE')
 6040 FORMAT(/' DEATH ELEMENT -',I5)
C-----------------------------------------------------------------------
      END
C======================================================================
      SUBROUTINE STAN13(SIGMA,AU,ISNA,NEL,TECV,MCVEL,ICVEL,APRS)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      DIMENSION SIGMA(NE,*),ISNA(*),NEL(NE,*),TECV(*),MCVEL(*),APRS(*)
      DIMENSION AU(*)
      REAL AU
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) NLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) NLM
         GO TO 20
         ENDIF
C
         ISN=ISNA(NLM)
         IF(ISN.GT.0) GO TO 20
      IF(ISRPS.EQ.0.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,2010)
      IF(ISRPS.EQ.1.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,6010)
         INDSN=1
         TT=(TECV(NEL(NLM,1))+TECV(NEL(NLM,2)))/2.0D0
         NMM=NLM
         FORC=SIGMA(NLM,1)*APRS(NLM)
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000) NMM,SIGMA(NLM,2),SIGMA(NLM,1),FORC,TT
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000) NMM,SIGMA(NLM,2),SIGMA(NLM,1),FORC,TT
   20 CONTINUE
      RETURN
C-----------------------------------------------------------------------
 2000 FORMAT(I5,15X,3(1PE12.4),'    TEMPERATURA =',1PE12.4)
 2010 FORMAT('1'/' ELEM. BR.',6X,'D E F O R M A C I J  E   I   N A P O N
     1 I   S T A P O V A'/21X,'DEFORMACIJA',7X,'NAPON',8X,'SILA')
 2040 FORMAT(/' NESTAO JE ELEMENT -',I5)
 6000 FORMAT(I5,15X,3(1PE12.4),'    TEMPERATURE =',1PE12.4)
 6010 FORMAT('1'/' ELEM. NU.',7X,'T R U S S     S T R A I N    A N D     
     1S T R E S S       '/21X,'     STRAIN',6X,'STRESS',7X,'FORCE')
 6040 FORMAT(/' DEATH ELEMENT -',I5)
C-----------------------------------------------------------------------
      END
C======================================================================
      SUBROUTINE STAN15(SIGMA,DEFT,DEFPT,TEQ,AU,ISNA,MCVEL,ICVEL,APRS)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      DIMENSION SIGMA(*),DEFT(*),DEFPT(*),TEQ(*),ISNA(*),MCVEL(*),
     1          APRS(*)
      DIMENSION AU(*)
      REAL AU
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) NLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) NLM
         GO TO 20
         ENDIF
C
         ISN=ISNA(NLM)
         IF(ISN.GT.0) GO TO 20
      IF(ISRPS.EQ.0.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,2010)
      IF(ISRPS.EQ.1.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,6010)
         INDSN=1
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         FORC=SIGMA(NLM)*APRS(NLM)
         WRITE(IZLAZ,1000) NMM,DEFT(NLM),DEFPT(NLM),SIGMA(NLM),TEQ(NLM),
     1                     FORC    
   20 CONTINUE
      RETURN
 1000 FORMAT(I5,5X,1PE12.4,11X,2(1PE12.4),3X,2(1PE12.4))
C-----------------------------------------------------------------------
 2010 FORMAT('1'/' ELEM. BR.',6X,'D E F O R M A C I J  E   I   N A P O N
     1 I   S T A P O V A'/11X,'DEFORMACIJA',2X,'PLASTICNA DEFORMACIJA',
     1 7X,'NAPON',2X,'NAPON TECENJA',2X,'SILA')
 2040 FORMAT(/' NESTAO JE ELEMENT -',I5)
 6010 FORMAT('1'/' ELEM. NU.',7X,'T R U S S     S T R A I N    A N D     
     1S T R E S S       '/14X,'  STRAIN   ',6X,'PLASTIC STRAIN',
     16X,'STRESS',3X,'YIELD STRESS',2X,'FORCE')
 6040 FORMAT(/' DEATH ELEMENT -',I5)
C-----------------------------------------------------------------------
      END
C======================================================================
      SUBROUTINE STAN24(SIGMA,SIGMAV,DEF,DEFV,FV,AU,ISNA,MCVEL,ICVEL)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      DIMENSION SIGMA(*),SIGMAV(*),DEF(*),DEFV(*),FV(*),ISNA(*),MCVEL(*)
      DIMENSION AU(*)
      REAL AU
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) NLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) NLM
         GO TO 20
         ENDIF
C
         ISN=ISNA(NLM)
         IF(ISN.GT.0) GO TO 20
      IF(ISRPS.EQ.0.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,2010)
      IF(ISRPS.EQ.1.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,6010)
         INDSN=1
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         WRITE(IZLAZ,1000) NMM,DEF(NLM),DEFV(NLM),SIGMA(NLM),
     1                     SIGMAV(NLM),FV(NLM)
   20 CONTINUE
      RETURN
 1000 FORMAT(I5,1PE12.4,2X,1PE12.4,1X,1PE12.4,1X,2(1PE12.4,2X))
C-----------------------------------------------------------------------
 2010 FORMAT('1'/' ELEM. BR.',6X,'D E F O R M A C I J  E   I   N A P O N
     1 I   S T A P O V A'/7X,'DEFORMACIJA',2X,'BRZINA DEFORM',
     1 3X,'NAPON',5X,'VISKOZ NAPON',2X,'SILA U STAPU'/)
 2040 FORMAT(/' NESTAO JE ELEMENT -',I5)
 6010 FORMAT('1'/' ELEM. NO.',7X,'T R U S S     S T R A I N    A N D     
     1S T R E S S       '/7X,'  STRAIN   ',2X,'STRAIN RATE',
     16X,'STRESS',2X,'VISCOUS STRESS',2X,'TRUSS FORCE')
 6040 FORMAT(/' DEATH ELEMENT -',I5)
C-----------------------------------------------------------------------
      END
C======================================================================
      SUBROUTINE STA130(ELST,SH,SIGMA,DEF,FV,DEFV,AU,ISNA,MCVEL,ICVEL)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      DIMENSION ELST(*),SH(*),SIGMA(*),DEF(*),FV(*),DEFV(*),
     1          ISNA(*),MCVEL(*)
      DIMENSION AU(*)
      REAL AU
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2040) NLM
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6040) NLM
         GO TO 20
         ENDIF
C
         ISN=ISNA(NLM)
         IF(ISN.GT.0) GO TO 20
      IF(ISRPS.EQ.0.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,2010)
      IF(ISRPS.EQ.1.AND.INDSN.EQ.0)
     1WRITE(IZLAZ,6010)
         INDSN=1
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         LDEFV = 1 + 5*(NLM-1)
         INDSH = SH(NLM)
         WRITE(IZLAZ,1000) NMM,DEF(NLM),DEFV(LDEFV),SIGMA(NLM),
     1                     FV(NLM),ELST(NLM),INDSH
   20 CONTINUE
      RETURN
 1000 FORMAT(I5,1PE12.4,2X,1PE12.4,1X,1PE12.4,1X,2(1PE12.4,2X),I3)
C-----------------------------------------------------------------------
 2010 FORMAT('1'/' ELEM. BR.',6X,'D E F O R M A C I J  E   I   N A P O N
     1 I   S T A P O V A'/7X,'DEFORMACIJA',2X,'BRZINA DEFORM',
     1 2X,'NAPON',4X,'SILA U STAPU',2X,'DUZ PROKLIZ',2X,'IND KL'/)
 2040 FORMAT(/' NESTAO JE ELEMENT -',I5)
 6010 FORMAT('1'/' ELEM. NO.',7X,'T R U S S     S T R A I N    A N D     
     1S T R E S S       '/7X,'  STRAIN   ',2X,'STRAIN RATE',
     16X,'STRESS',2X,'TRUSS FORCE',2X,'SLIP LENGTH',2X,'SLIP INDIC'/)
 6040 FORMAT(/' DEATH ELEMENT -',I5)
C-----------------------------------------------------------------------
      END
C======================================================================
      SUBROUTINE STANG1(AU)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /ELEMAU/ MXAU,LAU,LLMEL,LNEL,LNMAT,LTHID,LIPGC,LIPRC,LISNA,
     1 LMXAU,LAPRS
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TEMPCV/ LTECV,ITEMP
      COMMON /PLASTI/ LPLAST,LPLAS1,LSIGMA
      COMMON /CVOREL/ ICVEL,LCVEL,LELCV,NPA,NPI,LCEL,LELC,NMA,NMI
      COMMON /DUPLAP/ IDVA
      COMMON /NIDEAS/ IDEAS
      DIMENSION AU(*)
      REAL AU
C
      GO TO (     1,999,  1,999,  5,999,999,999,999,999,
     1            1,  1,999,  5,999,999,999,999,999,999,
     2          999,999,999, 24,999,999,999,999,999, 30,
     3          999,999,999,999,999,999,999,999,999,999,
     4          999,999,999,999,999,999,999,999,999,999,
     5          999,999,999,999,999,999,999,999,999,999,
     6          999,999,999,999,999,999,999,999,999,999,
     7          999,999,999,999,999,999,999,999,999,999,
     8          999,999,999,999,999,999,999,999,999,999,
     9          999,999,999,999,999,999,999,999,999,999),NMODM
    1 IF(IDEAS.GE.0) THEN
         CALL STAG11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,1,2)
         CALL STAG11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,2,3)
      ENDIF
      CALL STAU11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,AU(LAPRS),
     +            AU(LAPRS),AU(LAPRS),AU(LAPRS),0)
      RETURN
    5 LTEQ  =LPLAS1
      LDEFP =LTEQ  +NE*IDVA
      LSIGMA=LDEFP +NE*IDVA
      LDEF  =LSIGMA+NE*IDVA
      IF(IDEAS.GE.0) THEN
         CALL STAG11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,1,2)
         CALL STAG11(A(LDEF),A(LAU),AU(LISNA),AU(LCEL),ICVEL,1,3)
         CALL STAG11(A(LDEFP),A(LAU),AU(LISNA),AU(LCEL),ICVEL,1,34)
      ENDIF   
      CALL STAU11(A(LSIGMA),A(LAU),AU(LISNA),AU(LCEL),ICVEL,AU(LAPRS),
     +            A(LDEF),A(LDEFP),AU(LAPRS),1)
      RETURN
C     VISKOELASTICAN
   24 LTAUT = LPLAS1
      NLL = NE*IDVA 
      LTAUVT = LTAUT + NLL
      LEPST = LTAUVT + NLL
      LEPSVT = LEPST + NLL
      LFT = LEPSVT + NLL  
C      CALL STAN24(A(LTAUT),A(LTAUVT),A(LEPST),A(LEPSVT),A(LFT),
C     1            AU(LISNA),AU(LCEL),ICVEL)
      RETURN 
C
   30 NLL=NE*IDVA
      LEL=LPLAS1
      LSH = LEL + 2*NLL
      LSIG = LSH + NLL
      LEPS = LSIG + NLL
      LFT = LEPS + NLL
      LEPSV = LEL + 16*NE*IDVA
C      CALL STA130(A(LEL),A(LSH),A(LSIG),A(LEPS),A(LFT),
C     1            A(LEPSV),AU(LISNA),AU(LCEL),ICVEL)
  999 RETURN
      END
C======================================================================
      SUBROUTINE STAG11(SIGMA,AU,ISNA,MCVEL,ICVEL,IND,ISDTY)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      CHARACTER*250 NASLOV
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /GRUPEE/ NGEL,NGENL,LGEOM,NGEOM,ITERM
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      COMMON /SUMELE/ ISUMEL,ISUMGR
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NASLOV/ NASLOV
      COMMON /NIDEAS/ IDEAS
      COMMON /KOJISR/ KOJSET
C
      DIMENSION SIGMA(NE,*),ISNA(*),MCVEL(*)
      DIMENSION AU(*)
      REAL AU
C
      II=IGRAF
      JEDAN=1
      NULA=0
      ZERO=0.
      M10=-10
      M11=-11
      IDV=2
      ITRI=3
      I8=8
C      
C     MODEL TYPE
C     0-UNKNOWN; 1-STRUCTURAL; 2-HEAT TRANSFER; 3-FLUID FLOW
CE    STRUCTURAL ANALYSIS = 1
CS    STRUKTURNA ANALIZA = 1
      IMOTY=1
C
C     ANALYSIS TYPE
C     0-UNKNOWN; 1-STATIC; 2-NORMAL MODE; 4-TRANSIENT; 6-BUCKLING; 
C     9-STATIC NONLINEAR
CE    STEADY STATE = 1; TRANSIENT = 4
CS    STACIONARAN = 1; NESTACIONARAN = 4
      IANTY=1
      IF(NDIN.GT.0.AND.ISOPS.GT.0) IANTY=2
      IFAT1=1
      IFAT2=1
      FATY8=0.0D0
      IF(NDT.GT.1) THEN
         IANTY=4
         IF(NGENL.GT.0) IANTY=9
         IF(NDIN.EQ.0.AND.ISOPS.GT.0.AND.NGENL.GT.0) IANTY=6
         IFAT1=2
         FATY8=VREME
      ENDIF
C
C     DATA CHARACTERISTIC
C     0-UNKNOWN; 1-SCALAR; 2-3 DOF; 3-6 DOF; 4-SYMMETRIC TENSOR
CS    SIMETRICAN TENZOR = 4
      IDACH=4
CS    SKALAR = 1
C      IDACH=1
C
C     RESULT TYPE
C     2-STRESS; 3-STRAIN; 4-ELEMENT FORCE; 5-TEMPERATURE; 8-DISPLACEMENT
C     9-REACTION FORCE; 11-VELOCITY; 12-ACCELERATION; 32-CONSTRAINT FORCE
C     34-PLASTIC STRAIN; 35-CREEP STRAIN; 49-CONTACT FORCES;
C     94-UN SCALAR; 95-UN 3 DOF; 96-UN 6 DOF; 97-UN SYMMETRIC TENSOR;
C     >1000-USER DEFINED RESULT TYPE
CE    STRESS = 2
CS    NAPONI = 2
C      ISDTY=2
CE    STRAIN = 3
CS    DEFORMACIJE = 3
C      ISDTY=3
C
C     DATA TYPE
C     1-INTEGER; 2-SINGLE PRECISION; 4-DOUBLE PRECISION FLOATING POINT
CE    SINGLE PRECISION = 2; DOUBLE PRECISION = 4
CS    PRECIZNOST JEDNOSTRUKA = 2; DVOSTRUKA = 4
      IDATY=2
C
C     NUMBER OF DATA VALUES FOR THE DATA COMPONENT (NVALDC)
CE    NUMBER DATA = 6
CS    BROJ PODATAKA = 6
      NDVPN=6
      IF(IDACH.EQ.1) NDVPN=1
C
CE    DATA FOR ALL NODES IEXP=1, DATA FOR ONLY 1ST NODE IEXP=2
      IEXP=1
      IF(ISTNA.GT.0) IEXP=2
CE    NUMBER OF NODES ON ELEMENTS (NLOCS)
      NNODS=NCVE
CE    NUMBER OF DATA VALUES PER NODE (NVLOC)
      NVPN=6
      IF(IDACH.EQ.1) NVPN=1
C
      IND1=-1
      IF(IDEAS.GT.6) THEN
         ITYP=2414
      ELSE
         ITYP=57
      ENDIF
C
C     DATASET LOCATION
C     1-DATA AT NODES; 2-DATA ON ELEMENTS; 3-DATA AT NODES ON ELEMENTS
      IELS=2
C
      INDSN=0
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         ISN=ISNA(NLM)
         IF(ISN.EQ.1) GO TO 20
         IF(INDSN.EQ.0) THEN
      WRITE(II,5100) IND1
      WRITE(II,5100) ITYP
      IF(IDEAS.GT.6) THEN
         KOJSET=KOJSET+1
         WRITE(II,5000) KOJSET
         WRITE(II,5003) NASLOV
         WRITE(II,5000) IELS
      ENDIF
      WRITE(II,5003) NASLOV
      IF(ISDTY.EQ.2) THEN
      IF(ISRPS.EQ.0)
     1WRITE(II,2005)
      IF(ISRPS.EQ.1)
     1WRITE(II,6005)
      ENDIF
      IF(ISDTY.EQ.3) THEN
      IF(ISRPS.EQ.0)
     1WRITE(II,2006)
      IF(ISRPS.EQ.1)
     1WRITE(II,6006)
      ENDIF
      IF(ISDTY.EQ.34) THEN
      IF(ISRPS.EQ.0)
     1WRITE(II,2007)
      IF(ISRPS.EQ.1)
     1WRITE(II,6007)
      ENDIF
      IF(ISRPS.EQ.0)
     1WRITE(II,2000) KOR
      IF(ISRPS.EQ.1)
     1WRITE(II,6000) KOR
      WRITE(II,5000) IMOTY,IANTY,IDACH,ISDTY,IDATY,NDVPN
      IF(IDEAS.GT.6) THEN
         IF(IANTY.GT.2) THEN
            WRITE(II,5000) M11,NULA,IDV,NULA,JEDAN,JEDAN,KOR,KOR
            WRITE(II,5000) I8,IDV
            WRITE(II,5200) FATY8,FATY8,ZERO,ZERO,ZERO,ZERO
            WRITE(II,5200) ZERO,ZERO,ZERO,ZERO,ZERO,ZERO
         ELSE
            WRITE(II,5000) M10,NULA,JEDAN,JEDAN,JEDAN,NULA,NULA,NULA
            WRITE(II,5000) IDV,NULA
            WRITE(II,5200) ZERO,ZERO,ZERO,ZERO,ZERO,ZERO
            WRITE(II,5200) ZERO,ZERO,ZERO,ZERO,ZERO,ZERO
         ENDIF
      ELSE
         IF(NDT.EQ.1) WRITE(II,5000) IFAT1,IFAT2,KOR
         IF(NDT.GT.1) WRITE(II,5000) IFAT1,IFAT2,KOR,KOR
         WRITE(II,5200) FATY8
      ENDIF
         ENDIF
         INDSN=1
         NMM=NLM+ISUMEL
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IELS.EQ.3) THEN
           WRITE(IGRAF,5000) NMM,IEXP,NNODS,NVPN
           IF(NVPN.EQ.1) WRITE(IGRAF,5200) SIGMA(NLM,IND)
           IF(NVPN.EQ.6) 
     +     WRITE(IGRAF,5200) SIGMA(NLM,IND),ZERO,ZERO,ZERO,ZERO,ZERO 
           IF(IEXP.EQ.1) THEN
            IF(NVPN.EQ.1) WRITE(IGRAF,5200) SIGMA(NLM,IND)
            IF(NVPN.EQ.6) 
     +      WRITE(IGRAF,5200) SIGMA(NLM,IND),ZERO,ZERO,ZERO,ZERO,ZERO 
           ENDIF
         ENDIF  
         IF(IELS.EQ.2) THEN
           WRITE(IGRAF,5000) NMM,NVPN
           IF(NVPN.EQ.1) WRITE(IGRAF,5200) SIGMA(NLM,IND)
           IF(NVPN.EQ.6) 
     +     WRITE(IGRAF,5200) SIGMA(NLM,IND),ZERO,ZERO,ZERO,ZERO,ZERO 
         ENDIF
   20 CONTINUE
      IF(INDSN.EQ.1) WRITE(IGRAF,5100) IND1
      ISUMEL=ISUMEL+NE
      RETURN
C
 5100 FORMAT(I6)
 5003 FORMAT(A80)
 5000 FORMAT(8I10)
 5200 FORMAT(6(1PE13.5))
C-----------------------------------------------------------------------
 2005 FORMAT('NAPONI U STAPOVIMA')
 2006 FORMAT('DEFORMACIJE U STAPOVIMA')
 2007 FORMAT('PLASTICNE DEFORMACIJE U STAPOVIMA')
 2000 FORMAT('DATUM I VREME'/
     1       'PRAZNA'/
     1       'SLUCAJ OPTERECENJA:',I10)
C-----------------------------------------------------------------------
 6005 FORMAT('STRESS OF TRUSS ELEMENTS')
 6006 FORMAT('STRAIN OF TRUSS ELEMENTS')
 6007 FORMAT('PLASTIC STRAIN OF TRUSS ELEMENTS')
 6000 FORMAT('DATE AND TIME'/
     1       'EMPTY'/
     1       'LOAD CASE         :',I10)
C-----------------------------------------------------------------------
      END
