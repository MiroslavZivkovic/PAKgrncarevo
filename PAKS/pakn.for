C=======================================================================
C
C=======================================================================
      SUBROUTINE NEUTRA(NKDT,DTDT,IND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        WITH LOOP OVER TIME PERIODS AND STEPS FOR NEUTRAL FILE
CS.    P R O G R A M
CS.        SA PETLJOM PO VREMENSKIM PERIODIMA I KORACIMA ZA NEUTRAL 
C .
CE.    V A R I A B L E S
CE.        NPER  - TOTAL NUMBER OF PERIODS WITH CONSTANT TIME STEP,
CE.                SEE CARD /3/
C .
C ......................................................................
C
      include 'paka.inc'
      
      CHARACTER*250 NASLOV
      COMMON /NASLOV/ NASLOV
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /GRUPEE/ NGEL,NGENL,LGEOM,NGEOM,ITERM
      COMMON /ANALIZ/ LINEAR,ITERGL,INDDIN
      COMMON /PRIMER/ IPRBR,INDIZL,INDGRA,INDNEU
      DIMENSION NKDT(*),DTDT(*)
C
      II=49
      MJ=-1
      IF(IND.EQ.2) GO TO 999
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      MM=0
      IF(NGENL.EQ.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=1
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.1) MM=2
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=3
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=10
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.1) MM=11
      IF(NGENL.GT.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=12
	IF(MM.EQ.2) RETURN
C
      WRITE(II,1100) MJ
      M450=450
      WRITE(II,1200) M450
C
      VREM0=0.D0
      INDT=0
C
CE    BASIC LOOP OVER TIME PERIODS
CS    OSNOVNA PETLJA PO VREMENSKIM PERIODIMA
C
      DO 100 IPER=1,NPER
         IINDT=NKDT(IPER)
         DT=DTDT(IPER)
         IPDT=INDT+1
         INDT=INDT+IINDT
C
CE    BASIC LOOP OVER TIME STEPS
CS    OSNOVNA PETLJA PO VREMENSKIM KORACIMA
C
      DO 500 KORBR=IPDT,INDT
         VREM0 = VREM0 + DT
C
      WRITE(II,1000) KORBR
      IF(NDT.EQ.1) THEN
         WRITE(II,1005) KORBR
         WRITE(II,1000) M9,MM
         WRITE(II,1010) ZERO
      ELSE
         WRITE(II,1006)
C         WRITE(II,1006) KORBR,VREM0
         WRITE(II,1000) M9,MM
         WRITE(II,1010) VREM0
      ENDIF
      WRITE(II,1000) JEDAN
      WRITE(II,2000) NASLOV
C
  500 CONTINUE 
C
  100 CONTINUE
C
      IF(MM.EQ.11) THEN
      DO 110 I=1,NSOPV
         WRITE(II,1000) KORBR+I
         WRITE(II,1016) KORBR+I,VREM0
         WRITE(II,1000) M9,MM
         WRITE(II,1010) VREM0
         WRITE(II,1000) JEDAN
         WRITE(II,2000) NASLOV
  110 CONTINUE
      ENDIF
C
      WRITE(II,1100) MJ
C
      WRITE(II,1100) MJ
      M451=451
      WRITE(II,1200) M451
      RETURN
C
  999 WRITE(II,1100) MJ
      IZNEU=II
      IF(INDNEU.EQ.1) CLOSE (IZNEU,STATUS='KEEP')
      RETURN
C
 1100 FORMAT(I5)
 1200 FORMAT(I6)
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
C 1006 FORMAT('CASE',I5,' TIME',1PE11.4)
 1016 FORMAT('CASE',I5,' EIGV IN TIME',1PE11.4)
 1010 FORMAT(3(1PE11.4,','))
 2000 FORMAT(A80)
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE NEUTRC(MAXIT,II,IND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        WITH LOOP OVER TIME PERIODS AND STEPS FOR NEUTRAL FILE
CS.    P R O G R A M
CS.        SA PETLJOM PO VREMENSKIM PERIODIMA I KORACIMA ZA NEUTRAL 
C .
CE.    V A R I A B L E S
CE.        NPER  - TOTAL NUMBER OF PERIODS WITH CONSTANT TIME STEP,
CE.                SEE CARD /3/
C .
C ......................................................................
C
      include 'paka.inc'
      
      CHARACTER*250 NASLOV
      COMMON /NASLOV/ NASLOV
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /GRUPEE/ NGEL,NGENL,LGEOM,NGEOM,ITERM
      COMMON /ANALIZ/ LINEAR,ITERGL,INDDIN
      COMMON /PRIMER/ IPRBR,INDIZL,INDGRA,INDNEU
C
      MJ=-1
      IF(IND.EQ.2) GO TO 999
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      MM=0
      IF(NGENL.EQ.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=1
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.1) MM=2
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=3
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=10
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.1) MM=11
      IF(NGENL.GT.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=12
	IF(MM.EQ.2) RETURN
C
      WRITE(II,1100) MJ
      M450=450
      WRITE(II,1200) M450
C
      VREM0=0.D0
      INDT=0
C
CE    BASIC LOOP OVER ITERATION
CS    OSNOVNA PETLJA PO ITERACIJAMA
C
      DO 100 KORBR=1,MAXIT
         VREM0 = KORBR
         WRITE(II,1000) KORBR
         WRITE(II,1006)
c         WRITE(II,1006) KORBR,VREM0
         WRITE(II,1000) M9,MM
         WRITE(II,1010) VREM0
         WRITE(II,1000) JEDAN
         WRITE(II,2000) NASLOV
  100 CONTINUE
C
      WRITE(II,1100) MJ
C
      WRITE(II,1100) MJ
      M451=451
      WRITE(II,1200) M451
      RETURN
C
  999 WRITE(II,1100) MJ
      IZNEU=II
      IF(INDNEU.EQ.1) CLOSE (IZNEU,STATUS='KEEP')
      RETURN
C
 1100 FORMAT(I5)
 1200 FORMAT(I6)
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 1005 FORMAT('PAK ITERATION',I5)
 1006 FORMAT('ITER',I5,' TIME',1PE11.4)
 1010 FORMAT(3(1PE11.4,','))
 2000 FORMAT(A80)
      END
C======================================================================
C
C======================================================================
      SUBROUTINE TGRAUK(CORD,NCVEL,ICVEL,NPP,II)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.       TO PRINT COORDINATES IN neu FILE
CS.    P R O G R A M
CS.       ZA STAMPANJE KOORDINATA CVOROVA U neu FILE
C .
C ......................................................................
C
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /NIDEAS/ IDEAS
      DIMENSION CORD(NPP,*),NCVEL(*)
      DIMENSION IDD(6)
C
      NULA=0
	JEDAN=1
C
      IND=-1
      ITYP=403
      ICOL=46
      WRITE(II,5100) IND
      WRITE(II,5001) ITYP
      DO 10 I=1,NP
         IF(ICVEL.EQ.0) THEN
           NI=I
         ELSE
           NI=NCVEL(I)
         ENDIF
         WRITE(II,5000) NI,NULA,NULA,JEDAN,ICOL,(IOPGL(J),J=1,6),
     +                  (CORD(I,J),J=1,3),NULA
   10 CONTINUE
      WRITE(II,5100) IND
      RETURN
C
 5100 FORMAT(i5)
 5000 FORMAT(I10,',',10(I3,','),3(1PE13.5,','),I2,',')
 5001 FORMAT(I6)
      END
C======================================================================
C
C======================================================================
      SUBROUTINE TGRAUB(ID,NCVEL,ICVEL,NPP,II)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.       TO PRINT CONSTRAINTS IN neu FILE
CS.    P R O G R A M
CS.       ZA STAMPANJE OGRANICENJA CVOROVA U neu FILE
C .
C ......................................................................
C
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /NIDEAS/ IDEAS
      DIMENSION NCVEL(*)
      DIMENSION ID(NPP,*)
      DIMENSION IDD(6)
C
      NULA=0
	JEDAN=1
C
      IND=-1
C
      ITYP=406
      ICOL=120
      WRITE(II,5100) IND
      WRITE(II,5000) ITYP
      WRITE(II,5010) JEDAN
      WRITE(II,*) ' constraint'
      DO 30 I=1,NP
         IF(ICVEL.EQ.0) THEN
           NI=I
         ELSE
           NI=NCVEL(I)
         ENDIF
         IMA=0
         DO 40 IJ=1,6
            IF(ID(I,IJ).GT.0.OR.IOPGL(IJ).EQ.1) THEN
               IDD(IJ)=0
            ELSE
               IDD(IJ)=1
               IMA=1
            ENDIF
   40    CONTINUE
         IF(IMA.EQ.1) WRITE(II,5001) NI,ICOL,JEDAN,(IDD(J),J=1,6)
   30 CONTINUE
      WRITE(II,5001) -JEDAN,-JEDAN,-JEDAN,NULA,NULA,NULA,NULA,NULA,NULA
C     CONSTRAINT EQUATION (NUMBER,COLOR,LAYER)
C     (NUMBER COEFFICIENTS FOR EQUATION)
C     (NODE,DOF(1..6),COEFFICIJENT)
      WRITE(II,5001) -JEDAN,-JEDAN,-JEDAN
      WRITE(II,5100) IND
      RETURN
C
 5100 FORMAT(i5)
 5010 FORMAT(I6,',')
 5000 FORMAT(I6)
 5001 FORMAT(I10,',',I4,',',7(I3,','))
      END
C============================================================================
      SUBROUTINE TGRMAT(AMAT,I,II)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.       TO PRINT MATERIALS AND PROPERTIES IN NEU FILE
C .
C ......................................................................
C
      CHARACTER*250 NASLOV
      COMMON /NASLOV/ NASLOV
      DIMENSION AMAT(*)
C
      IF(I.EQ.1) THEN
         IND=-1
         ITYP=100
         VERSION=4.4
         WRITE(II,5100) IND
         WRITE(II,5100) ITYP
         WRITE(II,2002) NASLOV
         WRITE(II,5200) VERSION
         WRITE(II,5100) IND
      ENDIF
C
      NULA=0
      ZERO=0.
C
      E=AMAT(1)
      V=AMAT(7)
      GAMA=AMAT(13)
      EX=E
      EY=E
      EZ=E
      GX=0.
      GY=0.
      GZ=0.
      VX=V
      VY=V
      VZ=V
C
      E11=E*(1.-V)/(1.+V)/(1.-2.*V)
      E12=E*V/(1.+V)/(1.-2.*V)
      G=E/2./(1.+V)
C
      R11=E/(1.-V*V)
      R12=E*V/(1.-V*V)
C
      IND=-1
      ITYP=401
      WRITE(II,5100) IND
      WRITE(II,5001) ITYP
C      DO I=1,NUMMAT
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,NULA,I,NULA
C        TITLE         
         WRITE(II,2000) I
C        YOUNG'S MODULUS         
         WRITE(II,5500) EX,EY,EZ
C        SHEAR MODULUS         
         WRITE(II,5500) GX,GY,GZ
C        POISSON'S RATIO         
         WRITE(II,5500) VX,VY,VZ
C        3D ANISOTROPIC ELASTIC CONSTITUTIVE MATRIX         
         WRITE(II,5500) E11,E12,E12,ZERO,ZERO
         WRITE(II,5500) ZERO,E11,E12,ZERO,ZERO
         WRITE(II,5500) ZERO,E11,ZERO,ZERO,ZERO
         WRITE(II,5500) G,ZERO,ZERO,G,ZERO
         WRITE(II,5500) G
C        2D PLANE STRESS ANISOTROPIC ELASTIC MATRIX         
         WRITE(II,5500) R11,R12,ZERO,R11,ZERO
         WRITE(II,5500) G
C        AX,AY,AZ THERMAL EXPANSION COEFFICIENTS
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO
C        KX,KY,KZ THERMAL CONDUCTIVITY COEFFICIENTS
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO
C        CP,RO,BE,TREF
         WRITE(II,5500) ZERO,GAMA,ZERO,ZERO
C        TENSION LIMITS
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
C        A I D
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO
C        A
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
C        ET,SY,FI
         WRITE(II,5500) ZERO,ZERO,ZERO
C        ID OF HYPERELASTIC EXPERIMENTAL DATA FUNCTIONS
         WRITE(II,5600) NULA,NULA,NULA,NULA,NULA
C        0,0,0,F(SY),M,MODEL
         WRITE(II,5600) NULA,NULA,NULA,NULA,NULA,NULA
C        CREEP
         WRITE(II,5500) ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO
         WRITE(II,5600) NULA,NULA,NULA,NULA
         WRITE(II,5600) NULA,NULA,NULA,NULA
C      ENDDO
      WRITE(II,5100) IND
      RETURN
C
 5100 FORMAT(i5)
 5001 FORMAT(i6)
 5500 FORMAT(5(1PE13.5,','))
 5600 FORMAT(6(I4,','))
 2000 FORMAT(' MAT',I4)
 2001 FORMAT(' PRO',I4)
 2002 FORMAT(A80)
 5200 FORMAT(F3.1,',')
      END
C============================================================================
      SUBROUTINE TGRMAT9(AMAT,I,MAT,IEL,II)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.       TO PRINT MATERIALS AND PROPERTIES IN NEU FILE
C .
C ......................................................................
C
      CHARACTER*250 NASLOV
      COMMON /NASLOV/ NASLOV
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      DIMENSION AMAT(*)
C
      IF(I.NE.MAT) STOP ' MATERIJALI ZA CAM-CLAY MORAJU BITI NA POCETKU'
      IF(I.EQ.1) THEN
         IND=-1
         ITYP=100
         VERSION=4.4
         WRITE(II,5100) IND
         WRITE(II,5001) ITYP
         WRITE(II,2002) NASLOV
         WRITE(II,5200) VERSION
         WRITE(II,5100) IND
      ENDIF
C
      NULA=0
      ZERO=0.
C
      E=AMAT(1)
      V=AMAT(7)
      GAMA=AMAT(13)
      TREF=AMAT(14)
      EX=E
      EY=E
      EZ=E
      GX=0.
      GY=0.
      GZ=0.
      VX=V
      VY=V
      VZ=V
C
      E11=E*(1.-V)/(1.+V)/(1.-2.*V)
      E12=E*V/(1.+V)/(1.-2.*V)
      G=E/2./(1.+V)
C
      R11=E/(1.-V*V)
      R12=E*V/(1.-V*V)
C
      IND=-1
      ITYP=401
      WRITE(II,5100) IND
      WRITE(II,5100) ITYP
C      DO I=1,NUMMAT
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,NULA,I,NULA
C        TITLE         
         WRITE(II,2000) I
C        YOUNG'S MODULUS         
         WRITE(II,5500) EX,EY,EZ
C        SHEAR MODULUS         
         WRITE(II,5500) GX,GY,GZ
C        POISSON'S RATIO         
         WRITE(II,5500) VX,VY,VZ
C        3D ANISOTROPIC ELASTIC CONSTITUTIVE MATRIX         
         WRITE(II,5500) E11,E12,E12,ZERO,ZERO
         WRITE(II,5500) ZERO,E11,E12,ZERO,ZERO
         WRITE(II,5500) ZERO,E11,ZERO,ZERO,ZERO
         WRITE(II,5500) G,ZERO,ZERO,G,ZERO
         WRITE(II,5500) G
C        2D PLANE STRESS ANISOTROPIC ELASTIC MATRIX         
         WRITE(II,5500) R11,R12,ZERO,R11,ZERO
         WRITE(II,5500) G
C        AX,AY,AZ THERMAL EXPANSION COEFFICIENTS
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO
C        KX,KY,KZ THERMAL CONDUCTIVITY COEFFICIENTS
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO
C        CP,RO,BE,TREF
         WRITE(II,5500) ZERO,GAMA,ZERO,TREF
C        KOEFICIJENTI AM,ALAM,AKA,P0,E0
         WRITE(II,5500) (AMAT(K),K=25,29)
C        TABELA ZA LOM SM I SQRT(3*J2D)
         WRITE(II,5500) S1S3(1,MAT,1),S1S3(2,MAT,1), 
     1                  S1S3(1,MAT,2),S1S3(2,MAT,2),S1S3(1,MAT,3)
         WRITE(II,5500) S1S3(2,MAT,3),S1S3(1,MAT,4),S1S3(2,MAT,4), 
     1                  S1S3(1,MAT,5),S1S3(2,MAT,5)
         WRITE(II,5500) S1S3(1,MAT,6),S1S3(2,MAT,6), 
     1                  S1S3(1,MAT,7),S1S3(2,MAT,7),S1S3(1,MAT,8)
         WRITE(II,5500) S1S3(2,MAT,8),S1S3(1,MAT,9),S1S3(2,MAT,9), 
     1                  S1S3(1,MAT,10),S1S3(2,MAT,10)
         WRITE(II,5500) ZERO
C        KOEFICIJENTI ZA LOM M,S,SC
         WRITE(II,5500)(SCMS(K,MAT),K=1,3),ZERO,ZERO
C        ET,SY,FI
         WRITE(II,5500) ZERO,ZERO,ZERO
C        ID OF HYPERELASTIC EXPERIMENTAL DATA FUNCTIONS
         WRITE(II,5600) NULA,NULA,NULA,NULA,NULA
C        KRIT,IEL,3,F(SY),M,MODEL
         WRITE(II,5600) KRIT(MAT),IEL,3,NULA,NULA,9
C        CREEP
         WRITE(II,5500) ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO
         WRITE(II,5600) NULA,NULA,NULA,NULA
         WRITE(II,5600) NULA,NULA,NULA,NULA
C      ENDDO
      WRITE(II,5100) IND
      RETURN
C
 5100 FORMAT(i5)
 5001 FORMAT(i6)
 5500 FORMAT(5(1PE13.5))
 5600 FORMAT(6I4)
 2000 FORMAT(' MAT',I4)
 2001 FORMAT(' PRO',I4)
 2002 FORMAT(A80)
 5200 FORMAT(F3.1,',')
      END
C======================================================================
      SUBROUTINE STAU09(RTH,ID,NCVEL,ICVEL,NPP,II,IND,NCVP,NCVPR)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /MPOINC/ MMP,NMPC,NEZAV,LCMPC,LMPC,NEZA1
C
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /SRPSKI/ ISRPS
      COMMON /SISTEM/ LSK,LRTDT,NWK,JEDN,LFTDT
      COMMON /RESTAR/ TSTART,IREST
      COMMON /NIDEAS/ IDEAS
      COMMON /ODUZMI/ INDOD
C
      DIMENSION RTH(*),ID(NP,*),NCVEL(*),NCVP(*),FSP(6),IN(8)
C
      NEMAR=0
      IF(IOPGL(4).EQ.1.AND.IOPGL(5).EQ.1.AND.IOPGL(6).EQ.1) NEMAR=1
C
	IF(IND.EQ.1.AND.INDOD.EQ.1) THEN
         IODUZ=61
         OPEN (IODUZ,FILE='POMER1',STATUS='UNKNOWN',
     1         FORM='UNFORMATTED',ACCESS='SEQUENTIAL')
	   IF(IREST.EQ.1) CALL READD(RTH(JEDN+1),JEDN,IODUZ)
	ENDIF
C

      NP=NPP
      IF(JPS.GT.1.AND.JPBR.LT.JPS1) NPP=NP-NPK
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M1=1
      M2=2
      M3=3
      M4=4
      M5=5
      M7=7
      M8=8
      M9=9
C      II=49
C
      IN(1)=IND
      IN(2)=IND+1
      IN(3)=IND+2
      IN(4)=IND+3
      IN(5)=IND+4
      IN(6)=IND+5
      IN(7)=IND+6
      IN(8)=IND+7
      IF(IDEAS.EQ.-1) THEN
         IN(6)=0
         IN(7)=0
         IN(8)=0
      ENDIF
      IF(IDEAS.EQ.-1.AND.IN(1).NE.1) THEN
         IN(2)=0
         IN(3)=0
         IN(4)=0
      ENDIF
      IP=0
C
   30 IP=IP+1
      IF(NEMAR.EQ.1.AND.IP.GT.4) GO TO 40
      IF(IDEAS.EQ.-1.AND.IP.NE.1.AND.IP.NE.5.AND.IN(1).NE.1) GO TO 40
      IF(IDEAS.EQ.-1.AND.IP.GT.5.AND.IN(1).EQ.1) GO TO 40
      WRITE(II,1000) KOR,IN(IP),JEDAN
      IF(IN(1).EQ.1.AND.IP.EQ.1) WRITE(II,3001) 
      IF(IN(1).EQ.1.AND.IP.EQ.2) WRITE(II,3002) 
      IF(IN(1).EQ.1.AND.IP.EQ.3) WRITE(II,3003) 
      IF(IN(1).EQ.1.AND.IP.EQ.4) WRITE(II,3004) 
      IF(IN(1).EQ.1.AND.IP.EQ.5) WRITE(II,3005) 
      IF(IN(1).EQ.1.AND.IP.EQ.6) WRITE(II,3006) 
      IF(IN(1).EQ.1.AND.IP.EQ.7) WRITE(II,3007) 
      IF(IN(1).EQ.1.AND.IP.EQ.8) WRITE(II,3008) 
      IF(IN(1).EQ.11.AND.IP.EQ.1) WRITE(II,3011) 
      IF(IN(1).EQ.11.AND.IP.EQ.2) WRITE(II,3012) 
      IF(IN(1).EQ.11.AND.IP.EQ.3) WRITE(II,3013) 
      IF(IN(1).EQ.11.AND.IP.EQ.4) WRITE(II,3014) 
      IF(IN(1).EQ.11.AND.IP.EQ.5) WRITE(II,3015) 
      IF(IN(1).EQ.11.AND.IP.EQ.6) WRITE(II,3016) 
      IF(IN(1).EQ.11.AND.IP.EQ.7) WRITE(II,3017) 
      IF(IN(1).EQ.11.AND.IP.EQ.8) WRITE(II,3018) 
      IF(IN(1).EQ.21.AND.IP.EQ.1) WRITE(II,3021) 
      IF(IN(1).EQ.21.AND.IP.EQ.2) WRITE(II,3022) 
      IF(IN(1).EQ.21.AND.IP.EQ.3) WRITE(II,3023) 
      IF(IN(1).EQ.21.AND.IP.EQ.4) WRITE(II,3024) 
      IF(IN(1).EQ.21.AND.IP.EQ.5) WRITE(II,3025) 
      IF(IN(1).EQ.21.AND.IP.EQ.6) WRITE(II,3026) 
      IF(IN(1).EQ.21.AND.IP.EQ.7) WRITE(II,3027) 
      IF(IN(1).EQ.21.AND.IP.EQ.8) WRITE(II,3028) 
      IF(IN(1).EQ.41.AND.IP.EQ.1) WRITE(II,3041) 
      IF(IN(1).EQ.41.AND.IP.EQ.2) WRITE(II,3042) 
      IF(IN(1).EQ.41.AND.IP.EQ.3) WRITE(II,3043) 
      IF(IN(1).EQ.41.AND.IP.EQ.4) WRITE(II,3044) 
      IF(IN(1).EQ.41.AND.IP.EQ.5) WRITE(II,3045) 
      IF(IN(1).EQ.41.AND.IP.EQ.6) WRITE(II,3046) 
      IF(IN(1).EQ.41.AND.IP.EQ.7) WRITE(II,3047) 
      IF(IN(1).EQ.41.AND.IP.EQ.8) WRITE(II,3048) 
      IF(IN(1).EQ.51.AND.IP.EQ.1) WRITE(II,3051) 
      IF(IN(1).EQ.51.AND.IP.EQ.2) WRITE(II,3052) 
      IF(IN(1).EQ.51.AND.IP.EQ.3) WRITE(II,3053) 
      IF(IN(1).EQ.51.AND.IP.EQ.4) WRITE(II,3054) 
      IF(IN(1).EQ.51.AND.IP.EQ.5) WRITE(II,3055) 
      IF(IN(1).EQ.51.AND.IP.EQ.6) WRITE(II,3056) 
      IF(IN(1).EQ.51.AND.IP.EQ.7) WRITE(II,3057) 
      IF(IN(1).EQ.51.AND.IP.EQ.8) WRITE(II,3058) 
      IF(IN(1).EQ.61.AND.IP.EQ.1) WRITE(II,3061) 
      IF(IN(1).EQ.61.AND.IP.EQ.2) WRITE(II,3062) 
      IF(IN(1).EQ.61.AND.IP.EQ.3) WRITE(II,3063) 
      IF(IN(1).EQ.61.AND.IP.EQ.4) WRITE(II,3064) 
      IF(IN(1).EQ.61.AND.IP.EQ.5) WRITE(II,3065) 
      IF(IN(1).EQ.61.AND.IP.EQ.6) WRITE(II,3066) 
      IF(IN(1).EQ.61.AND.IP.EQ.7) WRITE(II,3067) 
      IF(IN(1).EQ.61.AND.IP.EQ.8) WRITE(II,3068) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(IP.EQ.1)
     +WRITE(II,1000)IN(2),IN(3),IN(4),NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.2)
     +  WRITE(II,1000)IN(2),NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.3)
     +  WRITE(II,1000)NULA,IN(3),NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.4)
     +  WRITE(II,1000)NULA,NULA,IN(4),NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.5)
     +WRITE(II,1000)IN(6),IN(7),IN(8),NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.6)
     +  WRITE(II,1000)IN(6),NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.7)
     +  WRITE(II,1000)NULA,IN(7),NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IP.EQ.8)
     +  WRITE(II,1000)NULA,NULA,IN(8),NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IN(1).EQ.1) WRITE(II,1000) NULA,NULA,JEDAN,M7
      IF(IN(1).EQ.11) WRITE(II,1000) NULA,NULA,NULA,M7
      IF(IN(1).EQ.21) WRITE(II,1000) NULA,NULA,M2,M7
      IF(IN(1).EQ.41.OR.IN(1).EQ.51.OR.IN(1).EQ.61)
     +   WRITE(II,1000) NULA,NULA,M3,M7
      IF(IP.EQ.1.OR.IP.EQ.5) THEN
         WRITE(II,1000) JEDAN,JEDAN,JEDAN
      ELSE
         WRITE(II,1000) NULA,JEDAN,JEDAN
      ENDIF
      DO 10 I=1,NPP
         IF(NCVPR.GT.0) THEN
            IJ=NCVP(I)
            IF(IJ.EQ.0) GO TO 10
         ENDIF
         IMA=0
         DO 20 J=1,6
            FSP(J) = 0.0D0
            IF(ID(I,J).EQ.0) GO TO 20
            K = ID(I,J)
            IF(K.GT.0) THEN
               IF(IND.EQ.1.AND.INDOD.EQ.1.AND.IREST.EQ.1) THEN
C                  write(*,*) 'clay-prirastaj pomeranja'
C                  FSP(J)=RTH(K)-RTH(JEDN+K)
                 FSP(J)=RTH(K)
                 IF(DABS(RTH(JEDN+K)).GT.1.E-3) write(*,*) RTH(JEDN+K) 
               ELSE
C                 OVDE DODATI ZA XFEM               
                  FSP(J)=RTH(K)
               ENDIF
            ELSE
               FSP(J)=CONDOF(RTH,A(LCMPC),A(LMPC),K)
            ENDIF
            IF(DABS(FSP(J)).GT.1.D-10) IMA=1
   20    CONTINUE
         IF(IMA.EQ.0.AND.
     +     (IN(1).EQ.41.OR.IN(1).EQ.51)) GO TO 10
         val=0.
         IF(IP.EQ.1) then
            dum=FSP(1)*FSP(1)+FSP(2)*FSP(2)+FSP(3)*FSP(3)
            if(dum.gt.1.e-12) VAL=DSQRT(dum)
	   endif
         IF(IP.EQ.2) VAL=FSP(1)
         IF(IP.EQ.3) VAL=FSP(2)
         IF(IP.EQ.4) VAL=FSP(3)
         IF(IP.EQ.5) then
c proveri
            dum=FSP(4)*FSP(4)+FSP(5)*FSP(5)+FSP(6)*FSP(6)
            if(dum.gt.1.e-12) VAL=DSQRT(dum)
	   endif
         IF(IP.EQ.6) VAL=FSP(4)
         IF(IP.EQ.7) VAL=FSP(5)
         IF(IP.EQ.8) VAL=FSP(6)
         IF(DABS(VAL).LT.1.E-12.AND.
     +     (IN(1).EQ.41.OR.IN(1).EQ.51)) GO TO 10
         IF(ICVEL.EQ.0) THEN
            WRITE(II,5000) I,VAL
         ELSE
            WRITE(II,5000) NCVEL(I),VAL
         ENDIF
   10 CONTINUE
      WRITE(II,5500) MJ,ZERO
   40 IF(IP.LT.8) GO TO 30
	IF(IND.EQ.1.AND.INDOD.EQ.1) THEN
	   IF(IREST.EQ.0) CALL WRITED(RTH(JEDN+1),JEDN,IODUZ)
         CLOSE (IODUZ,STATUS='KEEP')
	ENDIF
      RETURN
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I10,',',F12.4,',')
 3001 FORMAT('TOTAL TRANSLATION')
 3002 FORMAT('T1 TRANSLATION')
 3003 FORMAT('T2 TRANSLATION')
 3004 FORMAT('T3 TRANSLATION')
 3005 FORMAT('TOTAL ROTATION')
 3006 FORMAT('R1 ROTATION')
 3007 FORMAT('R2 ROTATION')
 3008 FORMAT('R3 ROTATION')
 3011 FORMAT('TOTAL VELOCITY')
 3012 FORMAT('T1 VELOCITY')
 3013 FORMAT('T2 VELOCITY')
 3014 FORMAT('T3 VELOCITY')
 3015 FORMAT('TOTAL ANGULAR VELOCITY')
 3016 FORMAT('R1 ANGULAR VELOCITY')
 3017 FORMAT('R2 ANGULAR VELOCITY')
 3018 FORMAT('R3 ANGULAR VELOCITY')
 3021 FORMAT('TOTAL ACCELERATION')
 3022 FORMAT('T1 ACCELERATION')
 3023 FORMAT('T2 ACCELERATION')
 3024 FORMAT('T3 ACCELERATION')
 3025 FORMAT('TOTAL ANGULAR ACCELERATION')
 3026 FORMAT('R1 ANGULAR ACCELERATION')
 3027 FORMAT('R2 ANGULAR ACCELERATION')
 3028 FORMAT('R3 ANGULAR ACCELERATION')
 3041 FORMAT('TOTAL APPLIED FORCE')
 3042 FORMAT('T1 APPLIED FORCE')
 3043 FORMAT('T2 APPLIED FORCE')
 3044 FORMAT('T3 APPLIED FORCE')
 3045 FORMAT('TOTAL APPLIED MOMENT')
 3046 FORMAT('R1 APPLIED MOMENT')
 3047 FORMAT('R2 APPLIED MOMENT')
 3048 FORMAT('R3 APPLIED MOMENT')
 3051 FORMAT('TOTAL CONSTRAINT FORCE')
 3052 FORMAT('T1 CONSTRAINT FORCE')
 3053 FORMAT('T2 CONSTRAINT FORCE')
 3054 FORMAT('T3 CONSTRAINT FORCE')
 3055 FORMAT('TOTAL CONSTRAINT MOMENT')
 3056 FORMAT('R1 CONSTRAINT MOMENT')
 3057 FORMAT('R2 CONSTRAINT MOMENT')
 3058 FORMAT('R3 CONSTRAINT MOMENT')
 3061 FORMAT('TOTAL FILTRATION FORCE')
 3062 FORMAT('T1 FILTRATION FORCE')
 3063 FORMAT('T2 FILTRATION FORCE')
 3064 FORMAT('T3 FILTRATION FORCE')
 3065 FORMAT('TOTAL FILTRATION MOMENT')
 3066 FORMAT('R1 FILTRATION MOMENT')
 3067 FORMAT('R2 FILTRATION MOMENT')
 3068 FORMAT('R3 FILTRATION MOMENT')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C======================================================================
      SUBROUTINE STAUTE(RTH,NCVEL,ICVEL,NP,II,IND,NCVP,NCVPR)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /MPOINC/ MMP,NMPC,NEZAV,LCMPC,LMPC,NEZA1
C
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /SRPSKI/ ISRPS
C
      DIMENSION RTH(*),NCVEL(*),NCVP(*)
C
      NPP=NP
      IF(JPS.GT.1.AND.JPBR.LT.JPS1) NPP=NP-NPK
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M1=1
      M2=2
      M3=3
      M4=4
      M5=5
      M6=6
      M7=7
      M8=8
      M9=9
C      II=49
C
      WRITE(II,1000) KOR,IND,JEDAN
      WRITE(II,3001) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,M6,M7
      WRITE(II,1000) JEDAN,NULA,JEDAN
      DO 10 I=1,NPP
C         IF(NCVPR.GT.0) THEN
C            IJ=NCVP(I)
C            IF(IJ.EQ.0) GO TO 10
C         ENDIF
         IF(ICVEL.EQ.0) THEN
            WRITE(II,5000) I,RTH(I)
         ELSE
            WRITE(II,5000) NCVEL(I),RTH(I)
         ENDIF
   10 CONTINUE
      WRITE(II,5500) MJ,ZERO
      RETURN
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 3001 FORMAT('NODAL TEMPERATURE')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C======================================================================
      SUBROUTINE STAUTD(IRTH,NCVEL,ICVEL,NP,II,IND,ITER)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /MPOINC/ MMP,NMPC,NEZAV,LCMPC,LMPC,NEZA1
C
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /SRPSKI/ ISRPS
C
      DIMENSION IRTH(*),NCVEL(*)
C
      NPP=NP
      IF(JPS.GT.1.AND.JPBR.LT.JPS1) NPP=NP-NPK
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M1=1
      M2=2
      M3=3
      M4=4
      M5=5
      M6=6
      M7=7
      M8=8
      M9=9
C
      WRITE(II,1000) ITER,IND,JEDAN
      WRITE(II,3001) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,M6,M7
      WRITE(II,1000) JEDAN,NULA,JEDAN
      DO 10 I=1,NPP
         IF(ICVEL.EQ.0) THEN
            WRITE(II,5000) I,FLOAT(IRTH(I))
         ELSE
            WRITE(II,5000) NCVEL(I),FLOAT(IRTH(I))
         ENDIF
   10 CONTINUE
      WRITE(II,5500) MJ,ZERO
      RETURN
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 3001 FORMAT('DIVERGENT NODES')
 1005 FORMAT('PAK ITERATION',I5)
 1006 FORMAT('ITER',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C======================================================================
      SUBROUTINE STAUAL(NCVEL,ICVEL,NP,II,IND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      include 'paka.inc'
      
      COMMON /OPSTIP/ JPS,JPBR,NPG,JIDG,JCORG,JCVEL,JELCV,NGA,NGI,NPK,
     1                NPUP,LIPODS,IPODS,LMAX13,MAX13,JEDNG,JMAXA,JEDNP,
     1                NWP,NWG,IDF,JPS1
      COMMON /ITERAC/ METOD,MAXIT,TOLE,TOLS,TOLM,KONVE,KONVS,KONVM
      COMMON /MPOINC/ MMP,NMPC,NEZAV,LCMPC,LMPC,NEZA1
C
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /AUTSTP/ DTUK,ALFG,DELS,IAUTO,ITEOPT,KPNOD,KPDIR,KEQ
      COMMON /AUTST2/ PARAM(5)
      COMMON /SRPSKI/ ISRPS
C
      DIMENSION NCVEL(*)
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M1=1
      M2=2
      M3=3
      M4=4
      M5=5
      M6=6
      M7=7
      M8=8
      M9=9
C
      WRITE(II,1000) KOR,IND,JEDAN
      IF(IND.EQ.32) WRITE(II,3001) 
      IF(IND.EQ.33) WRITE(II,3002) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IND.EQ.32) WRITE(II,1000) NULA,NULA,M3,M7
      IF(IND.EQ.33) WRITE(II,1000) NULA,NULA,M1,M7
      WRITE(II,1000) JEDAN,NULA,JEDAN
C
      IF(IND.EQ.32) THEN
         IF(ICVEL.EQ.0) THEN
            WRITE(II,5000) KPNOD,VREME
         ELSE
            WRITE(II,5000) NCVEL(KPNOD),VREME
         ENDIF
      ENDIF
      IF(IND.EQ.33) THEN
         IF(ICVEL.EQ.0) THEN
            WRITE(II,5000) KPNOD,PARAM(1)
         ELSE
            WRITE(II,5000) NCVEL(KPNOD),PARAM(1)
         ENDIF
      ENDIF
      WRITE(II,5500) MJ,ZERO
      RETURN
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 3001 FORMAT('CRITICAL LOAD')
 3002 FORMAT('ARC LENGTH')
 1005 FORMAT('PAK ',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE NEUTRS(EIG,NC)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.    P R O G R A M
CE.        WITH LOOP OVER TIME PERIODS AND STEPS FOR NEUTRAL FILE
CS.    P R O G R A M
CS.        SA PETLJOM PO VREMENSKIM PERIODIMA I KORACIMA ZA NEUTRAL 
C .
CE.    V A R I A B L E S
CE.        NPER  - TOTAL NUMBER OF PERIODS WITH CONSTANT TIME STEP,
CE.                SEE CARD /3/
C .
C ......................................................................
C
      include 'paka.inc'
      
      CHARACTER*250 NASLOV
      COMMON /NASLOV/ NASLOV
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /SOPSVR/ ISOPS,ISTYP,NSOPV,ISTSV,IPROV,IPROL
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /GRUPEE/ NGEL,NGENL,LGEOM,NGEOM,ITERM
      COMMON /ANALIZ/ LINEAR,ITERGL,INDDIN
      COMMON /PRIMER/ IPRBR,INDIZL,INDGRA,INDNEU
      DIMENSION EIG(*)
C
      II=49
      MJ=-1
C      IF(IND.EQ.2) GO TO 999
C      WRITE(II,1000) MJ
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      MM=0
      IF(NGENL.EQ.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=1
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.1) MM=2
      IF(NGENL.EQ.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=3
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.0) MM=10
      IF(NGENL.GT.0.AND.NDIN.EQ.0.AND.ISOPS.EQ.1) MM=11
      IF(NGENL.GT.0.AND.NDIN.EQ.1.AND.ISOPS.EQ.0) MM=12
C
      WRITE(II,1100) MJ
      M450=450
      WRITE(II,1200) M450
C
CE    BASIC LOOP OVER TIME PERIODS
CS    OSNOVNA PETLJA PO VREMENSKIM PERIODIMA
C
      DO 100 I=1,NC
C
      WRITE(II,1000) I
C      IF(NDT.EQ.1) THEN
C         WRITE(II,1005) I
C         WRITE(II,1000) M9,MM
C         WRITE(II,1010) ZERO
C      ELSE
         WRITE(II,1006) I,EIG(I)
         WRITE(II,1000) M9,MM
         WRITE(II,1010) EIG(I)
C      ENDIF
      WRITE(II,1000) JEDAN
      WRITE(II,2000) NASLOV
C
  100 CONTINUE
C
      WRITE(II,1100) MJ
C
      WRITE(II,1100) MJ
      M451=451
      WRITE(II,1200) M451
      RETURN
C
C  999 WRITE(II,1000) MJ
C      IZNEU=II
C      IF(INDNEU.EQ.1) CLOSE (IZNEU,STATUS='KEEP')
C      RETURN
C
 1100 FORMAT(I5)
 1200 FORMAT(I6)
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE',I5,' EIGV',1PE11.4)
 1010 FORMAT(3(1PE11.4,','))
 2000 FORMAT(A80)
      END
C=====================================================================
      SUBROUTINE TGRAU1(NEL,MCVEL,ICVEL,NMAT,THID,IGRAF)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C .......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT 1D ELEMENTS DATA IN NEUTRAL GRAPHICS FILE
CS.   P R O G R A M
CS.       ZA STAMPANJE 1D ELEMENATA U NEUTRALNI FILE
C .
C .......................................................................
C 
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /SUMELE/ ISUMEL,ISUMGR
      COMMON /SRPSKI/ ISRPS
      COMMON /NIDEAS/ IDEAS
      COMMON /STAPRO/ THIDP(100),NPROPR(100)
      DIMENSION NEL(NE,*),MCVEL(*),NMAT(*),THID(*)
      DIMENSION FIZ(14)         
      COMMON /CDEBUG/ IDEBUG
C
      IF(IDEBUG.GT.0) PRINT *, ' TGRAU1'
      ISUMGR=ISUMGR+1
C
C     FIZICKE OSOBINE
C
      NULA=0
      ZERO=0.
      ONE=1.
      JEDAN=1
      INDPR=25
      INDPD=2
      I11=11
      I2=2
      I4=4
      I8=8
      I14=14
      I48=48
C
      NPROP=1
      DO IM=1,NE
         IF(NPROP.LT.NMAT(IM)) NPROP=NMAT(IM)
      ENDDO
      NPRP=1
      DO IM=1,100
         IF(NPRP.LT.NPROPR(IM)) NPRP=NPROPR(IM)
      ENDDO
      IF(NPRP.NE.NPROP) STOP 'NPRP.NE.NPROP-pakn.for'
      II=IGRAF
      IND=-1
      ITYP=402
      DO 20 I=1,NPROP
         IF(NPROPR(I).EQ.0) GO TO 20
         WRITE(II,5100) IND
         WRITE(II,5001) ITYP
	 IPRO=1
         APR=THIDP(I)
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,I,IPRO,I,NULA
         WRITE(II,2001) I
         WRITE(II,5600) NULA,NULA,NULA,NULA
C 45
         WRITE(II,5600) NULA
C 93
         WRITE(II,5600) JEDAN
         WRITE(II,5500) APR
C
         WRITE(II,5100) IND
   20 CONTINUE
C
 5100 FORMAT(i5)
 5001 FORMAT(i6)
 5500 FORMAT(5(1PE13.5,','))
 5600 FORMAT(6(I4,','))
 2001 FORMAT(' PRO',I4)
 2002 FORMAT(A80)
 5200 FORMAT(F3.1,',')
C
C     E L E M E N T I
C
      NNCVE=NCVE
C     GRAFICKI OPIS ELEMENTA:
C     ROD = 1
C     BAR = 2
      IFGD=1
C     OBLIK 1D ELEMENTA:
C     LINE = 0
      IFDI=0
C     TABELA FIZICKIH OSOBINA
      IPTN=ISUMGR
C     BROJ CVOROVA NA ELEMENTU
      NNODS=NCVE
      IND=-1
      ITYP=404
      WRITE(IGRAF,1100) IND
      WRITE(IGRAF,5001) ITYP
      DO 10 I=1,NE
C        REDNI BROJ ELEMENTA
         IEL=I+ISUMEL
         IF(ICVEL.EQ.1) IEL=MCVEL(I)
C        TABELA MATERIJALA
         MPTN=NMAT(I)
C        BOJA  
         ICOL=124-(MPTN-1)*2
         WRITE(IGRAF,1000) IEL,ICOL,MPTN,IFGD,IFDI,MPTN,NULA,NULA
         WRITE(IGRAF,1001) (NEL(I,J),J=1,2),NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA
         WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1003) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
   10 CONTINUE
      WRITE(IGRAF,1100) IND
      ISUMEL=ISUMEL+NE
      NCVE=NNCVE
      RETURN
C
 1000 FORMAT(I10,',',7(I4,','))
 1001 FORMAT(10(I10,','))
 1011 FORMAT(10(I2,','))
 1002 FORMAT(3(F3.0,','))
 1003 FORMAT(16(I2,','))
 1100 FORMAT(i5)
 1200 FORMAT(6(1PE13.5,','))
      END
C======================================================================
      SUBROUTINE STAU11(SIGMA,AU,ISNA,MCVEL,ICVEL,APRS,
     +                  DEFUK,DEFPL,DEFCR,IPLA)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /NIDEAS/ IDEAS
      COMMON /SRPSKI/ ISRPS
      DIMENSION SIGMA(NE,*),ISNA(*),MCVEL(*),APRS(*),
     1          DEFUK(*),DEFPL(*),DEFCR(*)
      DIMENSION AU(*)
      REAL AU
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
      II=49
C      IF(KOR.EQ.1) WRITE(II,1000) MJ
C      IF(KOR.EQ.1) WRITE(II,1001) M451
      IND=3036
      GO TO 10
   83 IND=3183
      GO TO 10
   84 IND=3184
      GO TO 10
   85 IND=3285
      GO TO 10
   86 IND=3286
      GO TO 10
   87 IND=3287
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(IND.EQ.3036) WRITE(II,3036) 
      IF(IND.EQ.3183) WRITE(II,3183) 
      IF(IND.EQ.3184) WRITE(II,3184) 
      IF(IND.EQ.3285) WRITE(II,3285) 
      IF(IND.EQ.3286) WRITE(II,3286) 
      IF(IND.EQ.3287) WRITE(II,3287) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) IND,IND,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(IND.EQ.3036) WRITE(II,1000) NULA,NULA,M3,M8
      IF(IND.EQ.3183.OR.IND.EQ.3285) WRITE(II,1000) NULA,NULA,M4,M8
      IF(IND.EQ.3184.OR.IND.EQ.3286.OR.IND.EQ.3287) 
     +                WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,M2,JEDAN
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            FORC=SIGMA(NLM,1)*APRS(NLM)
            IF(IND.EQ.3036) WRITE(II,5000) NMM,FORC
            IF(IND.EQ.3183) WRITE(II,5000) NMM,SIGMA(NLM,1)
            IF(IND.EQ.3184) WRITE(II,5000) NMM,SIGMA(NLM,2)
            IF(IND.EQ.3285) WRITE(II,5000) NMM,DABS(SIGMA(NLM,1))
         ELSE
            FORC=SIGMA(NLM,1)*APRS(NLM)
            IF(IND.EQ.3036) WRITE(II,5000) NMM,FORC
            IF(IND.EQ.3183) WRITE(II,5000) NMM,SIGMA(NLM,1)
            IF(IND.EQ.3184) WRITE(II,5000) NMM,DEFUK(NLM)
            IF(IND.EQ.3285) WRITE(II,5000) NMM,DABS(SIGMA(NLM,1))
            IF(IND.EQ.3286) WRITE(II,5000) NMM,DEFPL(NLM)
            IF(IND.EQ.3287) WRITE(II,5000) NMM,DEFCR(NLM)
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
      IF(IND.EQ.3036) GO TO 83
      IF(IND.EQ.3183) GO TO 84
      IF(IND.EQ.3184) GO TO 85
      IF(IND.EQ.3285.AND.IPLA.GT.0) GO TO 86
      IF(IND.EQ.3286.AND.IPLA.EQ.2) GO TO 87
C      IF(KOR.EQ.NDT) WRITE(II,1000) MJ
      RETURN
 1000 FORMAT(10(I5,','))
 1001 FORMAT(I6,',',F12.4,',')
 3036 FORMAT('ROD AXIAL FORCE')
 3183 FORMAT('ROD AXIAL STRESS')
 3184 FORMAT('ROD TOTAL STRAIN')
 3285 FORMAT('ROD EQUIVALENT STRESS')
 3286 FORMAT('ROD PLASTIC STRAIN')
 3287 FORMAT('ROD CREEP STRAIN')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=====================================================================
      SUBROUTINE TGRAU2(NEL,MCVEL,ICVEL,NMAT,THID,IGRAF)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C .......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT 2D ELEMENTS DATA IN NEUTRAL GRAPHICS FILE
CS.   P R O G R A M
CS.       ZA STAMPANJE 2D ELEMENATA U NEUTRALNI FILE
C .
C .......................................................................
C 
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /SUMELE/ ISUMEL,ISUMGR
      COMMON /SRPSKI/ ISRPS
      COMMON /NIDEAS/ IDEAS
      COMMON /SPANEL/ ISHEAR
      COMMON /PODTIP/ IPODT
      DIMENSION NEL(NE,*),MCVEL(*),NMAT(*),THID(*)
      DIMENSION FIZ(14),iprop(100),tprop(100)         
      COMMON /CDEBUG/ IDEBUG
C
      IF(IDEBUG.GT.0) PRINT *, ' TGRAU2'
      ISUMGR=ISUMGR+1
C
C     FIZICKE OSOBINE
C
      call iclear(iprop,100)
      call clear(tprop,100)
      m=0
      do i=1,ne
         iprop(nmat(i))=nmat(i)
         tprop(nmat(i))=thid(i)
      enddo
      NULA=0
      ZERO=0.
      ONE=1.
      JEDAN=1
      INDPR=25
      INDPD=2
      I11=11
      I2=2
      I4=4
      I8=8
      I14=14
      I48=48
C
      II=IGRAF
      IND=-1
      ITYP=402
      do 20 i=1,100
      if(iprop(i).eq.0) go to 20
      WRITE(II,5100) IND
      WRITE(II,5100) ITYP
      IFGD=13
      IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=14
      IF(ISHEAR.EQ.1) THEN
         IFGD=11
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=12
      ENDIF
      IF(IETYP.EQ.2) THEN
         IFGD=19
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=20
      ENDIF
      IF(IETYP.EQ.1) THEN
         IFGD=23
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=24
      ENDIF
	IPRO=IFGD
c      I=NMAT(1)
c      APR=THID(1)
c      I=iprop(i)
      APR=tprop(i)
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,I,IPRO,I,NULA
         WRITE(II,2001) I
         WRITE(II,5600) NULA,NULA,NULA,NULA
C 45
         WRITE(II,5600) NULA
C 93
         WRITE(II,5600) JEDAN
         WRITE(II,5500) APR
      WRITE(II,5100) IND
   20 continue
C
 5100 FORMAT(i5)
 5500 FORMAT(5(1PE13.5,','))
 5600 FORMAT(6(I4,','))
 2001 FORMAT(' PRO',I4)
 2002 FORMAT(A80)
 5200 FORMAT(F3.1,',')
C
C     E L E M E N T I
C
      NNCVE=NCVE
      IF(NCVE.LT.8.and.ipodt.eq.0) NCVE=4
      IF(NCVE.LT.6.and.ipodt.eq.1) NCVE=3
      IF(NCVE.EQ.9) NCVE=8
C     GRAFICKI OPIS ELEMENTA:
C     SHEAR - SA 4 CVOROVA = 11, SA 8 CVOROVA = 12
C     MEMBRANE - SA 4 CVOROVA = 13, SA 8 CVOROVA = 14
C     PLANE STRAIN - SA 4 CVOROVA = 19, SA 8 CVOROVA = 20
C     AXISYMMETRIC - SA 4 CVOROVA = 23, SA 8 CVOROVA = 24
C     PLATE - SA 4 CVOROVA = 17, SA 8 CVOROVA = 18
C     LAMINATE - SA 4 CVOROVA = 21, SA 8 CVOROVA = 22
      IFGD=13
      IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=14
      IF(ISHEAR.EQ.1) THEN
         IFGD=11
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=12
      ENDIF
      IF(IETYP.EQ.2) THEN
         IFGD=19
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=20
      ENDIF
      IF(IETYP.EQ.1) THEN
         IFGD=23
         IF(NCVE.EQ.8.or.(ncve.eq.6.and.ipodt.eq.1)) IFGD=24
C     VRSTA 2D trougaoni ELEMENTA: SA 3 CVOROVA = 2, SA 6 CVOROVA = 3
C     VRSTA 2D cetvorougaoni ELEMENTA: SA 4 CVOROVA = 4, SA 8 CVOROVA = 5
      ENDIF
      IFDI=2
      IF(NCVE.EQ.6.and.ipodt.eq.1) IFDI=3
      IF(NCVE.EQ.4.and.ipodt.eq.0) IFDI=4
      IF(NCVE.EQ.8.and.ipodt.eq.0) IFDI=5
C     TABELA FIZICKIH OSOBINA
      IPTN=ISUMGR
C     BROJ CVOROVA NA ELEMENTU
      NNODS=NCVE
      IND=-1
      ITYP=404
      WRITE(IGRAF,1100) IND
      WRITE(IGRAF,1100) ITYP
      DO 10 I=1,NE
C        REDNI BROJ ELEMENTA
         IEL=I+ISUMEL
         IF(ICVEL.EQ.1) IEL=MCVEL(I)
C        TABELA MATERIJALA
         MPTN=NMAT(I)
C        BOJA  
         ICOL=124-(MPTN-1)*2
         WRITE(IGRAF,1000) IEL,ICOL,MPTN,IFGD,IFDI,MPTN,NULA,NULA
         IF(NCVE.EQ.3) THEN
            WRITE(IGRAF,1001) (NEL(I,J),J=1,3),NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ELSEIF(NCVE.EQ.6) THEN
            WRITE(IGRAF,1001) (NEL(I,J),J=1,6),NULA,NULA,
     +                        NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ELSEIF(NCVE.EQ.4) THEN
            WRITE(IGRAF,1001) (NEL(I,J),J=1,4),NULA,NULA,NULA,NULA,
     +                        NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ELSEif(ncve.eq.8) then
            WRITE(IGRAF,1001) (NEL(I,J),J=1,8),
     +                        NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ENDIF
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1003) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
   10 CONTINUE
      WRITE(IGRAF,1100) IND
      ISUMEL=ISUMEL+NE
      NCVE=NNCVE
      RETURN
C
 1000 FORMAT(I10,',',7(I4,','))
 1001 FORMAT(10(I10,','))
 1011 FORMAT(10(I2,','))
 1002 FORMAT(3(F3.0,','))
 1003 FORMAT(16(I2,','))
 1100 FORMAT(i5)
 1200 FORMAT(6(1PE13.5,','))
      END
C======================================================================
      SUBROUTINE STAU21(SIGMA,AU,ISNA,MCVEL,ICVEL,APRS,
     +                  DEFUK,DEFPL,DEFCR,IPLA,
     +                  NODTIP,NEL,NCXFEM)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NIDEAS/ IDEAS
      DIMENSION ISNA(*),MCVEL(*),APRS(NE,*),
     1          DEFUK(*),DEFPL(*),DEFCR(*),NODTIP(*),NEL(NE,*)
      DIMENSION SIGMA(4,NGS12,NE,*),S(7),N(20)
      DIMENSION AU(*)
      REAL AU
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C      IF(KOR.EQ.1) WRITE(II,5000) MJ
C      IF(KOR.EQ.1) WRITE(II,1001) M451
C
      IND=7020
      NND=100220
      CALL NAPUNI(N,NCVE,NND)
      GO TO 10
   83 IND=7021
      NND=100221
      CALL NAPUNI(N,NCVE,NND)
      GO TO 10
   84 IND=7023
      NND=100223
      CALL NAPUNI(N,NCVE,NND)
      GO TO 10
   85 IND=7022
      NND=100222
      CALL NAPUNI(N,NCVE,NND)
      GO TO 10
   86 IND=7033
      NND=100233
      CALL NAPUNI(N,NCVE,NND)
      GO TO 10
C   87 IND=3287
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(IND.EQ.7020) WRITE(II,7020) 
      IF(IND.EQ.7021) WRITE(II,7021) 
      IF(IND.EQ.7022) WRITE(II,7022) 
      IF(IND.EQ.7023) WRITE(II,7023) 
      IF(IND.EQ.7024) WRITE(II,7024) 
      IF(IND.EQ.7025) WRITE(II,7025) 
      IF(IND.EQ.7033) WRITE(II,7033) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
      WRITE(II,1000) 
     +      N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,JEDAN
      NGS12X=NGAUSX*NGAUSY
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
C        STAMPANJE ZA XFEM
         IF(NCXFEM.GT.0) THEN      
            NGS12X=NGAUSX*NGAUSY
            DO 14 NCC=1,NCVE
               IF(NEL(NLM,NCC).EQ.0) GO TO 14              
               JJ=NODTIP(NEL(NLM,NCC))
               IF(JJ.NE.0) NGS12X=NGS12
   14       CONTINUE
         ENDIF                                                           
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         CALL SREDK2(SIGMA,S,NLM,NGS12,NE,NGS12X)
         IF(IPLA.EQ.0) THEN
            IF(IND.EQ.7020) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.7021) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.7022) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.7023) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.7033) WRITE(II,5000) NMM,S(7)
         ELSE
         ENDIF
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
C
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(IND.EQ.7020) WRITE(II,17020) NC 
      IF(IND.EQ.7021) WRITE(II,17021) NC 
      IF(IND.EQ.7022) WRITE(II,17022) NC 
      IF(IND.EQ.7023) WRITE(II,17023) NC 
      IF(IND.EQ.7024) WRITE(II,17024) NC 
      IF(IND.EQ.7025) WRITE(II,17025) NC 
      IF(IND.EQ.7033) WRITE(II,17033) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY+2
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY+1
      ENDIF
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY+3
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY+1
      ENDIF
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.6) THEN
         IF(NC.EQ.1) IJ=36
         IF(NC.EQ.2) IJ=6
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=31
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY+2
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY+1
         IF(NC.EQ.5) THEN
            IJ=-(NGAUSY+2)
            JI=2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-2
            JI=1
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-1
            JI=NGAUSY+1
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-(NGAUSY+1)
            JI=NGAUSY+2
         ENDIF
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY+3
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY+1
         IF(NC.EQ.5) IJ=NGAUSY+3
         IF(NC.EQ.6) IJ=2
         IF(NC.EQ.7) IJ=NGAUSY+1
         IF(NC.EQ.8) IJ=2*NGAUSY+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.5) THEN
         IF(NC.EQ.1) IJ=4*NGAUSY+5
         IF(NC.EQ.2) IJ=5
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=4*NGAUSY+1
         IF(NC.EQ.5) IJ=2*NGAUSY+5
         IF(NC.EQ.6) IJ=3
         IF(NC.EQ.7) IJ=2*NGAUSY+1
         IF(NC.EQ.8) IJ=4*NGAUSY+3
      ENDIF
      IJX=IJ
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
C        STAMPANJE ZA XFEM
         IF(NCXFEM.GT.0) THEN      
            IJ=IJX
            DO 24 NCC=1,NCVE
               IF(NEL(NLM,NCC).EQ.0) GO TO 24              
               JJ=NODTIP(NEL(NLM,NCC))
               IF(JJ.NE.0) THEN
                  IF(NC.EQ.1) IJ=36
                  IF(NC.EQ.2) IJ=6
                  IF(NC.EQ.3) IJ=1
                  IF(NC.EQ.4) IJ=31
                  GO TO 25
               ENDIF
   24       CONTINUE
         ENDIF                                                           
C
   25    NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(IND.EQ.7020.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
            ELSEIF(IND.EQ.7020.AND.IJ.LT.0) THEN
               POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.7021.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
            ELSEIF(IND.EQ.7021.AND.IJ.LT.0) THEN
               POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.7022.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
            ELSEIF(IND.EQ.7022.AND.IJ.LT.0) THEN
               POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.7023.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
            ELSEIF(IND.EQ.7023.AND.IJ.LT.0) THEN
               POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.7033.AND.IJ.GT.0) THEN
               XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
               YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(4,IJ,NLM,1)
               ZMX=SIGMA(4,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
               EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(3,IJ,NLM,1)*SIGMA(3,IJ,NLM,1))
               IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
               WRITE(II,5000) NMM,EFEK
            ELSEIF(IND.EQ.7033.AND.IJ.LT.0) THEN
               XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
               YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(4,-IJ,NLM,1)
               ZMX=SIGMA(4,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
               EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(3,-IJ,NLM,1)*SIGMA(3,-IJ,NLM,1))
               IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
               XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
               YMZ=SIGMA(2,JI,NLM,1)-SIGMA(4,JI,NLM,1)
               ZMX=SIGMA(4,JI,NLM,1)-SIGMA(1,JI,NLM,1)
               EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(3,JI,NLM,1)*SIGMA(3,JI,NLM,1))
               IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
               EFEK=(EFEK+EFE1)/2
               WRITE(II,5000) NMM,EFEK
            ENDIF
         ELSE
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
      IF(IND.EQ.7020) GO TO 83
      IF(IND.EQ.7021) GO TO 84
      IF(IND.EQ.7023) GO TO 85
      IF(IND.EQ.7022) GO TO 86
C      IF(IND.EQ.3184) GO TO 85
C      IF(IND.EQ.3285.AND.IPLA.GT.0) GO TO 86
C      IF(IND.EQ.3286.AND.IPLA.EQ.2) GO TO 87
C      IF(KOR.EQ.NDT) WRITE(II,5000) MJ
      RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
 7020 FORMAT('SOLID X NORMAL STRESS')
17020 FORMAT('NODE',I5,' X NORMAL STRESS')
 7021 FORMAT('SOLID Y NORMAL STRESS')
17021 FORMAT('NODE',I5,' Y NORMAL STRESS')
 7022 FORMAT('SOLID Z NORMAL STRESS')
17022 FORMAT('NODE',I5,' Z NORMAL STRESS')
 7023 FORMAT('SOLID XY SHEAR STRESS')
17023 FORMAT('NODE',I5,' XY SHEAR STRESS')
 7024 FORMAT('SOLID YZ SHEAR STRESS')
17024 FORMAT('NODE',I5,' YZ SHEAR STRESS')
 7025 FORMAT('SOLID ZX SHEAR STRESS')
17025 FORMAT('NODE',I5,' ZX SHEAR STRESS')
 7033 FORMAT('SOLID VONMISES STRESS')
17033 FORMAT('NODE',I5,' VONMISES STRESS')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE NAPUNI(N,NCVE,NND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION N(*)
C
      CALL ICLEAR(N,20)
      IDEL=50000
      NND=NND-IDEL
      DO 10 I=1,NCVE
         N(I)=NND+I*IDEL
   10 CONTINUE
      RETURN
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE SREDK2(SIGMA,S,NLM,NGS12,NE,NGS12X)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION SIGMA(4,NGS12,NE,*),S(7)
C
      CALL CLEAR(S,7)
      DO 10 I=1,NGS12X
         S(1)=S(1)+SIGMA(1,I,NLM,1)
         S(2)=S(2)+SIGMA(2,I,NLM,1)
         S(3)=S(3)+SIGMA(3,I,NLM,1)
         S(4)=S(4)+SIGMA(4,I,NLM,1)
   10 CONTINUE
      S(1)=S(1)/NGS12X
      S(2)=S(2)/NGS12X
      S(3)=S(3)/NGS12X
      S(4)=S(4)/NGS12X
      XMY=S(1)-S(2)
      YMZ=S(2)-S(4)
      ZMX=S(4)-S(1)
      EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1     3.D0*(S(3)*S(3))
      IF(EFEK.GT.1.D-19) S(7)=DSQRT(EFEK)
      RETURN
      END
C======================================================================
      SUBROUTINE STAU25(SIGMA,ISNA,MCVEL,ICVEL,PLAST,AU,IPLA,NMAT)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NIDEAS/ IDEAS
      COMMON /SRPSKI/ ISRPS
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      DIMENSION AU(*)
      REAL AU
      DIMENSION ISNA(*),MCVEL(*),PLAST(*),NMAT(*)
      DIMENSION SIGMA(4,NGS12,NE,*),S(7),N(20)
C
      NNCVE=NCVE
      IF(NCVE.LT.8) NCVE=4
      IF(NCVE.EQ.9) NCVE=8
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C
      NPROS=MODPR2(NMODM)
      NGXYZ=NGS12*NPROS*MXS
C
      IND=60010
      NND=70010
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=1
      GO TO 10
   83 IND=60011
      NND=70011 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=2
      GO TO 10
   84 IND=60012
      NND=70012 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=4
      IF(IETYP.NE.1) GO TO 31
      GO TO 10
   85 IND=60013
      NND=70013 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=3
      GO TO 10
   88 IND=60031
      NND=70031 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=5
      GO TO 10
C
  182 IND=60050
      NND=70050
      CALL NAPUN3(N,NCVE,NND)
      KK=5
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  183 IND=60051
      NND=70051 
      CALL NAPUN3(N,NCVE,NND)
      KK=5
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  184 IND=60052
      NND=70052 
      CALL NAPUN3(N,NCVE,NND)
      KK=5
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IETYP.NE.1) GO TO 31
      GO TO 10
  185 IND=60053
      NND=70053 
      CALL NAPUN3(N,NCVE,NND)
      KK=5
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  188 IND=60061
      NND=70061 
      CALL NAPUN3(N,NCVE,NND)
      KK=5
      INP=-5
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
C
  282 IND=60066
      NND=70066
      CALL NAPUN3(N,NCVE,NND)
      KK=9
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  283 IND=60067
      NND=70067 
      CALL NAPUN3(N,NCVE,NND)
      KK=9
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  284 IND=60068
      NND=70068 
      CALL NAPUN3(N,NCVE,NND)
      KK=9
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IETYP.NE.1) GO TO 31
      GO TO 10
  285 IND=60069
      NND=70069 
      CALL NAPUN3(N,NCVE,NND)
      KK=9
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
  288 IND=60072
      NND=70072 
      CALL NAPUN3(N,NCVE,NND)
      KK=9
      INP=-5
C     IF(ISTDE.EQ.-1) GO TO 31
      GO TO 10
C
  382 IND=60041
      NND=70041
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=1
      IF(NMODM.NE.9) GO TO 31
      GO TO 10
  383 IND=60042
      NND=70042
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      IF(SCMS(3,1).LT.1.D-10.AND.KRIT(1).EQ.0) GO TO 31
      GO TO 10
  384 IND=60043
      NND=70043
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      IF(SCMS(3,1).LT.1.D-10.AND.KRIT(1).EQ.0) GO TO 31
      GO TO 10
C
  387 IND=67091
      NND=77091
      CALL NAPUN3(N,NCVE,NND)
      KK= 9
      INP=1
      IF(NMODM.NE.61) GO TO 31
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,60010) 
         IF(IND.EQ.60011) WRITE(II,60011) 
         IF(IND.EQ.60012) WRITE(II,60012) 
         IF(IND.EQ.60013) WRITE(II,60013) 
         IF(IND.EQ.60031) WRITE(II,60031) 
      ENDIF   
      IF(KK.EQ.5.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,60050) 
         IF(IND.EQ.60051) WRITE(II,60051) 
         IF(IND.EQ.60052) WRITE(II,60052) 
         IF(IND.EQ.60053) WRITE(II,60053) 
         IF(IND.EQ.60061) WRITE(II,60061) 
      ENDIF   
      IF(KK.EQ.9.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,60066) 
         IF(IND.EQ.60067) WRITE(II,60067) 
         IF(IND.EQ.60068) WRITE(II,60068) 
         IF(IND.EQ.60069) WRITE(II,60069) 
         IF(IND.EQ.60072) WRITE(II,60072) 
      ENDIF   
      IF(IND.EQ.60041) WRITE(II,60041) 
      IF(IND.EQ.60042) WRITE(II,60042) 
      IF(IND.EQ.60043) WRITE(II,60043) 
      IF(IND.EQ.67091) WRITE(II,67091) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(ISTNA.EQ.0) THEN
       WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
       WRITE(II,1000) 
     +       N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      ELSE
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      ENDIF
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      IF(ISTNA.EQ.0) THEN
         WRITE(II,1000) NULA,NULA,JEDAN
      ELSE
         WRITE(II,1000) JEDAN,NULA,JEDAN
      ENDIF
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         MAT=NMAT(NLM)
         IF(IPLA.EQ.0) THEN
            NGS12X=NGAUSX*NGAUSY
            CALL SREDK2(SIGMA,S,NLM,NGS12,NE,NGS12X)
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(INP.NE.0) CALL SREDK25(PLAST(LL),S,NPROS,NGS12,INP)
            IF(INP.EQ.0) CALL SREDNP2(PLAST(LL),S,NPROS,NGS12,DM,ER,MAT,
     1                                NLM,0)
         ENDIF
         IF(KK.EQ.1.AND.INP.NE.0) THEN
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(5)
         ENDIF
         IF(KK.EQ.5.AND.INP.NE.0) THEN
            IF(IND.EQ.60050) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60051) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60052) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60053) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60061) WRITE(II,5000) NMM,S(5)
         ENDIF
         IF(KK.EQ.9.AND.INP.NE.0) THEN
            IF(IND.EQ.60066) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60067) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60068) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60069) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60072) WRITE(II,5000) NMM,S(5)
         ENDIF
         IF(IND.EQ.60041) WRITE(II,5000) NMM,S(1)
         IF(IND.EQ.60042) WRITE(II,5000) NMM,DM
         IF(IND.EQ.60043) WRITE(II,5000) NMM,ER
         IF(IND.EQ.67091) WRITE(II,5000) NMM,S(1)
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
      IF(ISTNA.GT.0) GO TO 31
C
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,70010) NC 
         IF(IND.EQ.60011) WRITE(II,70011) NC 
         IF(IND.EQ.60012) WRITE(II,70012) NC 
         IF(IND.EQ.60013) WRITE(II,70013) NC 
         IF(IND.EQ.60031) WRITE(II,70031) NC 
      ENDIF   
      IF(KK.EQ.5.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,70050) NC 
         IF(IND.EQ.60051) WRITE(II,70051) NC 
         IF(IND.EQ.60052) WRITE(II,70052) NC 
         IF(IND.EQ.60053) WRITE(II,70053) NC 
         IF(IND.EQ.60061) WRITE(II,70061) NC 
      ENDIF   
      IF(KK.EQ.9.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,70066) NC 
         IF(IND.EQ.60067) WRITE(II,70067) NC 
         IF(IND.EQ.60068) WRITE(II,70068) NC 
         IF(IND.EQ.60069) WRITE(II,70069) NC 
         IF(IND.EQ.60072) WRITE(II,70072) NC 
      ENDIF   
      IF(IND.EQ.60041) WRITE(II,70041) NC 
      IF(IND.EQ.60042) WRITE(II,70042) NC 
      IF(IND.EQ.60043) WRITE(II,70043) NC 
      IF(IND.EQ.67091) WRITE(II,77091) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY+2
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY+1
      ENDIF
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY+3
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY+1
      ENDIF
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.6) THEN
         IF(NC.EQ.1) IJ=36
         IF(NC.EQ.2) IJ=6
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=31
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY+2
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY+1
         IF(NC.EQ.5) THEN
         	IJ=-(NGAUSY+2)
         	JI=2
	 ENDIF         	
         IF(NC.EQ.6) THEN
         	IJ=-2
         	JI=1
	 ENDIF         	
         IF(NC.EQ.7) THEN
         	IJ=-1
         	JI=NGAUSY+1
	 ENDIF         	
         IF(NC.EQ.8) THEN
         	IJ=-(NGAUSY+1)
         	JI=NGAUSY+2
	 ENDIF         	
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY+3
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY+1
         IF(NC.EQ.5) IJ=NGAUSY+3
         IF(NC.EQ.6) IJ=2
         IF(NC.EQ.7) IJ=NGAUSY+1
         IF(NC.EQ.8) IJ=2*NGAUSY+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.5) THEN
         IF(NC.EQ.1) IJ=4*NGAUSY+5
         IF(NC.EQ.2) IJ=5
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=4*NGAUSY+1
         IF(NC.EQ.5) IJ=2*NGAUSY+5
         IF(NC.EQ.6) IJ=3
         IF(NC.EQ.7) IJ=2*NGAUSY+1
         IF(NC.EQ.8) IJ=4*NGAUSY+3
      ENDIF
c
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(KK.EQ.1) THEN
               IF(IND.EQ.60010.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
               ELSEIF(IND.EQ.60010.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60011.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
               ELSEIF(IND.EQ.60011.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60012.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
               ELSEIF(IND.EQ.60012.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60013.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
               ELSEIF(IND.EQ.60013.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60031.AND.IJ.GT.0) THEN
                  XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
                  YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(4,IJ,NLM,1)
                  ZMX=SIGMA(4,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(3,IJ,NLM,1)*SIGMA(3,IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSEIF(IND.EQ.60031.AND.IJ.LT.0) THEN
                  XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
                  YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(4,-IJ,NLM,1)
                  ZMX=SIGMA(4,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(3,-IJ,NLM,1)*SIGMA(3,-IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
                  YMZ=SIGMA(2,JI,NLM,1)-SIGMA(4,JI,NLM,1)
                  ZMX=SIGMA(4,JI,NLM,1)-SIGMA(1,JI,NLM,1)
                  EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(3,JI,NLM,1)*SIGMA(3,JI,NLM,1))
                  IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                  EFEK=(EFEK+EFE1)/2
                  WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF   
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(IND.EQ.60010.OR.IND.EQ.60050.OR.IND.EQ.60066.OR.
     1         IND.EQ.60041) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(LL+(-IJ-1)*NPROS)+PLAST(LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60011.OR.IND.EQ.60051.OR.IND.EQ.60067) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(1+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(1+LL+(-IJ-1)*NPROS)+PLAST(1+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60012.OR.IND.EQ.60052.OR.IND.EQ.60068) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(3+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(3+LL+(-IJ-1)*NPROS)+PLAST(3+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60013.OR.IND.EQ.60053.OR.IND.EQ.60069) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(2+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(2+LL+(-IJ-1)*NPROS)+PLAST(2+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60031.OR.IND.EQ.60061.OR.IND.EQ.60072) THEN
               IF(IJ.GT.0) THEN
                  XMY=PLAST(  LL+(IJ-1)*NPROS)-PLAST(1+LL+(IJ-1)*NPROS)
                  YMZ=PLAST(1+LL+(IJ-1)*NPROS)-PLAST(3+LL+(IJ-1)*NPROS)
                  ZMX=PLAST(3+LL+(IJ-1)*NPROS)-PLAST(  LL+(IJ-1)*NPROS)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(2+LL+(IJ-1)*NPROS)*PLAST(2+LL+(IJ-1)*NPROS))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSE
                 XMY=PLAST(  LL+(-IJ-1)*NPROS)-PLAST(1+LL+(-IJ-1)*NPROS)
                 YMZ=PLAST(1+LL+(-IJ-1)*NPROS)-PLAST(3+LL+(-IJ-1)*NPROS)
                 ZMX=PLAST(3+LL+(-IJ-1)*NPROS)-PLAST(  LL+(-IJ-1)*NPROS)
                 EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1        3.D0*(PLAST(2+LL+(-IJ-1)*NPROS)*PLAST(2+LL+(-IJ-1)*NPROS))
                   IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                   XMY=PLAST(  LL+(JI-1)*NPROS)-PLAST(1+LL+(JI-1)*NPROS)
                   YMZ=PLAST(1+LL+(JI-1)*NPROS)-PLAST(3+LL+(JI-1)*NPROS)
                   ZMX=PLAST(3+LL+(JI-1)*NPROS)-PLAST(  LL+(JI-1)*NPROS)
                   EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(2+LL+(JI-1)*NPROS)*PLAST(2+LL+(JI-1)*NPROS))
                   IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                   EFEK=(EFEK+EFE1)/2
                   WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF
C
            IF(IND.EQ.60042) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP2(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC)
                  WRITE(II,5000) NMM,DM
               ELSE
           CALL SREDNP2(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC)
            CALL SREDNP2(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC)
                  POLA=(D1+D2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60043) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP2(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC)
                  WRITE(II,5000) NMM,ER
               ELSE
           CALL SREDNP2(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC)
            CALL SREDNP2(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC)
                  POLA=(E1+E2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
C
   31 CONTINUE
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) GO TO  83
         IF(IND.EQ.60011) GO TO  84
         IF(IND.EQ.60012) GO TO  85
         IF(IND.EQ.60013) GO TO  88
         IF(IND.EQ.60031) GO TO 182
      ENDIF
      IF(KK.EQ.5.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) GO TO 183
         IF(IND.EQ.60051) GO TO 184
         IF(IND.EQ.60052) GO TO 185
         IF(IND.EQ.60053) GO TO 188
         IF(IND.EQ.60061)THEN
            IF(NMODM.EQ.61)GO TO 387
            IF(NMODM.EQ.28)GO TO 999
            GO TO 282
         ENDIF
      ENDIF
      IF(IND.EQ.67091) GO TO 999
      IF(KK.EQ.9.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) GO TO 283
         IF(IND.EQ.60067) GO TO 284
         IF(IND.EQ.60068) GO TO 285
         IF(IND.EQ.60069) GO TO 288
         IF(IND.EQ.60072) GO TO 382
      ENDIF
      IF(IND.EQ.60041) GO TO 383
      IF(IND.EQ.60042) GO TO 384
C     IF(IND.EQ.60043) GO TO 385
C      IF(KOR.EQ.NDT) WRITE(II,5000) MJ
  999 RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
60050 FORMAT('SOLID X NORMAL STRAIN')
70050 FORMAT('SOLID NODE',I10,' X NORMAL STRAIN')
60051 FORMAT('SOLID Y NORMAL STRAIN')
70051 FORMAT('SOLID NODE',I10,' Y NORMAL STRAIN')
60052 FORMAT('SOLID Z NORMAL STRAIN')
70052 FORMAT('SOLID NODE',I10,' Z NORMAL STRAIN')
60053 FORMAT('SOLID XY SHEAR STRAIN')
70053 FORMAT('SOLID NODE',I10,' XY SHEAR STRAIN')
60061 FORMAT('SOLID EQUIV STRAIN')
70061 FORMAT('SOLID NODE',I10,' EQUIV STRAIN')
60066 FORMAT('SOLID X NORMAL PLASTIC STRAIN')
70066 FORMAT('SOLID NODE',I10,' X NORMAL PLASTIC STRAIN')
60067 FORMAT('SOLID Y NORMAL PLASTIC STRAIN')
70067 FORMAT('SOLID NODE',I10,' Y NORMAL PLASTIC STRAIN')
60068 FORMAT('SOLID Z NORMAL PLASTIC STRAIN')
70068 FORMAT('SOLID NODE',I10,' Z NORMAL PLASTIC STRAIN')
60069 FORMAT('SOLID XY SHEAR PLASTIC STRAIN')
70069 FORMAT('SOLID NODE',I10,' XY SHEAR PLASTIC STRAIN')
60072 FORMAT('SOLID EQUIV PLASTIC STRAIN')
70072 FORMAT('SOLID NODE',I10,' EQUIV PLASTIC STRAIN')
60041 FORMAT('SOLID P0')
70041 FORMAT('SOLID NODE',I10,' P0')
60042 FORMAT('SOLID d')
70042 FORMAT('SOLID NODE',I10,' d')
60043 FORMAT('SOLID r=d/D')
70043 FORMAT('SOLID NODE',I10,' r=d/D')
C
67091 FORMAT('2D - DAMAGE')
77091 FORMAT('NODE',I10,' 2D-DAMAGE')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
      SUBROUTINE SREDK25(SIGMA,S,NPROS,NGS12,IND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION SIGMA(*),S(7)
C
      MINUS=0
      IF(IND.LT.0) THEN
         MINUS=1
         IND=-IND
      ENDIF
      CALL CLEAR(S,7)
      DO 10 I=1,NGS12
         GO TO (1,2,3,4,5)IND
    1    S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
         GO TO 10
    2    S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
         GO TO 10
    3    S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
         GO TO 10
    4    S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
         GO TO 10
    5    S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
         S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
         S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
         S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
   10 CONTINUE
C
      IF(IND.EQ.5) THEN
         IF(MINUS.EQ.0) THEN
            XMY=S(1)-S(2)
            YMZ=S(2)-S(4)
            ZMX=S(4)-S(1)
            EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1           3.D0*(S(3)*S(3))
            IF(EFEK.GT.1.D-19) S(5)=DSQRT(EFEK)
         ELSE
            SR=(S(1)+S(2)+S(4))/3.
            SD1=S(1)-SR
            SD2=S(2)-SR
            SD3=S(4)-SR
            EFEK=2.*(SD1*SD1+SD2*SD2+SD3*SD3+
     1               S(4)*S(4))/3.
            IF(EFEK.GT.1.D-19) S(5)=DSQRT(EFEK)
         ENDIF
      ENDIF
      RETURN
      END
C=======================================================================
      SUBROUTINE SREDNP2(SIGMA,S,NPROS,NGS12,DM,ER,MAT,NLM,NC)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      COMMON /PRINCI/ PRINC(3)
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
C     
      DIMENSION SIGMA(*),S(7)
C
      IF(NC.EQ.0) THEN
         CALL CLEAR(S,7)
         DO 10 I=1,NGS12
            S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
            S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
            S(4)=S(4)+SIGMA(3+(I-1)*NPROS)/NGS12
            S(3)=S(3)+SIGMA(4+(I-1)*NPROS)/NGS12
   10    CONTINUE
      ELSE
         S(1)=SIGMA(1)
         S(2)=SIGMA(2)
         S(4)=SIGMA(3)
         S(3)=SIGMA(4)
         S(5)=0.
         S(6)=0.
      ENDIF
C
      CALL GLAVN(S)
C      IF(DABS(PRINC(1)).GT.DABS(PRINC(3))) THEN
C         DUM=PRINC(1)
C         PRINC(1)=PRINC(3)
C         PRINC(3)=DUM
C      ENDIF
C
      IF(KRIT(MAT).EQ.0.and.scms(3,mat).gt.1.e-12) THEN
         A=SCMS(1,MAT)*SCMS(3,MAT)      
         B=SCMS(2,MAT)*SCMS(3,MAT)*SCMS(3,MAT)
c         C=-PRINC(1)-PRINC(3)
         C=-PRINC(1)-PRINC(3)-princ(2)
c         S1H=C/2      
c         S3H=C/2  
         S1H=C/3      
         S3H=C/3  
         A4C=A+4*C   
         QR=A4C*A4C-16*(C*C-B)
         IF(QR.GT.0.) THEN
            QR=DSQRT(QR)
         ELSE
            WRITE(3,*) ' QR<0',NLM,NC,MAT,QR,PRINC(3),PRINC(1),PRINC(2)
            WRITE(*,*) ' QR<0',NLM,NC,MAT,QR,PRINC(3),PRINC(1),PRINC(2)
            QR=0.
C           STOP ' QR<0'
            WRITE(3,*) ' SLOM NEMA RESENJA',NLM,NC,MAT
            CALL WRR6(S,6,'S   ')
            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
            WRITE(*,*) ' SLOM NEMA RESENJA',NLM,NC,PRINC(1),PRINC(2)
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
c provera za levo od normale kroz kroz tacku T
            dum=(a-dsqrt(a*a+4.*b))/2.
            s3k=(dum-princ(1)+princ(3))/2.
            if(-princ(1).lt.s3k) then
               ER1=0.
               ER2=0.
            endif
            GO TO 99
         ENDIF 
         S3GR1=(A4C+QR)/8
         S3GR2=(A4C-QR)/8
         S1GR1=S3GR1+DSQRT(A*S3GR1+B)
         S1GR22=S3GR2+DSQRT(A*S3GR2+B)
C  provera resenja    
         S1GR11=C-S3GR1
         S1GR2=C-S3GR2
         DS1=(S1GR1-S1GR11)/S1GR1
         DS2=(S1GR2-S1GR22)/S1GR2
c         IF(DABS(DS1).GT.DABS(S1GR1)*.1) THEN 
c            WRITE(3,*) ' nije isto DS1',NLM,NC,DS1
c            WRITE(*,*) ' nije isto DS1',NLM,NC,DS1
c         ENDIF
         IF(DABS(DS2).GT.DABS(S1GR2)*.1) THEN 
            WRITE(3,*) ' s1gr2,s1gr22',NLM,NC,s1gr2,s1gr22
            WRITE(*,*) ' s1gr2,s1gr22',NLM,NC,s1gr2,s1gr22
         ENDIF
C  kraj provere
         SGR1SR1=S1GR1+PRINC(3)
         SGR3SR1=S3GR1+PRINC(1)
         DM1=DSQRT((S1GR1+PRINC(3))*(S1GR1+PRINC(3))+
     1             (S3GR1+PRINC(1))*(S3GR1+PRINC(1)))
         IF(SGR1SR1.LT.0..AND.SGR3SR1.GT.0.) DM1=0.
         SGR1SR2=S1GR2+PRINC(3)
         SGR3SR2=S3GR2+PRINC(1)
         DM2=DSQRT((S1GR2+PRINC(3))*(S1GR2+PRINC(3))+
     1             (S3GR2+PRINC(1))*(S3GR2+PRINC(1)))
         IF(SGR1SR2.LT.0..AND.SGR3SR2.GT.0.) DM2=0.
         DV1=DSQRT((S1GR1-S1H)*(S1GR1-S1H)+
     1             (S3GR1-S3H)*(S3GR1-S3H))
         DV2=DSQRT((S1GR2-S1H)*(S1GR2-S1H)+
     1             (S3GR2-S3H)*(S3GR2-S3H))
         IF(-PRINC(1).LE.S3GR2) THEN
C            WRITE(3,*) ' SLOM LEVO',NLM,NC,MAT
C            CALL WRR6(S,6,'S   ')
C            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
C            WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
C            WRITE(3,*) ' S3H',S3H,S1H
C            WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
C            WRITE(*,*) ' SLOM LEVO',NLM,NC,PRINC(1),S3GR2
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
c provera za levo od normale kroz kroz tacku T
            dum=(a-dsqrt(a*a+4.*b))/2.
            s3k=(dum-princ(1)+princ(3))/2.
            if(-princ(1).lt.s3k) then
               ER1=0.
               ER2=0.
            endif
            GO TO 99
         ENDIF
         IF(-PRINC(1).GE.S3GR1) THEN
            WRITE(3,*) ' SLOM DESNO',NLM,NC,MAT
            CALL WRR6(S,6,'S   ')
            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
            WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
            WRITE(3,*) ' S3H',S3H,S1H
            WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
            WRITE(*,*) ' SLOM DESNO',NLM,NC,PRINC(1),S3GR1
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
            GO TO 99
         ENDIF
C        TACKA LEVO OD HIDROSTATICKE OSE
         IF(-PRINC(1).LT.S3H) THEN
C            IF(DM2.GT.DM1) STOP '(DM2.GT.DM1)'
            IF(DM2.GT.DM1) THEN
               WRITE(3,*) ' DM2.GT.DM1',NLM,NC,MAT
               CALL WRR6(S,6,'S   ')
               WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
               WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
               WRITE(3,*) ' S3H',S3H,S1H
               WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
               WRITE(*,*) ' DM2.GT.DM1',NLM,NC,PRINC(1),S3GR2
            ENDIF
C            ER1=1.
C            ER2=DM2/DV2          
            ER1=10.
            if(dabs(DV2-DM2).lt.1.d-8)then
               er2=10.
               WRITE(3,*) ' nula imenilac',nlm,nc,princ(1),dv2,dm2
               WRITE(*,*) ' nula imenilac',NLM,NC,PRINC(1),dv2,dm2
            else               
               ER2=DV2/(DV2-DM2)
            endif
            GO TO 99
         ENDIF
C        TACKA DESNO OD HIDROSTATICKE OSE
         IF(-PRINC(1).GT.S3H) THEN
C            IF(DM2.LT.DM1) STOP '(DM2.LT.DM1)'
            IF(DM2.LT.DM1) THEN
               WRITE(3,*) ' DM2.LT.DM1',NLM,NC,MAT
               CALL WRR6(S,6,'S   ')
               WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
               WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
               WRITE(3,*) ' S3H',S3H,S1H
               WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
               WRITE(*,*) ' DM2.LT.DM1',NLM,NC,PRINC(1),S3GR1
            ENDIF
C            ER1=DM1/DV1
C            ER2=1.          
            ER1=DV1/(DV1-DM1)
            ER2=10.
            WRITE(3,*) ' desno hidrostacicko',nlm,nc,princ(1),s3h
            WRITE(*,*) ' desno hidrostaticko',NLM,NC,PRINC(1),S3h
            GO TO 99
         ENDIF
         IF(DABS(-PRINC(1)-S3H).LT.1.d-8) THEN
C            ER1=1.
C            ER2=1.          
            ER1=10.
            ER2=10.
            WRITE(3,*) ' hidrostaticko',nlm,nc,princ(1),s3h
            WRITE(*,*) ' hidrostaticko',NLM,NC,PRINC(1),S3h
            GO TO 99
         ENDIF
         STOP ' NE SME OVDE DA DODJE'
C
   99    DM=DM2
c         IF(DABS(DM2).GT.DABS(DM1)) THEN
c            DM=DM1
C            WRITE(*,*) ' DM2.GT.DM1',NLM,NC,DM2,DM1
C            STOP  
c         ENDIF
         ER=ER2
c         IF(DABS(ER2).GT.DABS(ER1)) THEN
c            ER=ER1
C            WRITE(*,*) ' ER2.GT.ER1',NLM,NC,ER2,ER1
C            STOP  
c         ENDIF
         IF(ER.GT.10.) ER=10.
      ELSE
C         DM=1.D10
C         DO I=1,KRIT(MAT)-1
C            A=S1S3(2,MAT,I)-S1S3(2,MAT,I+1)
C            B=S1S3(1,MAT,I+1)-S1S3(1,MAT,I)
C            C=S1S3(1,MAT,I)*S1S3(2,MAT,I+1)
C     1        -2.*S1S3(1,MAT,I)*S1S3(2,MAT,I)
C     1        +S1S3(1,MAT,I+1)*S1S3(2,MAT,I)
C            S1=-PRINC(3)
C            S3=-PRINC(1)
C            DUM=A*S3+B*S1+C
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A*A+B*B)
C            DMM=DUM/DUMQ
C            A1=-1.
C            B1=1.
C            C1=0.
C            DUM=A1*S3+B1*S1+C1
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A1*A1+B1*B1)
C            DMD=DUM/DUMQ
C            DMIN=DMM/(DMD+DMM)
C            IF(DMIN.LT.DM) THEN
C               DM=DMIN
C               ER=DMM 
C            ENDIF
C          ENDDO  
      ENDIF
C      WRITE(3,*) ' PRINC', (PRINC(I),I=1,3)
C      WRITE(3,*) ' SCMS', (SCMS(I,MAT),I=1,3)
C      WRITE(3,*) ' A,B,C', A,B,C
C      WRITE(3,*) ' S3GR1,S3GR2',S3GR1,S3GR2 
C      WRITE(3,*) ' S1GR1,S1GR2',S1GR1,S1GR2 
C      WRITE(3,*) ' DM1,DM2',DM1,DM2
C      WRITE(3,*) ' DV1,DV2',DV1,DV2
C      WRITE(3,*) ' ER1,ER2',ER1,ER2
      RETURN
      END
C=====================================================================
      SUBROUTINE TGRAU3(NEL,MCVEL,ICVEL,NMAT,IGRAF,MODEL)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C .......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT 3/D ELEMENTS DATA IN NEUTRAL GRAPHICS FILE
CS.   P R O G R A M
CS.       ZA STAMPANJE 3/D ELEMENATA U NEUTRALNI FILE
C .
C .......................................................................
C 
      COMMON /GLAVNI/ NP,NGELEM,NMATM,NPER,
     1                IOPGL(6),KOSI,NDIN,ITEST
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /SUMELE/ ISUMEL,ISUMGR
      COMMON /SRPSKI/ ISRPS
      COMMON /NIDEAS/ IDEAS
      COMMON /STAPRO/ THIDP(100),NPROPR(100)
      COMMON /PODTIP/ IPODT
      DIMENSION NEL(NE,*),MCVEL(*),NMAT(*),MODEL(4,*)
      DIMENSION FIZ(14)         
      COMMON /CDEBUG/ IDEBUG
C
      IF(IDEBUG.GT.0) PRINT *, ' TGRAU3'
      ISUMGR=ISUMGR+1
C
C     FIZICKE OSOBINE
C
      NULA=0
      ZERO=0.
      ONE=1.
      JEDAN=1
      INDPR=25
      INDPD=2
      I11=11
      I2=2
      I4=4
      I8=8
      I14=14
      I48=48
C
      NPROP=1
      DO IM=1,NE
         IF(NPROP.LT.NMAT(IM)) NPROP=NMAT(IM)
      ENDDO
      NPRP=1
      DO IM=1,100
         IF(NPRP.LT.NPROPR(IM)) NPRP=NPROPR(IM)
      ENDDO
      IF(NPRP.NE.NPROP) STOP 'NPRP.NE.NPROP'
      II=IGRAF
      IND=-1
      ITYP=402
      DO 20 I=1,NPROP
         IF(NPROPR(I).EQ.0) GO TO 20
         WRITE(II,5100) IND
         WRITE(II,5100) ITYP
         IFGD=25
         IF(NCVE.GT.8) IFGD=26
         IPRO=IFGD
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,I,IPRO,I,NULA
         WRITE(II,2001) I
         WRITE(II,5600) NULA,NULA,NULA,NULA
C 45
         WRITE(II,5600) NULA
C 93
         WRITE(II,5600) NULA
C
         WRITE(II,5100) IND
   20 CONTINUE
C
 5100 FORMAT(i5)
 5600 FORMAT(6(I4,','))
 2001 FORMAT(' PRO',I4)
C
C     E L E M E N T I
C
      NNCVE=NCVE
      IF(IPODT.NE.3) THEN
      IF(NCVE.LT.20) NCVE=8
      IF(NCVE.EQ.21) NCVE=20
      ENDIF
C     GRAFICKI OPIS ELEMENTA: SA 8 CVOROVA = 25, SA 20 CVOROVA = 26
      IFGD=25
      IF(NCVE.EQ.20) IFGD=26
      IF(IPODT.EQ.3) THEN
C     GRAFICKI OPIS ELEMENTA: SA 8 CVOROVA = 25, SA 20 CVOROVA = 26
      IFGD=25
      IF(NCVE.EQ.10) IFGD=26
C     VRSTA TETRA ELEMENTA: SA 4 CVOROVA = 6, SA 10 CVOROVA = 10
      IFDI=6
      IF(NCVE.EQ.10) IFDI=10
      ELSE      
C     GRAFICKI OPIS ELEMENTA: SA 8 CVOROVA = 25, SA 20 CVOROVA = 26
      IFGD=25
      IF(NCVE.EQ.20) IFGD=26
C     VRSTA 3/D ELEMENTA: SA 8 CVOROVA = 8, SA 20 CVOROVA = 12
      IFDI=8
      IF(NCVE.EQ.20) IFDI=12
      ENDIF
C     TABELA FIZICKIH OSOBINA
      IPTN=ISUMGR
C     BROJ CVOROVA NA ELEMENTU
      NNODS=NCVE
      IND=-1
      ITYP=404
      WRITE(IGRAF,1100) IND
      WRITE(IGRAF,1100) ITYP
      DO 10 I=1,NE
C        REDNI BROJ ELEMENTA
         IEL=I+ISUMEL
         IF(ICVEL.EQ.1) IEL=MCVEL(I)
C        TABELA MATERIJALA
         MPTN=NMAT(I)
C        BOJA  
         ICOL=124-(MPTN-1)*2
         WRITE(IGRAF,1000) IEL,ICOL,MPTN,IFGD,IFDI,MPTN,NULA,NULA
         IF(IPODT.EQ.3) THEN
         IF(NCVE.EQ.4) THEN
            WRITE(IGRAF,1001) NEL(I,1),NEL(I,2),NEL(I,3),NULA,NEL(I,4),
     +                        NULA,NULA,NULA,NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ELSE
CR          TETRA ELEMENTI: REDOSLED: 1 2 3 4 5 6 7 8 9 10
            WRITE(IGRAF,1001) NEL(I,1),NEL(I,2),NEL(I,3),NULA,NEL(I,4),
     +                        NULA,NULA,NULA,NEL(I,5),NEL(I,6)
            WRITE(IGRAF,1001) NEL(I,7),NULA,NEL(I,8),NEL(I,9),NEL(I,10)
     +                        ,NULA,NULA,NULA,NULA,NULA
         ENDIF
         ELSE
         IF(NCVE.EQ.8) THEN
            WRITE(IGRAF,1001) (NEL(I,J),J=5,8),(NEL(I,J),J=1,4),
     +                        NULA,NULA
            WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                        NULA,NULA
         ELSE
            WRITE(IGRAF,1001) (NEL(I,J),J=5,8),(NEL(I,J),J=1,4),
     +                        NEL(I,13),NEL(I,14)
            WRITE(IGRAF,1001) NEL(I,15),NEL(I,16),(NEL(I,J),J=17,20),
     +                        (NEL(I,J),J=9,12)
         ENDIF
         ENDIF
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1003) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
   10 CONTINUE
      WRITE(IGRAF,1100) IND
      ISUMEL=ISUMEL+NE
      NCVE=NNCVE
      RETURN
C
 1000 FORMAT(I10,',',7(I4,','))
 1001 FORMAT(10(I10,','))
 1011 FORMAT(10(I2,','))
 1002 FORMAT(3(F3.0,','))
 1003 FORMAT(16(I2,','))
 1100 FORMAT(i5)
 1200 FORMAT(6(1PE13.5,','))
      END
C======================================================================
      SUBROUTINE STAU31(SIGMA,AU,ISNA,MCVEL,ICVEL,DEFUK,IPLA)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /SRPSKI/ ISRPS
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /PODTIP/ IPODT
      COMMON /NIDEAS/ IDEAS
      DIMENSION ISNA(*),MCVEL(*),DEFUK(*)
      DIMENSION SIGMA(6,NGS12,NE,*),S(7),N(20)
      DIMENSION AU(*)
      REAL AU
C
C     KRITL=1 !RACUNA FAILURE INDEX
      KRITL=0
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C      IF(KOR.EQ.1) WRITE(II,5000) MJ
C      IF(KOR.EQ.1) WRITE(II,1001) M451
C
      IND=60010
      NND=70010
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   83 IND=60011
      NND=70011 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   84 IND=60012
      NND=70012 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   85 IND=60013
      NND=70013 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   86 IND=60014
      NND=70014 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   87 IND=60015
      NND=70015 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   88 IND=60031
      NND=70031 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   89 IND=60032
      NND=70032 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   90 IND=60033
      NND=70033 
      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(IND.EQ.60010) WRITE(II,60010) 
      IF(IND.EQ.60011) WRITE(II,60011) 
      IF(IND.EQ.60012) WRITE(II,60012) 
      IF(IND.EQ.60013) WRITE(II,60013) 
      IF(IND.EQ.60014) WRITE(II,60014) 
      IF(IND.EQ.60015) WRITE(II,60015) 
      IF(IND.EQ.60031) WRITE(II,60031) 
      IF(IND.EQ.60032) WRITE(II,60032) 
      IF(IND.EQ.60033) WRITE(II,60033)
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(IPODT.EQ.3)THEN
      IF(NCVE.EQ.4)THEN
      WRITE(II,1000) N(1),N(2),N(3),NULA,N(4),NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) 
     +      NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      ENDIF
      IF(NCVE.EQ.10)THEN
      WRITE(II,1000) N(1),N(2),N(3),NULA,N(4),NULA,NULA,NULA,N(5),N(6)
      WRITE(II,1000) 
     +      N(7),NULA,N(8),N(9),N(10),NULA,NULA,NULA,NULA,NULA
      ENDIF
      ELSE
      WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
      WRITE(II,1000) 
     +      N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      ENDIF
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,JEDAN
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         CALL SREDK3(SIGMA,S,NLM,NGS12,NE)
         IF(IPLA.EQ.0) THEN
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60014) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60015) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(7)
            IF(IND.EQ.60032) THEN
            KOSKA=0
            IF (KOSKA.EQ.1) THEN
c            IF(NMM.LE.43405) THEN
            IF(NMM.LE.15044) THEN
            S1T=92.
            S2T=133.
            S3T=92.
            S1C=92.
            S2C=133.
            S3C=92.
            S12=79.5
            S23=79.5
            S31=53.
c            ELSEIF(NMM.GE.49935)THEN
            ELSEIF(NMM.GE.40669)THEN
            S1T=170.
            S2T=170.
            S3T=170.
            S1C=170.
            S2C=170.
            S3C=170.
            S12=170.
            S23=170.
            S31=170.
            ELSE
            S1T=92.
            S2T=133.
            S3T=92.
            S1C=92.
            S2C=133.
            S3C=92.
            S12=79.5
            S23=79.5
            S31=53.
c            S1T=6.
c            S2T=6.
c            S3T=6.
c            S1C=6.
c            S2C=6.
c            S3C=6.
c            S12=6.
c            S23=6.
c            S31=6.
            ENDIF
            FS=S(1)*S(1)/S1T/S1C+S(2)*S(2)/S2T/S2C+S(3)*S(3)/S3T/S3C+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31+
     1   S(1)*(1./S1T-1./S1C)+S(2)*(1./S2T-1./S2C)+S(3)*(1./S3T-1./S3C)-
     1         S(1)*S(2)/DSQRT(S1T*S1C*S2T*S2C)-
     1         S(2)*S(3)/DSQRT(S2T*S2C*S3T*S3C)-
     1         S(3)*S(1)/DSQRT(S3T*S3C*S1T*S1C)
            WRITE(II,5000) NMM,FS
            ENDIF
            ENDIF
            IF(IND.EQ.60033) THEN
            KOSKA=0
            IF(KOSKA.EQ.1) THEN
c            IF(NMM.LE.43405) THEN
            IF(NMM.LE.15044) THEN
            S1T=92.
            S2T=133.
            S3T=92.
            S1C=92.
            S2C=133.
            S3C=92.
            S12=79.5
            S23=79.5
            S31=53.
c            ELSEIF(NMM.GE.49935)THEN
            ELSEIF(NMM.GE.40669)THEN
            S1T=170.
            S2T=170.
            S3T=170.
            S1C=170.
            S2C=170.
            S3C=170.
            S12=170.
            S23=170.
            S31=170.
            ELSE
            S1T=92.
            S2T=133.
            S3T=92.
            S1C=92.
            S2C=133.
            S3C=92.
            S12=79.5
            S23=79.5
            S31=53.
c            S1T=6.
c            S2T=6.
c            S3T=6.
c            S1C=6.
c            S2C=6.
c            S3C=6.
c            S12=6.
c            S23=6.
c            S31=6.
            ENDIF
            IF (S(1).LE.0) THEN
            S1=S1C
            ELSE 
            S1=S1T
            ENDIF
            IF (S(2).LE.0) THEN 
            S2=S2C
            ELSE 
            S2=S2T
            ENDIF
            IF (S(3).LE.0) THEN 
            S3=S3C
            ELSE 
            S3=S3T
            ENDIF
            IF (S(1)*S(2).GE.0) THEN 
            S4=S1T
            ELSE 
            S4=S1C
            ENDIF
            IF (S(2)*S(3).GE.0) THEN 
            S5=S2T
            ELSE 
            S5=S2C
            ENDIF
            IF (S(3)*S(1).GE.0) THEN 
            S6=S3T
            ELSE 
            S6=S3C
            ENDIF
            FS=S(1)*S(1)/S1/S1+S(2)*S(2)/S2/S2+S(3)*S(3)/S3/S3+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31-
     1         S(1)*S(2)/S4/S4-
     1         S(2)*S(3)/S5/S5-
     1         S(3)*S(1)/S6/S6
            WRITE(II,5000) NMM,FS
            ENDIF
            ENDIF
         ELSE
         ENDIF
c         call wrr6(s,6,'napo')
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
C
      IF(ISTNA.GT.0) GO TO 31
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
c
C      DO 30 NC=1,NCVE
C     ISKLJUCENA STAMPA U MEDJUCVOROVIMA
      NCVE4=NCVE
      IF(IPOD.EQ.3.AND.NCVE.EQ.10) NCVE4=4
      IF(IPOD.NE.3.AND.NCVE.EQ.20) NCVE4=8
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(IND.EQ.60010) WRITE(II,70010) NC 
      IF(IND.EQ.60011) WRITE(II,70011) NC 
      IF(IND.EQ.60012) WRITE(II,70012) NC 
      IF(IND.EQ.60013) WRITE(II,70013) NC 
      IF(IND.EQ.60014) WRITE(II,70014) NC 
      IF(IND.EQ.60015) WRITE(II,70015) NC 
      IF(IND.EQ.60031) WRITE(II,70031) NC 
      IF(IND.EQ.60032) WRITE(II,70032) NC 
      IF(IND.EQ.60033) WRITE(II,70033) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(IPODT.EQ.3) THEN
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.1) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=1
         IF(NC.EQ.5) IJ=1
         IF(NC.EQ.6) IJ=1
         IF(NC.EQ.7) IJ=1
         IF(NC.EQ.8) IJ=1
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.4) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=3
         IF(NC.EQ.4) IJ=4
         IF(NC.EQ.5) THEN
            IJ=-1
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-2
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-1
            JI= 3
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-1
            JI= 4
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-3
            JI= 4
         ENDIF
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.5) THEN
         IF(NC.EQ.1) IJ=2
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=4
         IF(NC.EQ.4) IJ=5
         IF(NC.EQ.5) THEN
            IJ=-3
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-4
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-2
            JI= 5
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-3
            JI= 5
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-5
            JI= 4
         ENDIF
      ENDIF
      ELSE
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
         IF(NC.EQ.9) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSZ+1
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-(NGAUSZ+1)
            JI=1
         ENDIF
         IF(NC.EQ.11) THEN
            IJ=-1
            JI=NGAUSY*NGAUSZ+1
         ENDIF
         IF(NC.EQ.12) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+1
         ENDIF
         IF(NC.EQ.13) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
         IF(NC.EQ.14) THEN
            IJ=-(NGAUSZ+1)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.15) THEN
            IJ=-1
            JI=2
         ENDIF
         IF(NC.EQ.16) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.17) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+2)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.18) THEN
            IJ=-(NGAUSZ+2)
            JI=2
         ENDIF
         IF(NC.EQ.19) THEN
            IJ=-2
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.20) THEN
            IJ=-(NGAUSY*NGAUSZ+2)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
         IF(NC.EQ.9) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.10) IJ=NGAUSZ+1
         IF(NC.EQ.11) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.12) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.13) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+2
         IF(NC.EQ.14) IJ=2*NGAUSZ+2
         IF(NC.EQ.15) IJ=2
         IF(NC.EQ.16) IJ=2*NGAUSY*NGAUSZ+2
         IF(NC.EQ.17) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.18) IJ=NGAUSZ+3
         IF(NC.EQ.19) IJ=NGAUSY*NGAUSZ+3
         IF(NC.EQ.20) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+3
      ENDIF
      ENDIF
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(IND.EQ.60010.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
            ELSEIF(IND.EQ.60010.AND.IJ.LT.0) THEN
               POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60011.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
            ELSEIF(IND.EQ.60011.AND.IJ.LT.0) THEN
               POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60012.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
            ELSEIF(IND.EQ.60012.AND.IJ.LT.0) THEN
               POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60013.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
            ELSEIF(IND.EQ.60013.AND.IJ.LT.0) THEN
               POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60014.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(5,IJ,NLM,1)
            ELSEIF(IND.EQ.60014.AND.IJ.LT.0) THEN
               POLA=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60015.AND.IJ.GT.0) THEN
               WRITE(II,5000) NMM,SIGMA(6,IJ,NLM,1)
            ELSEIF(IND.EQ.60015.AND.IJ.LT.0) THEN
               POLA=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
               WRITE(II,5000) NMM,POLA
            ENDIF
            IF(IND.EQ.60031.AND.IJ.GT.0) THEN
               XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
               YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(3,IJ,NLM,1)
               ZMX=SIGMA(3,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
               EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(4,IJ,NLM,1)*SIGMA(4,IJ,NLM,1)+
     1                    SIGMA(5,IJ,NLM,1)*SIGMA(5,IJ,NLM,1)+
     1                    SIGMA(6,IJ,NLM,1)*SIGMA(6,IJ,NLM,1))
               IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
               WRITE(II,5000) NMM,EFEK
            ELSEIF(IND.EQ.60031.AND.IJ.LT.0) THEN
               XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
               YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(3,-IJ,NLM,1)
               ZMX=SIGMA(3,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
               EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(4,-IJ,NLM,1)*SIGMA(4,-IJ,NLM,1)+
     1                    SIGMA(5,-IJ,NLM,1)*SIGMA(5,-IJ,NLM,1)+
     1                    SIGMA(6,-IJ,NLM,1)*SIGMA(6,-IJ,NLM,1))
               IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
               XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
               YMZ=SIGMA(2,JI,NLM,1)-SIGMA(3,JI,NLM,1)
               ZMX=SIGMA(3,JI,NLM,1)-SIGMA(1,JI,NLM,1)
               EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1              3.D0*(SIGMA(4,JI,NLM,1)*SIGMA(4,JI,NLM,1)+
     1                    SIGMA(5,JI,NLM,1)*SIGMA(5,JI,NLM,1)+
     1                    SIGMA(6,JI,NLM,1)*SIGMA(6,JI,NLM,1))
               IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
               EFEK=(EFEK+EFE1)/2
               WRITE(II,5000) NMM,EFEK
            ENDIF
            IF(IND.EQ.60032.AND.IJ.GT.0) THEN
            CALL JEDNA1(S,SIGMA(1,IJ,NLM,1),6)
            FS=S(1)*S(1)/S1T/S1C+S(2)*S(2)/S2T/S2C+S(3)*S(3)/S3T/S3C+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31+
     1   S(1)*(1./S1T-1./S1C)+S(2)*(1./S2T-1./S2C)+S(3)*(1./S3T-1./S3C)-
     1         S(1)*S(2)/DSQRT(S1T*S1C*S2T*S2C)-
     1         S(2)*S(3)/DSQRT(S2T*S2C*S3T*S3C)-
     1         S(3)*S(1)/DSQRT(S3T*S3C*S1T*S1C)
               WRITE(II,5000) NMM,FS
            ELSEIF(IND.EQ.60032.AND.IJ.LT.0) THEN
            S(1)=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
            S(2)=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
            S(3)=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
            S(4)=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
            S(5)=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
            S(6)=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
            FS=S(1)*S(1)/S1T/S1C+S(2)*S(2)/S2T/S2C+S(3)*S(3)/S3T/S3C+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31+
     1   S(1)*(1./S1T-1./S1C)+S(2)*(1./S2T-1./S2C)+S(3)*(1./S3T-1./S3C)-
     1         S(1)*S(2)/DSQRT(S1T*S1C*S2T*S2C)-
     1         S(2)*S(3)/DSQRT(S2T*S2C*S3T*S3C)-
     1         S(3)*S(1)/DSQRT(S3T*S3C*S1T*S1C)
               WRITE(II,5000) NMM,FS
            ENDIF
            IF(IND.EQ.60033.AND.IJ.GT.0) THEN
            CALL JEDNA1(S,SIGMA(1,IJ,NLM,1),6)
            IF (S(1).LE.0) THEN
            S1=S1C
            ELSE 
            S1=S1T
            ENDIF
            IF (S(2).LE.0) THEN 
            S2=S2C
            ELSE 
            S2=S2T
            ENDIF
            IF (S(3).LE.0) THEN 
            S3=S3C
            ELSE 
            S3=S3T
            ENDIF
            IF (S(1)*S(2).GE.0) THEN 
            S4=S1T
            ELSE 
            S4=S1C
            ENDIF
            IF (S(2)*S(3).GE.0) THEN 
            S5=S2T
            ELSE 
            S5=S2C
            ENDIF
            IF (S(3)*S(1).GE.0) THEN 
            S6=S3T
            ELSE 
            S6=S3C
            ENDIF
            FS=S(1)*S(1)/S1/S1+S(2)*S(2)/S2/S2+S(3)*S(3)/S3/S3+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31-
     1         S(1)*S(2)/S4/S4-
     1         S(2)*S(3)/S5/S5-
     1         S(3)*S(1)/S6/S6
               WRITE(II,5000) NMM,FS
            ELSEIF(IND.EQ.60033.AND.IJ.LT.0) THEN
            S(1)=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
            S(2)=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
            S(3)=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
            S(4)=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
            S(5)=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
            S(6)=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
            IF (S(1).LE.0) THEN
            S1=S1C
            ELSE 
            S1=S1T
            ENDIF
            IF (S(2).LE.0) THEN 
            S2=S2C
            ELSE 
            S2=S2T
            ENDIF
            IF (S(3).LE.0) THEN 
            S3=S3C
            ELSE 
            S3=S3T
            ENDIF
            IF (S(1)*S(2).GE.0) THEN 
            S4=S1T
            ELSE 
            S4=S1C
            ENDIF
            IF (S(2)*S(3).GE.0) THEN 
            S5=S2T
            ELSE 
            S5=S2C
            ENDIF
            IF (S(3)*S(1).GE.0) THEN 
            S6=S3T
            ELSE 
            S6=S3C
            ENDIF
            FS=S(1)*S(1)/S1/S1+S(2)*S(2)/S2/S2+S(3)*S(3)/S3/S3+
     1         S(4)*S(4)/S12/S12+S(5)*S(5)/S23/S23+S(6)*S(6)/S31/S31-
     1         S(1)*S(2)/S4/S4-
     1         S(2)*S(3)/S5/S5-
     1         S(3)*S(1)/S6/S6
               WRITE(II,5000) NMM,FS
            ENDIF
         ELSE
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
   31 CONTINUE
   
      IF(IND.EQ.60010) GO TO 83
      IF(IND.EQ.60011) GO TO 84
      IF(IND.EQ.60012) GO TO 85
      IF(IND.EQ.60013) GO TO 86
      IF(IND.EQ.60014) GO TO 87
      IF(IND.EQ.60015) GO TO 88
      IF(KRITL.GT.0) THEN
      IF(IND.EQ.60031) GO TO 89
      IF(IND.EQ.60032) GO TO 90
      ENDIF
C      IF(KOR.EQ.NDT) WRITE(II,5000) MJ
      RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60014 FORMAT('SOLID YZ SHEAR STRESS')
70014 FORMAT('SOLID NODE',I10,' YZ SHEAR STRESS')
60015 FORMAT('SOLID ZX SHEAR STRESS')
70015 FORMAT('SOLID NODE',I10,' ZX SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
60032 FORMAT('SOLID Tsai-Wu')
70032 FORMAT('SOLID NODE',I10,' Tsai-Wu')
60033 FORMAT('SOLID Tsai-Hill')
70033 FORMAT('SOLID NODE',I10,' Tsai-Hill')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE NAPUN3(N,NCVE,NND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION N(*)
C
      CALL ICLEAR(N,20)
      IDEL=200
      NND=NND-IDEL
      DO 10 I=1,NCVE
         N(I)=NND+I*IDEL
   10 CONTINUE
      RETURN
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE SREDK3(SIGMA,S,NLM,NGS12,NE)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION SIGMA(6,NGS12,NE,*),S(7)
C
      CALL CLEAR(S,7)
      DO 10 I=1,NGS12
         S(1)=S(1)+SIGMA(1,I,NLM,1)
         S(2)=S(2)+SIGMA(2,I,NLM,1)
         S(3)=S(3)+SIGMA(3,I,NLM,1)
         S(4)=S(4)+SIGMA(4,I,NLM,1)
         S(5)=S(5)+SIGMA(5,I,NLM,1)
         S(6)=S(6)+SIGMA(6,I,NLM,1)
   10 CONTINUE
      S(1)=S(1)/NGS12
      S(2)=S(2)/NGS12
      S(3)=S(3)/NGS12
      S(4)=S(4)/NGS12
      S(5)=S(5)/NGS12
      S(6)=S(6)/NGS12
      XMY=S(1)-S(2)
      YMZ=S(2)-S(3)
      ZMX=S(3)-S(1)
      EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1     3.D0*(S(4)*S(4)+S(5)*S(5)+S(6)*S(6))
      IF(EFEK.GT.1.D-19) S(7)=DSQRT(EFEK)
      RETURN
      END
C======================================================================
      SUBROUTINE STAU35(SIGMA,ISNA,MCVEL,ICVEL,PLAST,AU,IPLA,NMAT)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NIDEAS/ IDEAS
      COMMON /SRPSKI/ ISRPS
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      COMMON /PODTIP/ IPODT
      DIMENSION AU(*)
      REAL AU
      DIMENSION ISNA(*),MCVEL(*),PLAST(*),NMAT(*)
      DIMENSION SIGMA(6,NGS12,NE,*),S(7),N(20)
C
      NNCVE=NCVE
      IF(IPODT.NE.3) THEN
      IF(NCVE.LT.20) NCVE=8
      IF(NCVE.EQ.21) NCVE=20
      ENDIF
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C
      NPROS=MODPRO(NMODM)
      NGXYZ=NGS12*NPROS
C
      IND=60010
      NND=70010
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=1
      GO TO 10
   83 IND=60011
      NND=70011 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=2
      GO TO 10
   84 IND=60012
      NND=70012 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=3
      GO TO 10
   85 IND=60013
      NND=70013 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=4
      GO TO 10
   86 IND=60014
      NND=70014 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=5
      GO TO 10
   87 IND=60015
      NND=70015 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=6
      GO TO 10
   88 IND=60031
      NND=70031 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=7
      GO TO 10
C
  182 IND=60050
      NND=70050
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  183 IND=60051
      NND=70051 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  184 IND=60052
      NND=70052 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  185 IND=60053
      NND=70053 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  186 IND=60054
      NND=70054 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  187 IND=60055
      NND=70055 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  188 IND=60061
      NND=70061 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=-7
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  282 IND=60066
      NND=70066
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  283 IND=60067
      NND=70067 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  284 IND=60068
      NND=70068 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  285 IND=60069
      NND=70069 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  286 IND=60070
      NND=70070 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  287 IND=60071
      NND=70071 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  288 IND=60072
      NND=70072 
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=-7
C     IF(ISTDE.EQ.-1) GO TO 31
c      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  382 IND=60091
      NND=70091
      CALL NAPUN3(N,NCVE,NND)
      KK=19
      INP=1
      IF(NMODM.NE.9) GO TO 31
      GO TO 10
  383 IND=60092
      NND=70092
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      IF(SCMS(3,1).LT.1.D-10.AND.KRIT(1).EQ.0) GO TO 31
      GO TO 10
  384 IND=60093
      NND=70093
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      IF(SCMS(3,1).LT.1.D-10.AND.KRIT(1).EQ.0) GO TO 31
      GO TO 10
  385 IND=60094
      NND=70094
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      GO TO 10
  386 IND=60095
      NND=70095
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=0
      IF(NMODM.NE.9) GO TO 31
      GO TO 10
C
  387 IND=67091
      NND=77091
      CALL NAPUN3(N,NCVE,NND)
      KK=13
      INP=1
      IF(NMODM.NE.61) GO TO 31
      GO TO 10
C
  388 IND=60081
      NND=70081
      CALL NAPUN3(N,NCVE,NND)
      IF(NMODM.EQ.27) KK=43
      IF(NMODM.EQ.43.OR.NMODM.EQ.44) KK=20
      INP=1
      IF(NMODM.NE.27.AND.NMODM.NE.43.AND.NMODM.NE.44) GO TO 31
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,60010) 
         IF(IND.EQ.60011) WRITE(II,60011) 
         IF(IND.EQ.60012) WRITE(II,60012) 
         IF(IND.EQ.60013) WRITE(II,60013) 
         IF(IND.EQ.60014) WRITE(II,60014) 
         IF(IND.EQ.60015) WRITE(II,60015) 
         IF(IND.EQ.60031) WRITE(II,60031) 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,60050) 
         IF(IND.EQ.60051) WRITE(II,60051) 
         IF(IND.EQ.60052) WRITE(II,60052) 
         IF(IND.EQ.60053) WRITE(II,60053) 
         IF(IND.EQ.60054) WRITE(II,60054) 
         IF(IND.EQ.60055) WRITE(II,60055) 
         IF(IND.EQ.60061) WRITE(II,60061) 
      ENDIF   
      IF(KK.EQ.13.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,60066) 
         IF(IND.EQ.60067) WRITE(II,60067) 
         IF(IND.EQ.60068) WRITE(II,60068) 
         IF(IND.EQ.60069) WRITE(II,60069) 
         IF(IND.EQ.60070) WRITE(II,60070) 
         IF(IND.EQ.60071) WRITE(II,60071) 
         IF(IND.EQ.60072) WRITE(II,60072) 
      ENDIF   
      IF(IND.EQ.60091) WRITE(II,60091) 
      IF(IND.EQ.60092) WRITE(II,60092) 
      IF(IND.EQ.60093) WRITE(II,60093) 
      IF(IND.EQ.60094) WRITE(II,60094) 
      IF(IND.EQ.60095) WRITE(II,60095) 
      IF(IND.EQ.67091) WRITE(II,67091) 
      IF(IND.EQ.60081) WRITE(II,60081) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(ISTNA.EQ.0) THEN
       WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
       WRITE(II,1000) 
     +       N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      ELSE
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      ENDIF
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      IF(ISTNA.EQ.0) THEN
         WRITE(II,1000) NULA,NULA,JEDAN
      ELSE
         WRITE(II,1000) JEDAN,NULA,JEDAN
      ENDIF
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         MAT=NMAT(NLM)
         IF(IPLA.EQ.0) THEN
            CALL SREDK3(SIGMA,S,NLM,NGS12,NE)
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            if(kk.eq.43) then
             s(1)=PLAST(LL)
            else
             IF(INP.NE.0) CALL SREDK5(PLAST(LL),S,NPROS,NGS12,INP)
             IF(INP.EQ.0) CALL SREDNP(PLAST(LL),S,NPROS,NGS12,DM,ER,MAT,
     1                                NLM,0,SJ2,SMT)
            endif
         ENDIF
         IF(KK.EQ.1.AND.INP.NE.0) THEN
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60014) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60015) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.7.AND.INP.NE.0) THEN
            IF(IND.EQ.60050) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60051) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60052) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60053) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60054) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60055) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60061) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.13.AND.INP.NE.0) THEN
            IF(IND.EQ.60066) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60067) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60068) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60069) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60070) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60071) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60072) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(IND.EQ.60091) WRITE(II,5000) NMM,S(1)
         IF(IND.EQ.60092) WRITE(II,5000) NMM,DM
         IF(IND.EQ.60093) WRITE(II,5000) NMM,ER
         IF(IND.EQ.60094) WRITE(II,5000) NMM,SJ2
         IF(IND.EQ.60095) WRITE(II,5000) NMM,SMT
         IF(IND.EQ.67091) WRITE(II,5000) NMM,S(1)
         IF(IND.EQ.60081) WRITE(II,5000) NMM,S(1)
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
c
      IF(ISTNA.GT.0) GO TO 31
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
C
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,70010) NC 
         IF(IND.EQ.60011) WRITE(II,70011) NC 
         IF(IND.EQ.60012) WRITE(II,70012) NC 
         IF(IND.EQ.60013) WRITE(II,70013) NC 
         IF(IND.EQ.60014) WRITE(II,70014) NC 
         IF(IND.EQ.60015) WRITE(II,70015) NC 
         IF(IND.EQ.60031) WRITE(II,70031) NC 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,70050) NC 
         IF(IND.EQ.60051) WRITE(II,70051) NC 
         IF(IND.EQ.60052) WRITE(II,70052) NC 
         IF(IND.EQ.60053) WRITE(II,70053) NC 
         IF(IND.EQ.60054) WRITE(II,70054) NC 
         IF(IND.EQ.60055) WRITE(II,70055) NC 
         IF(IND.EQ.60061) WRITE(II,70061) NC 
      ENDIF   
      IF(KK.EQ.13.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,70066) NC 
         IF(IND.EQ.60067) WRITE(II,70067) NC 
         IF(IND.EQ.60068) WRITE(II,70068) NC 
         IF(IND.EQ.60069) WRITE(II,70069) NC 
         IF(IND.EQ.60070) WRITE(II,70070) NC 
         IF(IND.EQ.60071) WRITE(II,70071) NC 
         IF(IND.EQ.60072) WRITE(II,70072) NC 
      ENDIF   
      IF(IND.EQ.60091) WRITE(II,70091) NC 
      IF(IND.EQ.60092) WRITE(II,70092) NC 
      IF(IND.EQ.60093) WRITE(II,70093) NC 
      IF(IND.EQ.60094) WRITE(II,70094) NC 
      IF(IND.EQ.60095) WRITE(II,70095) NC 
      IF(IND.EQ.67091) WRITE(II,77091) NC 
      IF(IND.EQ.60081) WRITE(II,70081) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
         IF(NC.EQ.9) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSZ+1
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-(NGAUSZ+1)
            JI=1
         ENDIF
         IF(NC.EQ.11) THEN
            IJ=-1
            JI=NGAUSY*NGAUSZ+1
         ENDIF
         IF(NC.EQ.12) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+1
         ENDIF
         IF(NC.EQ.13) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
         IF(NC.EQ.14) THEN
            IJ=-(NGAUSZ+1)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.15) THEN
            IJ=-1
            JI=2
         ENDIF
         IF(NC.EQ.16) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.17) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+2)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.18) THEN
            IJ=-(NGAUSZ+2)
            JI=2
         ENDIF
         IF(NC.EQ.19) THEN
            IJ=-2
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.20) THEN
            IJ=-(NGAUSY*NGAUSZ+2)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
         IF(NC.EQ.9) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.10) IJ=NGAUSZ+1
         IF(NC.EQ.11) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.12) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.13) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+2
         IF(NC.EQ.14) IJ=2*NGAUSZ+2
         IF(NC.EQ.15) IJ=2
         IF(NC.EQ.16) IJ=2*NGAUSY*NGAUSZ+2
         IF(NC.EQ.17) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.18) IJ=NGAUSZ+3
         IF(NC.EQ.19) IJ=NGAUSY*NGAUSZ+3
         IF(NC.EQ.20) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+3
      ENDIF
      IF(IPODT.EQ.3) THEN
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.1) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=1
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.4) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=3
         IF(NC.EQ.4) IJ=4
         IF(NC.EQ.5) THEN
            IJ=-1
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-2
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-1
            JI= 3
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-1
            JI= 4
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-3
            JI= 4
         ENDIF
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.5) THEN
         IF(NC.EQ.1) IJ=2
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=4
         IF(NC.EQ.4) IJ=5
         IF(NC.EQ.5) THEN
            IJ=-3
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-4
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-2
            JI= 5
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-3
            JI= 5
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-5
            JI= 4
         ENDIF
      ENDIF
      ENDIF
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(KK.EQ.1) THEN
               IF(IND.EQ.60010.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
               ELSEIF(IND.EQ.60010.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60011.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
               ELSEIF(IND.EQ.60011.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60012.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
               ELSEIF(IND.EQ.60012.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60013.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
               ELSEIF(IND.EQ.60013.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60014.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(5,IJ,NLM,1)
               ELSEIF(IND.EQ.60014.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60015.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(6,IJ,NLM,1)
               ELSEIF(IND.EQ.60015.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60031.AND.IJ.GT.0) THEN
                  XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
                  YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(3,IJ,NLM,1)
                  ZMX=SIGMA(3,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,IJ,NLM,1)*SIGMA(4,IJ,NLM,1)+
     1                       SIGMA(5,IJ,NLM,1)*SIGMA(5,IJ,NLM,1)+
     1                       SIGMA(6,IJ,NLM,1)*SIGMA(6,IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSEIF(IND.EQ.60031.AND.IJ.LT.0) THEN
                  XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
                  YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(3,-IJ,NLM,1)
                  ZMX=SIGMA(3,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,-IJ,NLM,1)*SIGMA(4,-IJ,NLM,1)+
     1                       SIGMA(5,-IJ,NLM,1)*SIGMA(5,-IJ,NLM,1)+
     1                       SIGMA(6,-IJ,NLM,1)*SIGMA(6,-IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
                  YMZ=SIGMA(2,JI,NLM,1)-SIGMA(3,JI,NLM,1)
                  ZMX=SIGMA(3,JI,NLM,1)-SIGMA(1,JI,NLM,1)
                  EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,JI,NLM,1)*SIGMA(4,JI,NLM,1)+
     1                       SIGMA(5,JI,NLM,1)*SIGMA(5,JI,NLM,1)+
     1                       SIGMA(6,JI,NLM,1)*SIGMA(6,JI,NLM,1))
                  IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                  EFEK=(EFEK+EFE1)/2
                  WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF   
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(IND.EQ.60010.OR.IND.EQ.60050.OR.IND.EQ.60066.OR.
     1         IND.EQ.60091) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(LL+(-IJ-1)*NPROS)+PLAST(LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60011.OR.IND.EQ.60051.OR.IND.EQ.60067) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(1+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(1+LL+(-IJ-1)*NPROS)+PLAST(1+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60012.OR.IND.EQ.60052.OR.IND.EQ.60068) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(2+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(2+LL+(-IJ-1)*NPROS)+PLAST(2+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60013.OR.IND.EQ.60053.OR.IND.EQ.60069) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(3+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(3+LL+(-IJ-1)*NPROS)+PLAST(3+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60014.OR.IND.EQ.60054.OR.IND.EQ.60070) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(4+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(4+LL+(-IJ-1)*NPROS)+PLAST(4+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60015.OR.IND.EQ.60055.OR.IND.EQ.60071) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(5+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(5+LL+(-IJ-1)*NPROS)+PLAST(5+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60031.OR.IND.EQ.60061.OR.IND.EQ.60072) THEN
               IF(IJ.GT.0) THEN
                  XMY=PLAST(  LL+(IJ-1)*NPROS)-PLAST(1+LL+(IJ-1)*NPROS)
                  YMZ=PLAST(1+LL+(IJ-1)*NPROS)-PLAST(2+LL+(IJ-1)*NPROS)
                  ZMX=PLAST(2+LL+(IJ-1)*NPROS)-PLAST(  LL+(IJ-1)*NPROS)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(IJ-1)*NPROS)*PLAST(3+LL+(IJ-1)*NPROS)+
     1                PLAST(4+LL+(IJ-1)*NPROS)*PLAST(4+LL+(IJ-1)*NPROS)+
     1                PLAST(5+LL+(IJ-1)*NPROS)*PLAST(5+LL+(IJ-1)*NPROS))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSE
                 XMY=PLAST(  LL+(-IJ-1)*NPROS)-PLAST(1+LL+(-IJ-1)*NPROS)
                 YMZ=PLAST(1+LL+(-IJ-1)*NPROS)-PLAST(2+LL+(-IJ-1)*NPROS)
                 ZMX=PLAST(2+LL+(-IJ-1)*NPROS)-PLAST(  LL+(-IJ-1)*NPROS)
                 EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1        3.D0*(PLAST(3+LL+(-IJ-1)*NPROS)*PLAST(3+LL+(-IJ-1)*NPROS)+
     1              PLAST(4+LL+(-IJ-1)*NPROS)*PLAST(4+LL+(-IJ-1)*NPROS)+
     1              PLAST(5+LL+(-IJ-1)*NPROS)*PLAST(5+LL+(-IJ-1)*NPROS))
                   IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                   XMY=PLAST(  LL+(JI-1)*NPROS)-PLAST(1+LL+(JI-1)*NPROS)
                   YMZ=PLAST(1+LL+(JI-1)*NPROS)-PLAST(2+LL+(JI-1)*NPROS)
                   ZMX=PLAST(2+LL+(JI-1)*NPROS)-PLAST(  LL+(JI-1)*NPROS)
                   EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(JI-1)*NPROS)*PLAST(3+LL+(JI-1)*NPROS)+
     1                PLAST(4+LL+(JI-1)*NPROS)*PLAST(4+LL+(JI-1)*NPROS)+
     1                PLAST(5+LL+(JI-1)*NPROS)*PLAST(5+LL+(JI-1)*NPROS))
                   IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                   EFEK=(EFEK+EFE1)/2
                   WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF
C
            IF(IND.EQ.60092) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC,SJ2,SMT)
                  WRITE(II,5000) NMM,DM
               ELSE
            CALL SREDNP(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC,SJ21,SMT1)
            CALL SREDNP(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC,SJ22,SMT2)
                  POLA=(D1+D2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60093) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC,SJ2,SMT)
                  WRITE(II,5000) NMM,ER
               ELSE
            CALL SREDNP(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC,SJ21,SMT1)
            CALL SREDNP(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC,SJ22,SMT2)
                  POLA=(E1+E2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60094) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC,SJ2,SMT)
                  WRITE(II,5000) NMM,SJ2
               ELSE
            CALL SREDNP(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC,SJ21,SMT1)
            CALL SREDNP(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC,SJ22,SMT2)
                  POLA=(SJ21+SJ22)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60095) THEN
               IF(IJ.GT.0) THEN
            CALL SREDNP(PLAST(LL+(IJ-1)*NPROS),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,NC,SJ2,SMT)
                  WRITE(II,5000) NMM,SMT
               ELSE
            CALL SREDNP(PLAST(LL+(-IJ-1)*NPROS),S,NPROS,NGS12,D1,E1,MAT,
     1                               NLM,NC,SJ21,SMT1)
            CALL SREDNP(PLAST(LL+(JI-1)*NPROS),S,NPROS,NGS12,D2,E2,MAT,
     1                               NLM,NC,SJ22,SMT2)
                  POLA=(SMT1+SMT2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60081) THEN
               IF(IJ.GT.0) THEN
                  S(1)=PLAST(LL+(IJ-1)*NPROS)
                  WRITE(II,5000) NMM,S(1)
               ELSE
                  S1=PLAST(LL+(-IJ-1)*NPROS)
                  S2=PLAST(LL+(JI-1)*NPROS)
                  POLA=(S1+S2)/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
C
   31 CONTINUE
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) GO TO  83
         IF(IND.EQ.60011) GO TO  84
         IF(IND.EQ.60012) GO TO  85
         IF(IND.EQ.60013) GO TO  86
         IF(IND.EQ.60014) GO TO  87
         IF(IND.EQ.60015) GO TO  88
         IF(IND.EQ.60031) GO TO 182
      ENDIF
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) GO TO 183
         IF(IND.EQ.60051) GO TO 184
         IF(IND.EQ.60052) GO TO 185
         IF(IND.EQ.60053) GO TO 186
         IF(IND.EQ.60054) GO TO 187
         IF(IND.EQ.60055) GO TO 188
         IF(IND.EQ.60061)THEN
            IF(NMODM.EQ.61)GO TO 387
            IF(NMODM.EQ.28)GO TO 999
            GO TO 282
         ENDIF
      ENDIF
C      IF(IND.EQ.67091) GO TO 999
      IF(KK.EQ.13.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) GO TO 283
         IF(IND.EQ.60067) GO TO 284
         IF(IND.EQ.60068) GO TO 285
         IF(IND.EQ.60069) GO TO 286
         IF(IND.EQ.60070) GO TO 287
         IF(IND.EQ.60071) GO TO 288
         IF(IND.EQ.60072) GO TO 382
      ENDIF
      IF(IND.EQ.60091) GO TO 383
      IF(IND.EQ.60092) GO TO 384
      IF(IND.EQ.60093) GO TO 385
      IF(IND.EQ.60094) GO TO 386
      IF(IND.EQ.60095) GO TO 387
      IF(IND.EQ.67091) GO TO 388
C      IF(KOR.EQ.NDT) WRITE(II,5000) MJ
  999 RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60014 FORMAT('SOLID YZ SHEAR STRESS')
70014 FORMAT('SOLID NODE',I10,' YZ SHEAR STRESS')
60015 FORMAT('SOLID ZX SHEAR STRESS')
70015 FORMAT('SOLID NODE',I10,' ZX SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
60050 FORMAT('SOLID X NORMAL STRAIN')
70050 FORMAT('SOLID NODE',I10,' X NORMAL STRAIN')
60051 FORMAT('SOLID Y NORMAL STRAIN')
70051 FORMAT('SOLID NODE',I10,' Y NORMAL STRAIN')
60052 FORMAT('SOLID Z NORMAL STRAIN')
70052 FORMAT('SOLID NODE',I10,' Z NORMAL STRAIN')
60053 FORMAT('SOLID XY SHEAR STRAIN')
70053 FORMAT('SOLID NODE',I10,' XY SHEAR STRAIN')
60054 FORMAT('SOLID YZ SHEAR STRAIN')
70054 FORMAT('SOLID NODE',I10,' YZ SHEAR STRAIN')
60055 FORMAT('SOLID ZX SHEAR STRAIN')
70055 FORMAT('SOLID NODE',I10,' ZX SHEAR STRAIN')
60061 FORMAT('SOLID EQUIV STRAIN')
70061 FORMAT('SOLID NODE',I10,' EQUIV STRAIN')
60066 FORMAT('SOLID X NORMAL PLASTIC STRAIN')
70066 FORMAT('SOLID NODE',I10,' X NORMAL PLASTIC STRAIN')
60067 FORMAT('SOLID Y NORMAL PLASTIC STRAIN')
70067 FORMAT('SOLID NODE',I10,' Y NORMAL PLASTIC STRAIN')
60068 FORMAT('SOLID Z NORMAL PLASTIC STRAIN')
70068 FORMAT('SOLID NODE',I10,' Z NORMAL PLASTIC STRAIN')
60069 FORMAT('SOLID XY SHEAR PLASTIC STRAIN')
70069 FORMAT('SOLID NODE',I10,' XY SHEAR PLASTIC STRAIN')
60070 FORMAT('SOLID YZ SHEAR PLASTIC STRAIN')
70070 FORMAT('SOLID NODE',I10,' YZ SHEAR PLASTIC STRAIN')
60071 FORMAT('SOLID ZX SHEAR PLASTIC STRAIN')
70071 FORMAT('SOLID NODE',I10,' ZX SHEAR PLASTIC STRAIN')
60072 FORMAT('SOLID EQUIV PLASTIC STRAIN')
70072 FORMAT('SOLID NODE',I10,' EQUIV PLASTIC STRAIN')
60091 FORMAT('SOLID P0 ELLIPSE')
70091 FORMAT('SOLID NODE',I10,' P0 ELLIPSE')
60092 FORMAT('SOLID d')
70092 FORMAT('SOLID NODE',I10,' d')
60093 FORMAT('SOLID SF=D/(D-d) SAFETY FACTOR')
70093 FORMAT('SOLID NODE',I10,' SF=D/(D-d) SAFETY FACTOR')
60094 FORMAT('SOLID SQRT(3*J2D)')
70094 FORMAT('SOLID NODE',I10,' SQRT(3*J2D)')
60095 FORMAT('SOLID Sm MEAN STRESS')
70095 FORMAT('SOLID NODE',I10,' Sm MEAN STRESS')
C
67091 FORMAT('3D - DAMAGE')
77091 FORMAT('NODE',I10,' 3D-DAMAGE')
60081 FORMAT('SOLID SF=TAU0/TAU0U SAFETY FACTOR')
70081 FORMAT('SOLID NODE',I10,' SF=TAU0/TAU0U SAFETY FACTOR')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
      SUBROUTINE SREDK5(SIGMA,S,NPROS,NGS12,IND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION SIGMA(*),S(7)
C
      MINUS=0
      IF(IND.LT.0) THEN
         MINUS=1
         IND=-IND
      ENDIF
      CALL CLEAR(S,7)
      DO 10 I=1,NGS12
         GO TO (1,2,3,4,5,6,7)IND
    1    S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
         GO TO 10
    2    S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
         GO TO 10
    3    S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
         GO TO 10
    4    S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
         GO TO 10
    5    S(5)=S(5)+SIGMA(5+(I-1)*NPROS)/NGS12
         GO TO 10
    6    S(6)=S(6)+SIGMA(6+(I-1)*NPROS)/NGS12
         GO TO 10
    7    S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
         S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
         S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
         S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
         S(5)=S(5)+SIGMA(5+(I-1)*NPROS)/NGS12
         S(6)=S(6)+SIGMA(6+(I-1)*NPROS)/NGS12
   10 CONTINUE
C
      IF(IND.EQ.7) THEN
         IF(MINUS.EQ.0) THEN
            XMY=S(1)-S(2)
            YMZ=S(2)-S(3)
            ZMX=S(3)-S(1)
            EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1           3.D0*(S(4)*S(4)+S(5)*S(5)+S(6)*S(6))
            IF(EFEK.GT.1.D-19) S(7)=DSQRT(EFEK)
         ELSE
            SR=(S(1)+S(2)+S(3))/3.
            SD1=S(1)-SR
            SD2=S(2)-SR
            SD3=S(3)-SR
            EFEK=2.*(SD1*SD1+SD2*SD2+SD3*SD3+
     1               S(4)*S(4)+S(5)*S(5)+S(6)*S(6))/3.
            IF(EFEK.GT.1.D-19) S(7)=DSQRT(EFEK)
         ENDIF
      ENDIF
      RETURN
      END
C=======================================================================
      SUBROUTINE SREDNP(SIGMA,S,NPROS,NGS12,DM,ER,MAT,NLM,NC,SJ2,SM)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      COMMON /PRINCI/ PRINC(3)
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /SRPSKI/ ISRPS
C     
      DIMENSION SIGMA(*),S(7)
C
      IF(NC.EQ.0) THEN
         CALL CLEAR(S,7)
         DO 10 I=1,NGS12
            S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
            S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
            S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
            S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
            S(5)=S(5)+SIGMA(5+(I-1)*NPROS)/NGS12
            S(6)=S(6)+SIGMA(6+(I-1)*NPROS)/NGS12
   10    CONTINUE
      ELSE
         CALL JEDNA1(S,SIGMA,6)
      ENDIF
C
      CALL GLAVN(S)
      IF(PRINC(1).LT.PRINC(3)) STOP ' PRINC(1).LT.PRINC(3)'
C      IF(DABS(PRINC(1)).GT.DABS(PRINC(3))) THEN
C         DUM=PRINC(1)
C         PRINC(1)=PRINC(3)
C         PRINC(3)=DUM
C      ENDIF
C
      IF(KRIT(MAT).EQ.0.and.scms(3,mat).gt.1.e-12) THEN
         A=SCMS(1,MAT)*SCMS(3,MAT)      
         B=SCMS(2,MAT)*SCMS(3,MAT)*SCMS(3,MAT)
c         C=-PRINC(1)-PRINC(3)
         C=-PRINC(1)-PRINC(3)-princ(2)
c         S1H=C/2      
c         S3H=C/2  
         S1H=C/3      
         S3H=C/3  
         A4C=A+4*C   
         QR=A4C*A4C-16*(C*C-B)
         IF(QR.GT.0.) THEN
            QR=DSQRT(QR)
         ELSE
            WRITE(3,*) ' QR<0',NLM,NC,MAT,QR,PRINC(3),PRINC(1),PRINC(2)
            WRITE(*,*) ' QR<0',NLM,NC,MAT,QR,PRINC(3),PRINC(1),PRINC(2)
            QR=0.
C           STOP ' QR<0'
            WRITE(3,*) ' SLOM NEMA RESENJA',NLM,NC,MAT
            CALL WRR6(S,6,'S   ')
            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
            WRITE(*,*) ' SLOM NEMA RESENJA',NLM,NC,PRINC(1),PRINC(2)
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
c provera za levo od normale kroz kroz tacku T
            dum=(a-dsqrt(a*a+4.*b))/2.
            s3k=(dum-princ(1)+princ(3))/2.
            if(-princ(1).lt.s3k) then
               ER1=0.
               ER2=0.
            endif
            GO TO 99
         ENDIF 
         S3GR1=(A4C+QR)/8
         S3GR2=(A4C-QR)/8
         S1GR1=S3GR1+DSQRT(A*S3GR1+B)
         S1GR22=S3GR2+DSQRT(A*S3GR2+B)
C  provera resenja    
         S1GR11=C-S3GR1
         S1GR2=C-S3GR2
         DS1=(S1GR1-S1GR11)/S1GR1
         DS2=(S1GR2-S1GR22)/S1GR2
c         IF(DABS(DS1).GT.DABS(S1GR1)*.1) THEN 
c            WRITE(3,*) ' nije isto DS1',NLM,NC,DS1
c            WRITE(*,*) ' nije isto DS1',NLM,NC,DS1
c         ENDIF
         IF(DABS(DS2).GT.DABS(S1GR2)*.1) THEN 
            WRITE(3,*) ' s1gr2,s1gr22',NLM,NC,s1gr2,s1gr22
            WRITE(*,*) ' s1gr2,s1gr22',NLM,NC,s1gr2,s1gr22
         ENDIF
C  kraj provere
         SGR1SR1=S1GR1+PRINC(3)
         SGR3SR1=S3GR1+PRINC(1)
         DM1=DSQRT((S1GR1+PRINC(3))*(S1GR1+PRINC(3))+
     1             (S3GR1+PRINC(1))*(S3GR1+PRINC(1)))
         IF(SGR1SR1.LT.0..AND.SGR3SR1.GT.0.) DM1=0.
         SGR1SR2=S1GR2+PRINC(3)
         SGR3SR2=S3GR2+PRINC(1)
         DM2=DSQRT((S1GR2+PRINC(3))*(S1GR2+PRINC(3))+
     1             (S3GR2+PRINC(1))*(S3GR2+PRINC(1)))
         IF(SGR1SR2.LT.0..AND.SGR3SR2.GT.0.) DM2=0.
         DV1=DSQRT((S1GR1-S1H)*(S1GR1-S1H)+
     1             (S3GR1-S3H)*(S3GR1-S3H))
         DV2=DSQRT((S1GR2-S1H)*(S1GR2-S1H)+
     1             (S3GR2-S3H)*(S3GR2-S3H))
         IF(-PRINC(1).LE.S3GR2) THEN
C            WRITE(3,*) ' SLOM LEVO',NLM,NC,MAT
C            CALL WRR6(S,6,'S   ')
C            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
C            WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
C            WRITE(3,*) ' S3H',S3H,S1H
C            WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
C            WRITE(*,*) ' SLOM LEVO',NLM,NC,PRINC(1),S3GR2
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
c provera za levo od normale kroz kroz tacku T
            dum=(a-dsqrt(a*a+4.*b))/2.
            s3k=(dum-princ(1)+princ(3))/2.
            if(-princ(1).lt.s3k) then
               ER1=0.
               ER2=0.
            endif
            GO TO 99
         ENDIF
         IF(-PRINC(1).GE.S3GR1) THEN
            WRITE(3,*) ' SLOM DESNO',NLM,NC,MAT
            CALL WRR6(S,6,'S   ')
            WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
            WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
            WRITE(3,*) ' S3H',S3H,S1H
            WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
            WRITE(*,*) ' SLOM DESNO',NLM,NC,PRINC(1),S3GR1
C            ER1=0.          
C            ER2=0.          
            ER1=1.
            ER2=1.
            DM1=0.
            DM2=0.
            GO TO 99
         ENDIF
C        TACKA LEVO OD HIDROSTATICKE OSE
         IF(-PRINC(1).LT.S3H) THEN
C            IF(DM2.GT.DM1) STOP '(DM2.GT.DM1)'
            IF(DM2.GT.DM1) THEN
               WRITE(3,*) ' DM2.GT.DM1',NLM,NC,MAT
               CALL WRR6(S,6,'S   ')
               WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
               WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
               WRITE(3,*) ' S3H',S3H,S1H
               WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
               WRITE(*,*) ' DM2.GT.DM1',NLM,NC,PRINC(1),S3GR2
            ENDIF
C            ER1=1.
C            ER2=DM2/DV2          
            ER1=10.
            if(dabs(DV2-DM2).lt.1.d-8)then
               er2=10.
               WRITE(3,*) ' nula imenilac',nlm,nc,princ(1),dv2,dm2
               WRITE(*,*) ' nula imenilac',NLM,NC,PRINC(1),dv2,dm2
            else               
               ER2=DV2/(DV2-DM2)
            endif
            GO TO 99
         ENDIF
C        TACKA DESNO OD HIDROSTATICKE OSE
         IF(-PRINC(1).GT.S3H) THEN
C            IF(DM2.LT.DM1) STOP '(DM2.LT.DM1)'
            IF(DM2.LT.DM1) THEN
               WRITE(3,*) ' DM2.LT.DM1',NLM,NC,MAT
               CALL WRR6(S,6,'S   ')
               WRITE(3,*) ' PRINC',PRINC(1),PRINC(2),PRINC(3)
               WRITE(3,*) ' S3121',S3GR2,S3GR1,S1GR2,S1GR1
               WRITE(3,*) ' S3H',S3H,S1H
               WRITE(3,*) ' DM,DV',DM1,DM2,DV1,DV2
               WRITE(*,*) ' DM2.LT.DM1',NLM,NC,PRINC(1),S3GR1
            ENDIF
C            ER1=DM1/DV1
C            ER2=1.          
            ER1=DV1/(DV1-DM1)
            ER2=10.
            WRITE(3,*) ' desno hidrostacicko',nlm,nc,princ(1),s3h
            WRITE(*,*) ' desno hidrostaticko',NLM,NC,PRINC(1),S3h
            GO TO 99
         ENDIF
         IF(DABS(-PRINC(1)-S3H).LT.1.d-8) THEN
C            ER1=1.
C            ER2=1.          
            ER1=10.
            ER2=10.
            WRITE(3,*) ' hidrostaticko',nlm,nc,princ(1),s3h
            WRITE(*,*) ' hidrostaticko',NLM,NC,PRINC(1),S3h
            GO TO 99
         ENDIF
         STOP ' NE SME OVDE DA DODJE'
C
   99    DM=DM2
c         IF(DABS(DM2).GT.DABS(DM1)) THEN
c            DM=DM1
C            WRITE(*,*) ' DM2.GT.DM1',NLM,NC,DM2,DM1
C            STOP  
c         ENDIF
         ER=ER2
c         IF(DABS(ER2).GT.DABS(ER1)) THEN
c            ER=ER1
C            WRITE(*,*) ' ER2.GT.ER1',NLM,NC,ER2,ER1
C            STOP  
c         ENDIF
         IF(ER.GT.10.) ER=10.
      ELSE
C         DM=1.D10
C         DO I=1,KRIT(MAT)-1
C            A=S1S3(2,MAT,I)-S1S3(2,MAT,I+1)
C            B=S1S3(1,MAT,I+1)-S1S3(1,MAT,I)
C            C=S1S3(1,MAT,I)*S1S3(2,MAT,I+1)
C     1        -2.*S1S3(1,MAT,I)*S1S3(2,MAT,I)
C     1        +S1S3(1,MAT,I+1)*S1S3(2,MAT,I)
C            S1=-PRINC(3)
C            S3=-PRINC(1)
C            DUM=A*S3+B*S1+C
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A*A+B*B)
C            DMM=DUM/DUMQ
C            A1=-1.
C            B1=1.
C            C1=0.
C            DUM=A1*S3+B1*S1+C1
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A1*A1+B1*B1)
C            DMD=DUM/DUMQ
C            DMIN=DMM/(DMD+DMM)
C            IF(DMIN.LT.DM) THEN
C               DM=DMIN
C               ER=DMM 
C            ENDIF
C          ENDDO  
         SM=-(PRINC(3)+PRINC(2)+PRINC(1))/3.
         S1D=-PRINC(3)-SM
         S2D=-PRINC(2)-SM
         S3D=-PRINC(1)-SM
         SJ2=DSQRT(1.5*(S1D*S1D+S2D*S2D+S3D*S3D))
         CALL TABF(S1S3,KRIT,MAT,100,SM,D,NTMX,IND)
C        WRITE(*,*) 'FT',FT
         IF(IND.GT.0) THEN
      IF(ISRPS.EQ.0)
     1WRITE(IZLAZ,2000) NLM,MAT,SM,S1S3(1,MAT,1),S1S3(1,MAT,KRIT(MAT))
      IF(ISRPS.EQ.1)
     1WRITE(IZLAZ,6000) NLM,MAT,SM,S1S3(1,MAT,1),S1S3(1,MAT,KRIT(MAT))
C            STOP
         ENDIF
	   IF(SM.LT.S1S3(1,MAT,1)) THEN
	      DM=0.
	      ER=1.
	   ELSEIF(SM.GT.S1S3(1,MAT,KRIT(MAT))) THEN
	      DM=S1S3(1,MAT,KRIT(MAT))
	      ER=10.
	   ELSE
            DM=D-SJ2
            ER=D/SJ2
            IF(ER.LT.1.) ER=1.
            IF(ER.GT.10.) ER=10.
	   ENDIF
      ENDIF
C      WRITE(3,*) ' PRINC', (PRINC(I),I=1,3)
C      WRITE(3,*) ' SCMS', (SCMS(I,MAT),I=1,3)
C      WRITE(3,*) ' A,B,C', A,B,C
C      WRITE(3,*) ' S3GR1,S3GR2',S3GR1,S3GR2 
C      WRITE(3,*) ' S1GR1,S1GR2',S1GR1,S1GR2 
C      WRITE(3,*) ' DM1,DM2',DM1,DM2
C      WRITE(3,*) ' DV1,DV2',DV1,DV2
C      WRITE(3,*) ' ER1,ER2',ER1,ER2
      RETURN
C-----------------------------------------------------------------------
 2000 FORMAT(///' ARGUMENT VAN OPSEGA ZADATE KRIVE SLOMA'/
     1' ELEMENT BROJ  =',I10/
     1' MATERIJAL BROJ=',I5/
     2' SREDNJI NAPON =',1PD12.4/
     2' DEFINISAN OD  =',1PD12.4,'     DO =',1PD12.4)
C-----------------------------------------------------------------------
 6000 FORMAT(///' ARGUMENT IS OUT OF PRESCRIBED COLLAPSE CURVE RANGE'/
     1' ELEMENT NO.  =',I10/
     1' MATERIAL NO. =',I5/
     2' MEAN STRESS  =',1PD12.4/
     2' DEFFINED FROM=',1PD12.4,'      TO =',1PD12.4)
C-----------------------------------------------------------------------
      END
C=======================================================================
      SUBROUTINE SREDNPk(SIGMA,S,NPROS,NGS12,DM,ER,MAT,NLM,NC)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      COMMON /PRINCI/ PRINC(3)
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
C     
      DIMENSION SIGMA(*),S(7)
C
      IF(NC.EQ.0) THEN
         CALL CLEAR(S,7)
         DO 10 I=1,NGS12
            S(1)=S(1)+SIGMA(1+(I-1)*NPROS)/NGS12
            S(2)=S(2)+SIGMA(2+(I-1)*NPROS)/NGS12
            S(3)=S(3)+SIGMA(3+(I-1)*NPROS)/NGS12
            S(4)=S(4)+SIGMA(4+(I-1)*NPROS)/NGS12
            S(5)=S(5)+SIGMA(5+(I-1)*NPROS)/NGS12
            S(6)=S(6)+SIGMA(6+(I-1)*NPROS)/NGS12
   10    CONTINUE
      ELSE
         CALL JEDNA1(S,SIGMA,6)
      ENDIF
C
      CALL GLAVN(S)
C
      IF(KRIT(MAT).EQ.0.and.scms(3,mat).gt.1.e-12) THEN
         A=SCMS(1,MAT)*SCMS(3,MAT)      
         B=SCMS(2,MAT)*SCMS(3,MAT)*SCMS(3,MAT)
         C=-PRINC(1)-PRINC(3)
         S1H=C/2      
         S3H=C/2  
         A4C=A+4*C   
         QR=A4C*A4C-16*(C*C-B)
         IF(QR.GT.0.) THEN
            QR=DSQRT(QR)
         ELSE
            WRITE(3,*) ' QR<0',NLM,NC,QR
            WRITE(*,*) ' QR<0',NLM,NC,QR
            QR=0.
C           STOP ' QR<0'
         ENDIF 
         S3GR2=(A4C-QR)/8
         S1GR2=S3GR2+DSQRT(A*S3GR2+B)
C         
         S1GR22=C-S3GR2
         DS2=(S1GR2-S1GR22)/S1GR2
         IF(DABS(DS2).GT.DABS(S1GR2)*.1) THEN 
C           RAZLIKA U IZRACUNAVANJU PREKO DVA OBRASCA
            WRITE(3,*) ' DS2',NLM,NC,DS2
            WRITE(*,*) ' DS2',NLM,NC,DS2
         ENDIF
C       
         SGR1SR2=S1GR2+PRINC(3)
         SGR3SR2=S3GR2+PRINC(1)
         DM2=DSQRT((S1GR2+PRINC(3))*(S1GR2+PRINC(3))+
     1             (S3GR2+PRINC(1))*(S3GR2+PRINC(1)))
         IF(SGR1SR2.LT.0..AND.SGR3SR2.GT.0.) DM2=0.
         DV2=DSQRT((S1GR2-S1H)*(S1GR2-S1H)+
     1             (S3GR2-S3H)*(S3GR2-S3H))
         ER2=DV2/(DV2-DM2)
         DM=DM2
         ER=ER2
      ELSE
C         DM=1.D10
C         DO I=1,KRIT(MAT)-1
C            A=S1S3(2,MAT,I)-S1S3(2,MAT,I+1)
C            B=S1S3(1,MAT,I+1)-S1S3(1,MAT,I)
C            C=S1S3(1,MAT,I)*S1S3(2,MAT,I+1)
C     1        -2.*S1S3(1,MAT,I)*S1S3(2,MAT,I)
C     1        +S1S3(1,MAT,I+1)*S1S3(2,MAT,I)
C            S1=-PRINC(3)
C            S3=-PRINC(1)
C            DUM=A*S3+B*S1+C
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A*A+B*B)
C            DMM=DUM/DUMQ
C            A1=-1.
C            B1=1.
C            C1=0.
C            DUM=A1*S3+B1*S1+C1
C            IF(DUM.LT.0.) DUM=-DUM
C            DUMQ=DSQRT(A1*A1+B1*B1)
C            DMD=DUM/DUMQ
C            DMIN=DMM/(DMD+DMM)
C            IF(DMIN.LT.DM) THEN
C               DM=DMIN
C               ER=DMM 
C            ENDIF
C          ENDDO  
      ENDIF
      RETURN
      END
C=====================================================================
      SUBROUTINE TGRAU6(NEL,MCVEL,ICVEL,NMAT,CTR,IGRAF)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C .......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT 1D ELEMENTS DATA IN NEUTRAL GRAPHICS FILE
CS.   P R O G R A M
CS.       ZA STAMPANJE 1D ELEMENATA U NEUTRALNI FILE
C .
C .......................................................................
C 
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /SUMELE/ ISUMEL,ISUMGR
      COMMON /SRPSKI/ ISRPS
      COMMON /NIDEAS/ IDEAS
      COMMON /COMPRF/ YC,ZC,YI,ZI,ALFB,TK,CAPAY,CAPAZ,AREA,POVR,YM,ZM,
     1                DDELT,YP,SWO(1),OM(1),DELTAP(3),TAUTK(3),OY,OZ,
     2                NT,NELM,NTIP,NKAR,IND,INDRPR(3),KR1,NEXTR,NPRPR
      COMMON /LUCGRE/ ILU,ICP
      DIMENSION NEL(NE,*),MCVEL(*),NMAT(NE,*),CTR(NE,*)
      DIMENSION FIZ(14)         
      COMMON /CDEBUG/ IDEBUG
C
      IF(IDEBUG.GT.0) PRINT *, ' TGRAU6'
      ISUMGR=ISUMGR+1
C
C     FIZICKE OSOBINE
C
      NULA=0
      ZERO=0.
      ONE=1.
      JEDAN=1
      INDPR=25
      INDPD=2
      I11=11
      I2=2
      I4=4
      I8=8
      I20=20
      I48=48
      I93=93
C
      II=IGRAF
      IND=-1
      ITYP=402
	ISP=1
	IF(ISP.EQ.1) THEN
      WRITE(II,5100) IND
      WRITE(II,5100) ITYP
C     GRAFICKI OPIS ELEMENTA:
C     ROD = 1
C     BAR = 2
C     BEAM= 5
C     CURVE BEAM=8
	IPRO=5
	IF(ILU.EQ.1) IPRO=8
C      DO I=1,NUMMAT
      I=NMAT(1,2)
         ICOL=124-(I-1)*2
         WRITE(II,5600) I,ICOL,I,IPRO,I,NULA
         WRITE(II,2001) I
         WRITE(II,5600) NULA,JEDAN,NULA,NULA
C        WRITE(II,5600) NULA,NULA,NULA,NULA
C 45
         WRITE(II,5600) NULA
C 93
	   RY=YM
	   RZ=ZM
	   RY=-0.025
	   RZ=-0.05
C         WRITE(II,5600) NULA
         WRITE(II,5600) I93 
         WRITE(II,5500) POVR,ZI,YI,ZERO,TK
         WRITE(II,5500) ZERO,ZERO,ZERO,RY,RZ
         WRITE(II,5500) -RY,RZ,-RY,-RZ,RY
         WRITE(II,5500) -RZ,OY,OZ,ZERO,ZERO
C
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
C
         H=0.1
	   R=0.05
	   R1=1.
	   R2=2.
	   R3=3.
	   R4=4.
	   RL=1.
         WRITE(II,5500) H,R,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,R1,R2,R3,R4
         WRITE(II,5500) ZERO,RL,RY,RZ,ZERO
C
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO,ZERO,ZERO
         WRITE(II,5500) ZERO,ZERO,ZERO
C      ENDDO
      WRITE(II,5100) IND
	ENDIF
C
 5100 FORMAT(i5)
 5500 FORMAT(5(1PE13.5,','))
 5600 FORMAT(6(I4,','))
 2001 FORMAT(' PRO',I4)
 2002 FORMAT(A80)
 5200 FORMAT(F3.1,',')
C
C     E L E M E N T I
C
      NNCVE=NCVE
C     GRAFICKI OPIS ELEMENTA:
C     ROD = 1
C     BAR = 2
C     BEAM= 5
C     CURVE BEAM=8
      IFGD=5
C      IFGD=5
	IF(ILU.EQ.1) IFGD=8
C     OBLIK 1D ELEMENTA:
C     LINE = 0
      IFDI=0
C     TABELA FIZICKIH OSOBINA
      IPTN=ISUMGR
C     BROJ CVOROVA NA ELEMENTU
      NNODS=NCVE
      IND=-1
      ITYP=404
      WRITE(IGRAF,1100) IND
      WRITE(IGRAF,1100) ITYP
      DO 10 I=1,NE
C        REDNI BROJ ELEMENTA
         IEL=I+ISUMEL
         IF(ICVEL.EQ.1) IEL=MCVEL(I)
C        TABELA MATERIJALA
         MPTN=NMAT(I,2)
C        BOJA  
         ICOL=124-(MPTN-1)*2
         WRITE(IGRAF,1000) IEL,ICOL,MPTN,IFGD,IFDI,MPTN,NULA,NULA
         WRITE(IGRAF,1001) (NEL(I,J),J=1,2),NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA
         WRITE(IGRAF,1011) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA
         WRITE(IGRAF,1200) (CTR(I,J),J=1,3)
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1002) ZERO,ZERO,ZERO
         WRITE(IGRAF,1003) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,
     +                     NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
   10 CONTINUE
      WRITE(IGRAF,1100) IND
      ISUMEL=ISUMEL+NE
      NCVE=NNCVE
      RETURN
C
 1000 FORMAT(I10,',',7(I4,','))
 1001 FORMAT(10(I10,','))
 1011 FORMAT(10(I2,','))
 1002 FORMAT(3(F3.0,','))
 1003 FORMAT(16(I2,','))
 1100 FORMAT(i5)
 1200 FORMAT(6(1PE13.5,','))
      END
C======================================================================
      SUBROUTINE STAU31g(SIGMA,ii,n45)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
c     STAMPANJE NAPONA ZA SUPERGREDNI ELEMENT U NEU FAJL
c
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /NOVAGR/ NS,NCVS,NCVP,NCVJ,LNOS,LCORS,LIDP,LNVEZ,LNPR,LFPR,
     1                LIDD,LLMU,LMA9,NMC,JEDPP,JEDNN,LVITOP,LVITTP,
     1                LCOPT,LNMA,LIPG,LISN,LIPR,LTHI,LTBT,LTDT,NPRES,
     1                NWPP,NWKK,NWEE,NCU,NCVU,IND3D
       COMMON /SRPSKI/ ISRPS
      DIMENSION sigma(N45,NGS12,NE,*),S(7),N(20)
C
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
c      II=94
C
      IND=60010
      NND=70010
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   83 IND=60011
      NND=70011 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   84 IND=60012
      NND=70012 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   85 IND=60013
      NND=70013 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   86 IND=60014
      NND=70014 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   87 IND=60015
      NND=70015 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
   88 IND=60031
      NND=70031 
c      CALL NAPUN3(N,NCVE,NND)
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(IND.EQ.60010) WRITE(II,60010) 
      IF(IND.EQ.60011) WRITE(II,60011) 
      IF(IND.EQ.60012) WRITE(II,60012) 
      IF(IND.EQ.60013) WRITE(II,60013) 
      IF(IND.EQ.60014) WRITE(II,60014) 
      IF(IND.EQ.60015) WRITE(II,60015) 
      IF(IND.EQ.60031) WRITE(II,60031) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      call iclear(n,20)
      WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
      WRITE(II,1000) 
     +      N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,JEDAN
      nmm=0
      DO 40 NLM=1,NE
c
c   petlja po segmentima
c
        DO 101 NSEG=1,NS
         NmM=NmM+1
         NS45=(NSEG-1)*6
c
         CALL SREDK3g(SIGMA,S,NLM,NGS12,NE,n45,ns45)
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60014) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60015) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(7)
  101 CONTINUE
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
C
      IF(IND.EQ.60010) GO TO 83
      IF(IND.EQ.60011) GO TO 84
      IF(IND.EQ.60012) GO TO 85
      IF(IND.EQ.60013) GO TO 86
      IF(IND.EQ.60014) GO TO 87
      IF(IND.EQ.60015) GO TO 88
      RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60014 FORMAT('SOLID YZ SHEAR STRESS')
70014 FORMAT('SOLID NODE',I10,' YZ SHEAR STRESS')
60015 FORMAT('SOLID ZX SHEAR STRESS')
70015 FORMAT('SOLID NODE',I10,' ZX SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE')
c 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=======================================================================
C
C=======================================================================
      SUBROUTINE SREDK3g(SIGMA,S,NLM,NGS12,NE,n45,ns45)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C     
      DIMENSION SIGMA(N45,NGS12,NE,*),S(7)
C
      CALL CLEAR(S,7)
      DO 10 I=1,NGS12
         S(1)=S(1)+SIGMA(ns45+1,I,NLM,1)
         S(2)=S(2)+SIGMA(ns45+2,I,NLM,1)
         S(3)=S(3)+SIGMA(ns45+3,I,NLM,1)
         S(4)=S(4)+SIGMA(ns45+4,I,NLM,1)
         S(5)=S(5)+SIGMA(ns45+5,I,NLM,1)
         S(6)=S(6)+SIGMA(ns45+6,I,NLM,1)
   10 CONTINUE
      S(1)=S(1)/NGS12
      S(2)=S(2)/NGS12
      S(3)=S(3)/NGS12
      S(4)=S(4)/NGS12
      S(5)=S(5)/NGS12
      S(6)=S(6)/NGS12
      XMY=S(1)-S(2)
      YMZ=S(2)-S(3)
      ZMX=S(3)-S(1)
      EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1     3.D0*(S(4)*S(4)+S(5)*S(5)+S(6)*S(6))
      IF(EFEK.GT.1.D-19) S(7)=DSQRT(EFEK)
      RETURN
      END
C=======================================================================
C
C======================================================================
      SUBROUTINE STAU353(SIGMA,ISNA,MCVEL,ICVEL,PLAST,AU,IPLA,NMAT)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT STRESS IN 3/D ELEMENTS FOR MATERIAL MODEL 53
CS.   P R O G R A M
CS.       ZA STAMPANJE NAPONA 3/D ELEMENATA ZA MATERIJALNI MODEL 53
C .
C ......................................................................
C
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NIDEAS/ IDEAS
      COMMON /SRPSKI/ ISRPS
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      DIMENSION AU(*)
      REAL AU
      DIMENSION ISNA(*),MCVEL(*),PLAST(*),NMAT(*)
      DIMENSION SIGMA(6,NGS12,NE,*),S(7),N(20)
C
      NNCVE=NCVE
      IF(NCVE.LT.20) NCVE=8
      IF(NCVE.EQ.21) NCVE=20
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C
      NPROS=MODPRO(NMODM)
      NGXYZ=NGS12*NPROS
C
      IND=60010
      NND=70010
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=1
      GO TO 10
   83 IND=60011
      NND=70011 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=2
      GO TO 10
   84 IND=60012
      NND=70012 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=3
      GO TO 10
   85 IND=60013
      NND=70013 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=4
      GO TO 10
   86 IND=60014
      NND=70014 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=5
      GO TO 10
   87 IND=60015
      NND=70015 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=6
      GO TO 10
   88 IND=60031
      NND=70031 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=7
      GO TO 10
C
  182 IND=60050
      NND=70050
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  183 IND=60051
      NND=70051 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  184 IND=60052
      NND=70052 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  185 IND=60053
      NND=70053 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  186 IND=60054
      NND=70054 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  187 IND=60055
      NND=70055 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  188 IND=60061
      NND=70061 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=7
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  282 IND=60066
      NND=70066
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  283 IND=60067
      NND=70067 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  284 IND=60068
      NND=70068 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  285 IND=60069
      NND=70069 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  286 IND=60070
      NND=70070 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  287 IND=60071
      NND=70071 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  288 IND=60072
      NND=70072 
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=7
C     IF(ISTDE.EQ.-1) GO TO 31
c      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  382 IND=60091
      NND=70091 
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  383 IND=60092
      NND=70092 
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  384 IND=60093
      NND=70093
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  385 IND=60094
      NND=70094
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  386 IND=60095
      NND=70095
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  387 IND=60096
      NND=70096
      CALL NAPUN3(N,NCVE,NND)
      KK=18
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  388 IND=67091
      NND=77091
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=1
      IF(NMODM.NE.61) GO TO 31
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,60010) 
         IF(IND.EQ.60011) WRITE(II,60011) 
         IF(IND.EQ.60012) WRITE(II,60012) 
         IF(IND.EQ.60013) WRITE(II,60013) 
         IF(IND.EQ.60014) WRITE(II,60014) 
         IF(IND.EQ.60015) WRITE(II,60015) 
         IF(IND.EQ.60031) WRITE(II,60031) 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,60050) 
         IF(IND.EQ.60051) WRITE(II,60051) 
         IF(IND.EQ.60052) WRITE(II,60052) 
         IF(IND.EQ.60053) WRITE(II,60053) 
         IF(IND.EQ.60054) WRITE(II,60054) 
         IF(IND.EQ.60055) WRITE(II,60055) 
         IF(IND.EQ.60061) WRITE(II,60061) 
      ENDIF   
      IF(KK.EQ.16.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,60066) 
         IF(IND.EQ.60067) WRITE(II,60067) 
         IF(IND.EQ.60068) WRITE(II,60068) 
         IF(IND.EQ.60069) WRITE(II,60069) 
         IF(IND.EQ.60070) WRITE(II,60070) 
         IF(IND.EQ.60071) WRITE(II,60071) 
         IF(IND.EQ.60072) WRITE(II,60072) 
      ENDIF
      IF(KK.EQ.18.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) WRITE(II,60091) 
         IF(IND.EQ.60092) WRITE(II,60092) 
         IF(IND.EQ.60093) WRITE(II,60093) 
         IF(IND.EQ.60094) WRITE(II,60094) 
         IF(IND.EQ.60095) WRITE(II,60095) 
         IF(IND.EQ.60096) WRITE(II,60096) 
      ENDIF 
      IF(IND.EQ.67091) WRITE(II,67091) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(ISTNA.EQ.0) THEN
       WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
       WRITE(II,1000) 
     +       N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      ELSE
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      ENDIF
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      IF(ISTNA.EQ.0) THEN
         WRITE(II,1000) NULA,NULA,JEDAN
      ELSE
         WRITE(II,1000) JEDAN,NULA,JEDAN
      ENDIF
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         MAT=NMAT(NLM)
         IF(IPLA.EQ.0) THEN
            CALL SREDK3(SIGMA,S,NLM,NGS12,NE)
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(INP.NE.0) CALL SREDK5(PLAST(LL),S,NPROS,NGS12,INP)
            IF(INP.EQ.0) CALL SREDNP(PLAST(LL),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,0,SJ2,SMT)
         ENDIF
         IF(KK.EQ.1.AND.INP.NE.0) THEN
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60014) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60015) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.7.AND.INP.NE.0) THEN
            IF(IND.EQ.60050) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60051) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60052) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60053) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60054) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60055) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60061) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.16.AND.INP.NE.0) THEN
            IF(IND.EQ.60066) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60067) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60068) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60069) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60070) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60071) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60072) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.18.AND.INP.NE.0) THEN
            IF(IND.EQ.60091) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60092) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60093) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60094) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60095) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60096) WRITE(II,5000) NMM,S(6)
         ENDIF
         IF(IND.EQ.67091) WRITE(II,5000) NMM,S(1)
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
c
      IF(ISTNA.GT.0) GO TO 31
      IF(ISTDE.EQ.-1) GO TO 31
      IF(IDEAS.EQ.-1) GO TO 31
C
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,70010) NC 
         IF(IND.EQ.60011) WRITE(II,70011) NC 
         IF(IND.EQ.60012) WRITE(II,70012) NC 
         IF(IND.EQ.60013) WRITE(II,70013) NC 
         IF(IND.EQ.60014) WRITE(II,70014) NC 
         IF(IND.EQ.60015) WRITE(II,70015) NC 
         IF(IND.EQ.60031) WRITE(II,70031) NC 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,70050) NC 
         IF(IND.EQ.60051) WRITE(II,70051) NC 
         IF(IND.EQ.60052) WRITE(II,70052) NC 
         IF(IND.EQ.60053) WRITE(II,70053) NC 
         IF(IND.EQ.60054) WRITE(II,70054) NC 
         IF(IND.EQ.60055) WRITE(II,70055) NC 
         IF(IND.EQ.60061) WRITE(II,70061) NC 
      ENDIF   
      IF(KK.EQ.16.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,70066) NC 
         IF(IND.EQ.60067) WRITE(II,70067) NC 
         IF(IND.EQ.60068) WRITE(II,70068) NC 
         IF(IND.EQ.60069) WRITE(II,70069) NC 
         IF(IND.EQ.60070) WRITE(II,70070) NC 
         IF(IND.EQ.60071) WRITE(II,70071) NC 
         IF(IND.EQ.60072) WRITE(II,70072) NC 
      ENDIF
      IF(KK.EQ.18.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) WRITE(II,70091) NC 
         IF(IND.EQ.60092) WRITE(II,70092) NC 
         IF(IND.EQ.60093) WRITE(II,70093) NC 
         IF(IND.EQ.60094) WRITE(II,70094) NC 
         IF(IND.EQ.60095) WRITE(II,70095) NC 
         IF(IND.EQ.60096) WRITE(II,70096) NC  
      ENDIF
      IF(IND.EQ.67091) WRITE(II,77091) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
         IF(NC.EQ.9) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSZ+1
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-(NGAUSZ+1)
            JI=1
         ENDIF
         IF(NC.EQ.11) THEN
            IJ=-1
            JI=NGAUSY*NGAUSZ+1
         ENDIF
         IF(NC.EQ.12) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+1
         ENDIF
         IF(NC.EQ.13) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
         IF(NC.EQ.14) THEN
            IJ=-(NGAUSZ+1)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.15) THEN
            IJ=-1
            JI=2
         ENDIF
         IF(NC.EQ.16) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.17) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+2)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.18) THEN
            IJ=-(NGAUSZ+2)
            JI=2
         ENDIF
         IF(NC.EQ.19) THEN
            IJ=-2
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.20) THEN
            IJ=-(NGAUSY*NGAUSZ+2)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
         IF(NC.EQ.9) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.10) IJ=NGAUSZ+1
         IF(NC.EQ.11) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.12) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.13) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+2
         IF(NC.EQ.14) IJ=2*NGAUSZ+2
         IF(NC.EQ.15) IJ=2
         IF(NC.EQ.16) IJ=2*NGAUSY*NGAUSZ+2
         IF(NC.EQ.17) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.18) IJ=NGAUSZ+3
         IF(NC.EQ.19) IJ=NGAUSY*NGAUSZ+3
         IF(NC.EQ.20) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+3
      ENDIF
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(KK.EQ.1) THEN
               IF(IND.EQ.60010.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
               ELSEIF(IND.EQ.60010.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60011.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
               ELSEIF(IND.EQ.60011.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60012.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
               ELSEIF(IND.EQ.60012.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60013.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
               ELSEIF(IND.EQ.60013.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60014.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(5,IJ,NLM,1)
               ELSEIF(IND.EQ.60014.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60015.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(6,IJ,NLM,1)
               ELSEIF(IND.EQ.60015.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60031.AND.IJ.GT.0) THEN
                  XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
                  YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(3,IJ,NLM,1)
                  ZMX=SIGMA(3,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,IJ,NLM,1)*SIGMA(4,IJ,NLM,1)+
     1                       SIGMA(5,IJ,NLM,1)*SIGMA(5,IJ,NLM,1)+
     1                       SIGMA(6,IJ,NLM,1)*SIGMA(6,IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSEIF(IND.EQ.60031.AND.IJ.LT.0) THEN
                  XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
                  YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(3,-IJ,NLM,1)
                  ZMX=SIGMA(3,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,-IJ,NLM,1)*SIGMA(4,-IJ,NLM,1)+
     1                       SIGMA(5,-IJ,NLM,1)*SIGMA(5,-IJ,NLM,1)+
     1                       SIGMA(6,-IJ,NLM,1)*SIGMA(6,-IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
                  YMZ=SIGMA(2,JI,NLM,1)-SIGMA(3,JI,NLM,1)
                  ZMX=SIGMA(3,JI,NLM,1)-SIGMA(1,JI,NLM,1)
                  EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,JI,NLM,1)*SIGMA(4,JI,NLM,1)+
     1                       SIGMA(5,JI,NLM,1)*SIGMA(5,JI,NLM,1)+
     1                       SIGMA(6,JI,NLM,1)*SIGMA(6,JI,NLM,1))
                  IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                  EFEK=(EFEK+EFE1)/2
                  WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF   
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(IND.EQ.60010.OR.IND.EQ.60050.OR.IND.EQ.60066.OR.
     1         IND.EQ.60091) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(LL+(-IJ-1)*NPROS)+PLAST(LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60011.OR.IND.EQ.60051.OR.IND.EQ.60067.OR.
     1         IND.EQ.60092) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(1+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(1+LL+(-IJ-1)*NPROS)+PLAST(1+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60012.OR.IND.EQ.60052.OR.IND.EQ.60068.OR.
     1         IND.EQ.60093) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(2+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(2+LL+(-IJ-1)*NPROS)+PLAST(2+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60013.OR.IND.EQ.60053.OR.IND.EQ.60069.OR.
     1         IND.EQ.60094) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(3+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(3+LL+(-IJ-1)*NPROS)+PLAST(3+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60014.OR.IND.EQ.60054.OR.IND.EQ.60070.OR.
     1         IND.EQ.60095) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(4+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(4+LL+(-IJ-1)*NPROS)+PLAST(4+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60015.OR.IND.EQ.60055.OR.IND.EQ.60071.OR.
     1         IND.EQ.60096) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(5+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(5+LL+(-IJ-1)*NPROS)+PLAST(5+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60031.OR.IND.EQ.60061.OR.IND.EQ.60072) THEN
               IF(IJ.GT.0) THEN
                  XMY=PLAST(  LL+(IJ-1)*NPROS)-PLAST(1+LL+(IJ-1)*NPROS)
                  YMZ=PLAST(1+LL+(IJ-1)*NPROS)-PLAST(2+LL+(IJ-1)*NPROS)
                  ZMX=PLAST(2+LL+(IJ-1)*NPROS)-PLAST(  LL+(IJ-1)*NPROS)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(IJ-1)*NPROS)*PLAST(3+LL+(IJ-1)*NPROS)+
     1                PLAST(4+LL+(IJ-1)*NPROS)*PLAST(4+LL+(IJ-1)*NPROS)+
     1                PLAST(5+LL+(IJ-1)*NPROS)*PLAST(5+LL+(IJ-1)*NPROS))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSE
                 XMY=PLAST(  LL+(-IJ-1)*NPROS)-PLAST(1+LL+(-IJ-1)*NPROS)
                 YMZ=PLAST(1+LL+(-IJ-1)*NPROS)-PLAST(2+LL+(-IJ-1)*NPROS)
                 ZMX=PLAST(2+LL+(-IJ-1)*NPROS)-PLAST(  LL+(-IJ-1)*NPROS)
                 EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1        3.D0*(PLAST(3+LL+(-IJ-1)*NPROS)*PLAST(3+LL+(-IJ-1)*NPROS)+
     1              PLAST(4+LL+(-IJ-1)*NPROS)*PLAST(4+LL+(-IJ-1)*NPROS)+
     1              PLAST(5+LL+(-IJ-1)*NPROS)*PLAST(5+LL+(-IJ-1)*NPROS))
                   IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                   XMY=PLAST(  LL+(JI-1)*NPROS)-PLAST(1+LL+(JI-1)*NPROS)
                   YMZ=PLAST(1+LL+(JI-1)*NPROS)-PLAST(2+LL+(JI-1)*NPROS)
                   ZMX=PLAST(2+LL+(JI-1)*NPROS)-PLAST(  LL+(JI-1)*NPROS)
                   EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(JI-1)*NPROS)*PLAST(3+LL+(JI-1)*NPROS)+
     1                PLAST(4+LL+(JI-1)*NPROS)*PLAST(4+LL+(JI-1)*NPROS)+
     1                PLAST(5+LL+(JI-1)*NPROS)*PLAST(5+LL+(JI-1)*NPROS))
                   IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                   EFEK=(EFEK+EFE1)/2
                   WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF
C
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
C
   31 CONTINUE
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) GO TO  83
         IF(IND.EQ.60011) GO TO  84
         IF(IND.EQ.60012) GO TO  85
         IF(IND.EQ.60013) GO TO  86
         IF(IND.EQ.60014) GO TO  87
         IF(IND.EQ.60015) GO TO  88
         IF(IND.EQ.60031) GO TO 182
      ENDIF
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) GO TO 183
         IF(IND.EQ.60051) GO TO 184
         IF(IND.EQ.60052) GO TO 185
         IF(IND.EQ.60053) GO TO 186
         IF(IND.EQ.60054) GO TO 187
         IF(IND.EQ.60055) GO TO 188
         IF(IND.EQ.60061)THEN
            IF(NMODM.EQ.61)GO TO 388
            IF(NMODM.EQ.28)GO TO 999
            GO TO 282
         ENDIF
      ENDIF
      IF(IND.EQ.67091) GO TO 999
      IF(KK.EQ.16.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) GO TO 283
         IF(IND.EQ.60067) GO TO 284
         IF(IND.EQ.60068) GO TO 285
         IF(IND.EQ.60069) GO TO 286
         IF(IND.EQ.60070) GO TO 287
         IF(IND.EQ.60071) GO TO 288
         IF(IND.EQ.60072) GO TO 382
      ENDIF
      IF(KK.EQ.18.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) GO TO 383
         IF(IND.EQ.60092) GO TO 384
         IF(IND.EQ.60093) GO TO 385
         IF(IND.EQ.60094) GO TO 386
         IF(IND.EQ.60095) GO TO 387
      ENDIF
  999 RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60014 FORMAT('SOLID YZ SHEAR STRESS')
70014 FORMAT('SOLID NODE',I10,' YZ SHEAR STRESS')
60015 FORMAT('SOLID ZX SHEAR STRESS')
70015 FORMAT('SOLID NODE',I10,' ZX SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
60050 FORMAT('SOLID X NORMAL STRAIN')
70050 FORMAT('SOLID NODE',I10,' X NORMAL STRAIN')
60051 FORMAT('SOLID Y NORMAL STRAIN')
70051 FORMAT('SOLID NODE',I10,' Y NORMAL STRAIN')
60052 FORMAT('SOLID Z NORMAL STRAIN')
70052 FORMAT('SOLID NODE',I10,' Z NORMAL STRAIN')
60053 FORMAT('SOLID XY SHEAR STRAIN')
70053 FORMAT('SOLID NODE',I10,' XY SHEAR STRAIN')
60054 FORMAT('SOLID YZ SHEAR STRAIN')
70054 FORMAT('SOLID NODE',I10,' YZ SHEAR STRAIN')
60055 FORMAT('SOLID ZX SHEAR STRAIN')
70055 FORMAT('SOLID NODE',I10,' ZX SHEAR STRAIN')
60061 FORMAT('SOLID EQUIV STRAIN')
70061 FORMAT('SOLID NODE',I10,' EQUIV STRAIN')
60066 FORMAT('SOLID X NORMAL TRANSFORMATION STRAIN')
70066 FORMAT('SOLID NODE',I10,' X NORMAL TRANSFORMATION STRAIN')
60067 FORMAT('SOLID Y NORMAL TRANSFORMATION STRAIN')
70067 FORMAT('SOLID NODE',I10,' Y NORMAL TRANSFORMATION STRAIN')
60068 FORMAT('SOLID Z NORMAL TRANSFORMATION STRAIN')
70068 FORMAT('SOLID NODE',I10,' Z NORMAL TRANSFORMATION STRAIN')
60069 FORMAT('SOLID YZ SHEAR TRANSFORMATION STRAIN')
70069 FORMAT('SOLID NODE',I10,' YZ SHEAR TRANSFORMATION STRAIN')
60070 FORMAT('SOLID XZ SHEAR TRANSFORMATION STRAIN')
70070 FORMAT('SOLID NODE',I10,' XZ SHEAR TRANSFORMATION STRAIN')
60071 FORMAT('SOLID XY SHEAR TRANSFORMATION STRAIN')
70071 FORMAT('SOLID NODE',I10,' XY SHEAR TRANSFORMATION STRAIN')
60072 FORMAT('SOLID EQUIV TRANSFORMATION STRAIN')
70072 FORMAT('SOLID NODE',I10,' EQUIV TRANSFORMATION STRAIN')
60091 FORMAT('SOLID X NORMAL TRANSFORMATION DIRECTION TENSOR')
70091 FORMAT('SOLID NODE',I10,' X NORMAL TRANSFOR DIR. TENSOR')
60092 FORMAT('SOLID Y NORMAL TRANSFORMATION DIRECTION TENSOR')
70092 FORMAT('SOLID NODE',I10,' Y NORMAL TRANSFOR DIR. TENSOR')
60093 FORMAT('SOLID Z NORMAL TRANSFORMATION DIRECTION TENSOR')
70093 FORMAT('SOLID NODE',I10,' Z NORMAL TRANSFOR DIR. TENSOR')
60094 FORMAT('SOLID YZ SHEAR TRANSFORMATION DIRECTION TENSOR')
70094 FORMAT('SOLID NODE',I10,' YZ SHEAR TRANSFOR DIR. TENSOR')
60095 FORMAT('SOLID XZ SHEAR TRANSFORMATION DIRECTION TENSOR')
70095 FORMAT('SOLID NODE',I10,' XZ SHEAR TRANSFOR DIR. TENSOR')
60096 FORMAT('SOLID XY SHEAR TRANSFORMATION DIRECTION TENSOR')
70096 FORMAT('SOLID NODE',I10,' XY SHEAR TRANSFOR DIR. TENSOR')
67091 FORMAT('3D - DAMAGE')
77091 FORMAT('NODE',I10,' 3D-DAMAGE')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C======================================================================
      SUBROUTINE STAU356(SIGMA,ISNA,MCVEL,ICVEL,PLAST,AU,IPLA,NMAT)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
C ......................................................................
C .
CE.   P R O G R A M
CE.       TO PRINTOUT STRESS IN 3/D ELEMENTS FOR MATERIAL MODEL 56
CS.   P R O G R A M
CS.       ZA STAMPANJE NAPONA 3/D ELEMENATA ZA MATERIJALNI MODEL 56
C .
C ......................................................................
C
C
      COMMON /IZOL4B/ NGS12,ND,MSLOJ,MXS,MSET,LNSLOJ,LMATSL,LDSLOJ,LBBET
      COMMON /ELEIND/ NGAUSX,NGAUSY,NGAUSZ,NCVE,ITERME,MAT,IETYP
      COMMON /ELEALL/ NETIP,NE,IATYP,NMODM,NGE,ISKNP,LMAX8
      COMMON /TRAKEJ/ IULAZ,IZLAZ,IELEM,ISILE,IRTDT,IFTDT,ILISK,ILISE,
     1                ILIMC,ILDLT,IGRAF,IDINA,IPOME,IPRIT,LDUZI
      COMMON /PERKOR/ LNKDT,LDTDT,LVDT,NDT,DT,VREME,KOR
      COMMON /BTHDTH/ INDBTH,INDDTH,LTBTH,LTDTH
      COMMON /STAMKO/ ISTKO,NCVPR,LNCVP,LNCVZ,
     +                ISTEM,ISTVN,ISTSI,ISTDE,ISTNA
      COMMON /NIDEAS/ IDEAS
      COMMON /SRPSKI/ ISRPS
      COMMON /MATER9/ SCMS(3,100),S1S3(2,100,10),KRIT(100)
      COMMON /PODTIP/ IPODT      
      DIMENSION AU(*)
      REAL AU
      DIMENSION ISNA(*),MCVEL(*),PLAST(*),NMAT(*)
      DIMENSION SIGMA(6,NGS12,NE,*),S(7),N(20)
C
      NNCVE=NCVE
      IF(IPODT.NE.3) THEN
      IF(NCVE.LT.20) NCVE=8
      IF(NCVE.EQ.21) NCVE=20
      ENDIF
C      
      JEDAN=1
      NULA=0
      ZERO=0.
      ONE=1.
      MJ=-1
      M451=451
      M2=2
      M3=3
      M4=4
      M5=5
      M8=8
      M9=9
C
      II=49
C
      NPROS=MODPRO(NMODM)
      NGXYZ=NGS12*NPROS
C
      IND=60010
      NND=70010
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=1
      GO TO 10
   83 IND=60011
      NND=70011 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=2
      GO TO 10
   84 IND=60012
      NND=70012 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=3
      GO TO 10
   85 IND=60013
      NND=70013 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=4
      GO TO 10
   86 IND=60014
      NND=70014 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=5
      GO TO 10
   87 IND=60015
      NND=70015 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=6
      GO TO 10
   88 IND=60031
      NND=70031 
      CALL NAPUN3(N,NCVE,NND)
      KK=1
      INP=7
      GO TO 10
C
  182 IND=60050
      NND=70050
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  183 IND=60051
      NND=70051 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  184 IND=60052
      NND=70052 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  185 IND=60053
      NND=70053 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  186 IND=60054
      NND=70054 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  187 IND=60055
      NND=70055 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  188 IND=60061
      NND=70061 
      CALL NAPUN3(N,NCVE,NND)
      KK=7
      INP=7
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  282 IND=60066
      NND=70066
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  283 IND=60067
      NND=70067 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=2
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  284 IND=60068
      NND=70068 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=3
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  285 IND=60069
      NND=70069 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=4
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  286 IND=60070
      NND=70070 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=5
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  287 IND=60071
      NND=70071 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=6
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  288 IND=60072
      NND=70072 
      CALL NAPUN3(N,NCVE,NND)
      KK=15
      INP=7
C     IF(ISTDE.EQ.-1) GO TO 31
c      IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
C
  382 IND=60091
      NND=70091 
      CALL NAPUN3(N,NCVE,NND)
      KK=21
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  383 IND=60092
      NND=70092 
      CALL NAPUN3(N,NCVE,NND)
      KK=22
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  384 IND=60093
      NND=70093
      CALL NAPUN3(N,NCVE,NND)
      KK=23
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10
  385 IND=60094
      NND=70094
      CALL NAPUN3(N,NCVE,NND)
      KK=24
      INP=1
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
      GO TO 10      
!   385 IND=60094
!       NND=70094
!       CALL NAPUN3(N,NCVE,NND)
!       KK=18
!       INP=4
!       IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
!       GO TO 10
!   386 IND=60095
!       NND=70095
!       CALL NAPUN3(N,NCVE,NND)
!       KK=18
!       INP=5
!       IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
!       GO TO 10
!   387 IND=60096
!       NND=70096
!       CALL NAPUN3(N,NCVE,NND)
!       KK=18
!       INP=5
!       IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
!       GO TO 10
C
  388 IND=67091
      NND=77091
      CALL NAPUN3(N,NCVE,NND)
      KK=16
      INP=1
      IF(NMODM.NE.61) GO TO 31
      GO TO 10
C
   10 WRITE(II,1000) KOR,IND,JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,60010) 
         IF(IND.EQ.60011) WRITE(II,60011) 
         IF(IND.EQ.60012) WRITE(II,60012) 
         IF(IND.EQ.60013) WRITE(II,60013) 
         IF(IND.EQ.60014) WRITE(II,60014) 
         IF(IND.EQ.60015) WRITE(II,60015) 
         IF(IND.EQ.60031) WRITE(II,60031) 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,60050) 
         IF(IND.EQ.60051) WRITE(II,60051) 
         IF(IND.EQ.60052) WRITE(II,60052) 
         IF(IND.EQ.60053) WRITE(II,60053) 
         IF(IND.EQ.60054) WRITE(II,60054) 
         IF(IND.EQ.60055) WRITE(II,60055) 
         IF(IND.EQ.60061) WRITE(II,60061) 
      ENDIF   
      IF(KK.EQ.15.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,60066) 
         IF(IND.EQ.60067) WRITE(II,60067) 
         IF(IND.EQ.60068) WRITE(II,60068) 
         IF(IND.EQ.60069) WRITE(II,60069) 
         IF(IND.EQ.60070) WRITE(II,60070) 
         IF(IND.EQ.60071) WRITE(II,60071) 
         IF(IND.EQ.60072) WRITE(II,60072) 
      ENDIF
      IF(KK.EQ.21.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) WRITE(II,60091) 
      ENDIF 
      IF(KK.EQ.22.AND.INP.NE.0) THEN
         IF(IND.EQ.60092) WRITE(II,60092) 
      ENDIF 
      IF(KK.EQ.23.AND.INP.NE.0) THEN
         IF(IND.EQ.60093) WRITE(II,60093)  
      ENDIF   
      IF(KK.EQ.24.AND.INP.NE.0) THEN
         IF(IND.EQ.60094) WRITE(II,60094)  
      ENDIF        
      IF(IND.EQ.67091) WRITE(II,67091) 
      WRITE(II,1010) ZERO,ZERO,ZERO
      IF(ISTNA.EQ.0) THEN
       WRITE(II,1000) N(1),N(2),N(3),N(4),N(5),N(6),N(7),N(8),N(9),N(10)
       WRITE(II,1000) 
     +       N(11),N(12),N(13),N(14),N(15),N(16),N(17),N(18),N(19),N(20)
      ELSE
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
        WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      ENDIF
      INDM=MOD(IND,100)
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      IF(ISTNA.EQ.0) THEN
         WRITE(II,1000) NULA,NULA,JEDAN
      ELSE
         WRITE(II,1000) JEDAN,NULA,JEDAN
      ENDIF
      DO 40 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 40
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         MAT=NMAT(NLM)
         IF(IPLA.EQ.0) THEN
            CALL SREDK3(SIGMA,S,NLM,NGS12,NE)
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(INP.NE.0) CALL SREDK5(PLAST(LL),S,NPROS,NGS12,INP)
            IF(INP.EQ.0) CALL SREDNP(PLAST(LL),S,NPROS,NGS12,DM,ER,MAT,
     1                               NLM,0,SJ2,SMT)
         ENDIF
         IF(KK.EQ.1.AND.INP.NE.0) THEN
            IF(IND.EQ.60010) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60011) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60012) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60013) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60014) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60015) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60031) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.7.AND.INP.NE.0) THEN
            IF(IND.EQ.60050) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60051) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60052) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60053) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60054) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60055) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60061) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.15.AND.INP.NE.0) THEN
            IF(IND.EQ.60066) WRITE(II,5000) NMM,S(1)
            IF(IND.EQ.60067) WRITE(II,5000) NMM,S(2)
            IF(IND.EQ.60068) WRITE(II,5000) NMM,S(3)
            IF(IND.EQ.60069) WRITE(II,5000) NMM,S(4)
            IF(IND.EQ.60070) WRITE(II,5000) NMM,S(5)
            IF(IND.EQ.60071) WRITE(II,5000) NMM,S(6)
            IF(IND.EQ.60072) WRITE(II,5000) NMM,S(7)
         ENDIF
         IF(KK.EQ.21.AND.INP.NE.0) THEN
            IF(IND.EQ.60091) WRITE(II,5000) NMM,S(1)
         ENDIF
         IF(KK.EQ.22.AND.INP.NE.0) THEN
            IF(IND.EQ.60092) WRITE(II,5000) NMM,S(1)
         ENDIF
         IF(KK.EQ.23.AND.INP.NE.0) THEN
            IF(IND.EQ.60093) WRITE(II,5000) NMM,S(1)
         ENDIF  
         IF(KK.EQ.24.AND.INP.NE.0) THEN
            IF(IND.EQ.60094) WRITE(II,5000) NMM,S(1)
         ENDIF          
         IF(IND.EQ.67091) WRITE(II,5000) NMM,S(1)
   40 CONTINUE
      WRITE(II,5500) MJ,ZERO
c
      IF(ISTNA.GT.0) GO TO 31
      IF(ISTDE.EQ.-1) GO TO 31
!       IF(IDEAS.EQ.-1) GO TO 31
C
      DO 30 NC=1,NCVE
      WRITE(II,1000) KOR,N(NC),JEDAN
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) WRITE(II,70010) NC 
         IF(IND.EQ.60011) WRITE(II,70011) NC 
         IF(IND.EQ.60012) WRITE(II,70012) NC 
         IF(IND.EQ.60013) WRITE(II,70013) NC 
         IF(IND.EQ.60014) WRITE(II,70014) NC 
         IF(IND.EQ.60015) WRITE(II,70015) NC 
         IF(IND.EQ.60031) WRITE(II,70031) NC 
      ENDIF   
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) WRITE(II,70050) NC 
         IF(IND.EQ.60051) WRITE(II,70051) NC 
         IF(IND.EQ.60052) WRITE(II,70052) NC 
         IF(IND.EQ.60053) WRITE(II,70053) NC 
         IF(IND.EQ.60054) WRITE(II,70054) NC 
         IF(IND.EQ.60055) WRITE(II,70055) NC 
         IF(IND.EQ.60061) WRITE(II,70061) NC 
      ENDIF   
      IF(KK.EQ.15.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) WRITE(II,70066) NC 
         IF(IND.EQ.60067) WRITE(II,70067) NC 
         IF(IND.EQ.60068) WRITE(II,70068) NC 
         IF(IND.EQ.60069) WRITE(II,70069) NC 
         IF(IND.EQ.60070) WRITE(II,70070) NC 
         IF(IND.EQ.60071) WRITE(II,70071) NC 
         IF(IND.EQ.60072) WRITE(II,70072) NC 
      ENDIF
      IF(KK.EQ.21.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) WRITE(II,70091) NC 
      ENDIF
      IF(KK.EQ.22.AND.INP.NE.0) THEN
         IF(IND.EQ.60092) WRITE(II,70092) NC 
      ENDIF      
      IF(KK.EQ.23.AND.INP.NE.0) THEN
         IF(IND.EQ.60093) WRITE(II,70093) NC 
      ENDIF
      IF(KK.EQ.24.AND.INP.NE.0) THEN
         IF(IND.EQ.60094) WRITE(II,70094) NC 
      ENDIF      
      IF(IND.EQ.67091) WRITE(II,77091) NC 
      WRITE(II,1010) ZERO,ZERO,ZERO
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      WRITE(II,1000) NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA,NULA
      IF(INDM.GE.10.AND.INDM.LT.50) WRITE(II,1000) NULA,NULA,M4,M8
      IF(INDM.GE.50.AND.INDM.LT.99) WRITE(II,1000) NULA,NULA,M5,M8
      WRITE(II,1000) NULA,NULA,NULA
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
      ENDIF
      IF(NCVE.EQ.8.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.2) THEN
         IF(NC.EQ.1) IJ=NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.2) IJ=NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=NGAUSY*NGAUSZ+NGAUSZ+2
         IF(NC.EQ.6) IJ=NGAUSZ+2
         IF(NC.EQ.7) IJ=2
         IF(NC.EQ.8) IJ=NGAUSY*NGAUSZ+2
         IF(NC.EQ.9) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSZ+1
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-(NGAUSZ+1)
            JI=1
         ENDIF
         IF(NC.EQ.11) THEN
            IJ=-1
            JI=NGAUSY*NGAUSZ+1
         ENDIF
         IF(NC.EQ.12) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+1
         ENDIF
         IF(NC.EQ.13) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
         IF(NC.EQ.14) THEN
            IJ=-(NGAUSZ+1)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.15) THEN
            IJ=-1
            JI=2
         ENDIF
         IF(NC.EQ.16) THEN
            IJ=-(NGAUSY*NGAUSZ+1)
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.17) THEN
            IJ=-(NGAUSY*NGAUSZ+NGAUSZ+2)
            JI=NGAUSZ+2
         ENDIF
         IF(NC.EQ.18) THEN
            IJ=-(NGAUSZ+2)
            JI=2
         ENDIF
         IF(NC.EQ.19) THEN
            IJ=-2
            JI=NGAUSY*NGAUSZ+2
         ENDIF
         IF(NC.EQ.20) THEN
            IJ=-(NGAUSY*NGAUSZ+2)
            JI=NGAUSY*NGAUSZ+NGAUSZ+2
         ENDIF
      ENDIF
      IF(NCVE.EQ.20.AND.NGAUSX.EQ.3) THEN
         IF(NC.EQ.1) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.2) IJ=2*NGAUSZ+1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=2*NGAUSY*NGAUSZ+1
         IF(NC.EQ.5) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.6) IJ=2*NGAUSZ+3
         IF(NC.EQ.7) IJ=3
         IF(NC.EQ.8) IJ=2*NGAUSY*NGAUSZ+3
         IF(NC.EQ.9) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+1
         IF(NC.EQ.10) IJ=NGAUSZ+1
         IF(NC.EQ.11) IJ=NGAUSY*NGAUSZ+1
         IF(NC.EQ.12) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+1
         IF(NC.EQ.13) IJ=2*NGAUSY*NGAUSZ+2*NGAUSZ+2
         IF(NC.EQ.14) IJ=2*NGAUSZ+2
         IF(NC.EQ.15) IJ=2
         IF(NC.EQ.16) IJ=2*NGAUSY*NGAUSZ+2
         IF(NC.EQ.17) IJ=NGAUSY*NGAUSZ+2*NGAUSZ+3
         IF(NC.EQ.18) IJ=NGAUSZ+3
         IF(NC.EQ.19) IJ=NGAUSY*NGAUSZ+3
         IF(NC.EQ.20) IJ=2*NGAUSY*NGAUSZ+NGAUSZ+3
      ENDIF
      IF(IPODT.EQ.3) THEN
      IF(NCVE.EQ.4.AND.NGAUSX.EQ.1) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=1
         IF(NC.EQ.3) IJ=1
         IF(NC.EQ.4) IJ=1
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.4) THEN
         IF(NC.EQ.1) IJ=1
         IF(NC.EQ.2) IJ=2
         IF(NC.EQ.3) IJ=3
         IF(NC.EQ.4) IJ=4
         IF(NC.EQ.5) THEN
            IJ=-1
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-2
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-1
            JI= 3
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-1
            JI= 4
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-3
            JI= 4
         ENDIF
      ENDIF
      IF(NCVE.EQ.10.AND.NGAUSX.EQ.5) THEN
         IF(NC.EQ.1) IJ=2
         IF(NC.EQ.2) IJ=3
         IF(NC.EQ.3) IJ=4
         IF(NC.EQ.4) IJ=5
         IF(NC.EQ.5) THEN
            IJ=-3
            JI= 2
         ENDIF
         IF(NC.EQ.6) THEN
            IJ=-4
            JI= 3
         ENDIF
         IF(NC.EQ.7) THEN
            IJ=-2
            JI= 4
         ENDIF
         IF(NC.EQ.8) THEN
            IJ=-2
            JI= 5
         ENDIF
         IF(NC.EQ.9) THEN
            IJ=-3
            JI= 5
         ENDIF
         IF(NC.EQ.10) THEN
            IJ=-5
            JI= 4
         ENDIF
      ENDIF
      ENDIF      
      DO 20 NLM=1,NE
C
CS       NASTAJANJE I NESTAJANJE ELEMENATA
CE       ELEMENT BIRTH AND DEATH OPTION
C
         IBD=0
         CALL DTHBTH(AU(LTBTH),AU(LTDTH),VREME,NLM,IBD)
         IF(IBD.EQ.1) GO TO 20
C
         NMM=NLM
         IF(ICVEL.EQ.1) NMM=MCVEL(NLM)
         IF(IPLA.EQ.0) THEN
            IF(KK.EQ.1) THEN
               IF(IND.EQ.60010.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(1,IJ,NLM,1)
               ELSEIF(IND.EQ.60010.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(1,-IJ,NLM,1)+SIGMA(1,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60011.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(2,IJ,NLM,1)
               ELSEIF(IND.EQ.60011.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(2,-IJ,NLM,1)+SIGMA(2,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60012.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(3,IJ,NLM,1)
               ELSEIF(IND.EQ.60012.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(3,-IJ,NLM,1)+SIGMA(3,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60013.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(4,IJ,NLM,1)
               ELSEIF(IND.EQ.60013.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(4,-IJ,NLM,1)+SIGMA(4,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60014.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(5,IJ,NLM,1)
               ELSEIF(IND.EQ.60014.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(5,-IJ,NLM,1)+SIGMA(5,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60015.AND.IJ.GT.0) THEN
                  WRITE(II,5000) NMM,SIGMA(6,IJ,NLM,1)
               ELSEIF(IND.EQ.60015.AND.IJ.LT.0) THEN
                  POLA=(SIGMA(6,-IJ,NLM,1)+SIGMA(6,JI,NLM,1))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
               IF(IND.EQ.60031.AND.IJ.GT.0) THEN
                  XMY=SIGMA(1,IJ,NLM,1)-SIGMA(2,IJ,NLM,1)
                  YMZ=SIGMA(2,IJ,NLM,1)-SIGMA(3,IJ,NLM,1)
                  ZMX=SIGMA(3,IJ,NLM,1)-SIGMA(1,IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,IJ,NLM,1)*SIGMA(4,IJ,NLM,1)+
     1                       SIGMA(5,IJ,NLM,1)*SIGMA(5,IJ,NLM,1)+
     1                       SIGMA(6,IJ,NLM,1)*SIGMA(6,IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSEIF(IND.EQ.60031.AND.IJ.LT.0) THEN
                  XMY=SIGMA(1,-IJ,NLM,1)-SIGMA(2,-IJ,NLM,1)
                  YMZ=SIGMA(2,-IJ,NLM,1)-SIGMA(3,-IJ,NLM,1)
                  ZMX=SIGMA(3,-IJ,NLM,1)-SIGMA(1,-IJ,NLM,1)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,-IJ,NLM,1)*SIGMA(4,-IJ,NLM,1)+
     1                       SIGMA(5,-IJ,NLM,1)*SIGMA(5,-IJ,NLM,1)+
     1                       SIGMA(6,-IJ,NLM,1)*SIGMA(6,-IJ,NLM,1))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  XMY=SIGMA(1,JI,NLM,1)-SIGMA(2,JI,NLM,1)
                  YMZ=SIGMA(2,JI,NLM,1)-SIGMA(3,JI,NLM,1)
                  ZMX=SIGMA(3,JI,NLM,1)-SIGMA(1,JI,NLM,1)
                  EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1                 3.D0*(SIGMA(4,JI,NLM,1)*SIGMA(4,JI,NLM,1)+
     1                       SIGMA(5,JI,NLM,1)*SIGMA(5,JI,NLM,1)+
     1                       SIGMA(6,JI,NLM,1)*SIGMA(6,JI,NLM,1))
                  IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                  EFEK=(EFEK+EFE1)/2
                  WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF   
         ELSE
            LL=KK+(NLM-1)*NGXYZ
            IF(IND.EQ.60010.OR.IND.EQ.60050.OR.IND.EQ.60066.OR.
     1         IND.EQ.60091.OR.IND.EQ.60092.OR.IND.EQ.60093.OR.
     1         IND.EQ.60094) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(LL+(-IJ-1)*NPROS)+PLAST(LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60011.OR.IND.EQ.60051.OR.IND.EQ.60067) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(1+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(1+LL+(-IJ-1)*NPROS)+PLAST(1+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60012.OR.IND.EQ.60052.OR.IND.EQ.60068) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(2+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(2+LL+(-IJ-1)*NPROS)+PLAST(2+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60013.OR.IND.EQ.60053.OR.IND.EQ.60069) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(3+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(3+LL+(-IJ-1)*NPROS)+PLAST(3+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60014.OR.IND.EQ.60054.OR.IND.EQ.60070) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(4+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(4+LL+(-IJ-1)*NPROS)+PLAST(4+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60015.OR.IND.EQ.60055.OR.IND.EQ.60071) THEN
               IF(IJ.GT.0) THEN
                  WRITE(II,5000) NMM,PLAST(5+LL+(IJ-1)*NPROS)
               ELSE
             POLA=(PLAST(5+LL+(-IJ-1)*NPROS)+PLAST(5+LL+(JI-1)*NPROS))/2
                  WRITE(II,5000) NMM,POLA
               ENDIF
            ENDIF
            IF(IND.EQ.60031.OR.IND.EQ.60061.OR.IND.EQ.60072) THEN
               IF(IJ.GT.0) THEN
                  XMY=PLAST(  LL+(IJ-1)*NPROS)-PLAST(1+LL+(IJ-1)*NPROS)
                  YMZ=PLAST(1+LL+(IJ-1)*NPROS)-PLAST(2+LL+(IJ-1)*NPROS)
                  ZMX=PLAST(2+LL+(IJ-1)*NPROS)-PLAST(  LL+(IJ-1)*NPROS)
                  EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(IJ-1)*NPROS)*PLAST(3+LL+(IJ-1)*NPROS)+
     1                PLAST(4+LL+(IJ-1)*NPROS)*PLAST(4+LL+(IJ-1)*NPROS)+
     1                PLAST(5+LL+(IJ-1)*NPROS)*PLAST(5+LL+(IJ-1)*NPROS))
                  IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                  WRITE(II,5000) NMM,EFEK
               ELSE
                 XMY=PLAST(  LL+(-IJ-1)*NPROS)-PLAST(1+LL+(-IJ-1)*NPROS)
                 YMZ=PLAST(1+LL+(-IJ-1)*NPROS)-PLAST(2+LL+(-IJ-1)*NPROS)
                 ZMX=PLAST(2+LL+(-IJ-1)*NPROS)-PLAST(  LL+(-IJ-1)*NPROS)
                 EFEK=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1        3.D0*(PLAST(3+LL+(-IJ-1)*NPROS)*PLAST(3+LL+(-IJ-1)*NPROS)+
     1              PLAST(4+LL+(-IJ-1)*NPROS)*PLAST(4+LL+(-IJ-1)*NPROS)+
     1              PLAST(5+LL+(-IJ-1)*NPROS)*PLAST(5+LL+(-IJ-1)*NPROS))
                   IF(EFEK.GT.1.D-19) EFEK=DSQRT(EFEK)
                   XMY=PLAST(  LL+(JI-1)*NPROS)-PLAST(1+LL+(JI-1)*NPROS)
                   YMZ=PLAST(1+LL+(JI-1)*NPROS)-PLAST(2+LL+(JI-1)*NPROS)
                   ZMX=PLAST(2+LL+(JI-1)*NPROS)-PLAST(  LL+(JI-1)*NPROS)
                   EFE1=0.5D0*(XMY*XMY+YMZ*YMZ+ZMX*ZMX)+
     1          3.D0*(PLAST(3+LL+(JI-1)*NPROS)*PLAST(3+LL+(JI-1)*NPROS)+
     1                PLAST(4+LL+(JI-1)*NPROS)*PLAST(4+LL+(JI-1)*NPROS)+
     1                PLAST(5+LL+(JI-1)*NPROS)*PLAST(5+LL+(JI-1)*NPROS))
                   IF(EFE1.GT.1.D-19) EFE1=DSQRT(EFE1)
                   EFEK=(EFEK+EFE1)/2
                   WRITE(II,5000) NMM,EFEK
               ENDIF
            ENDIF
C
         ENDIF
   20 CONTINUE
      WRITE(II,5500) MJ,ZERO
   30 CONTINUE
C
   31 CONTINUE
      IF(KK.EQ.1.AND.INP.NE.0) THEN
         IF(IND.EQ.60010) GO TO  83
         IF(IND.EQ.60011) GO TO  84
         IF(IND.EQ.60012) GO TO  85
         IF(IND.EQ.60013) GO TO  86
         IF(IND.EQ.60014) GO TO  87
         IF(IND.EQ.60015) GO TO  88
         IF(IND.EQ.60031) GO TO 182
      ENDIF
      IF(KK.EQ.7.AND.INP.NE.0) THEN
         IF(IND.EQ.60050) GO TO 183
         IF(IND.EQ.60051) GO TO 184
         IF(IND.EQ.60052) GO TO 185
         IF(IND.EQ.60053) GO TO 186
         IF(IND.EQ.60054) GO TO 187
         IF(IND.EQ.60055) GO TO 188
         IF(IND.EQ.60061)THEN
            IF(NMODM.EQ.61)GO TO 388
            IF(NMODM.EQ.28)GO TO 999
            GO TO 282
         ENDIF
      ENDIF
      IF(IND.EQ.67091) GO TO 999
      IF(KK.EQ.15.AND.INP.NE.0) THEN
         IF(IND.EQ.60066) GO TO 283
         IF(IND.EQ.60067) GO TO 284
         IF(IND.EQ.60068) GO TO 285
         IF(IND.EQ.60069) GO TO 286
         IF(IND.EQ.60070) GO TO 287
         IF(IND.EQ.60071) GO TO 288
         IF(IND.EQ.60072) GO TO 382
      ENDIF
      IF(KK.EQ.21.AND.INP.NE.0) THEN
         IF(IND.EQ.60091) GO TO 383
      ENDIF
      IF(KK.EQ.22.AND.INP.NE.0) THEN
         IF(IND.EQ.60092) GO TO 384
      ENDIF   
      IF(KK.EQ.23.AND.INP.NE.0) THEN
         IF(IND.EQ.60093) GO TO 385
      ENDIF         
  999 RETURN
 1000 FORMAT(10(I7,','))
 1001 FORMAT(I6,',',F12.4,',')
60010 FORMAT('SOLID X NORMAL STRESS')
70010 FORMAT('SOLID NODE',I10,' X NORMAL STRESS')
60011 FORMAT('SOLID Y NORMAL STRESS')
70011 FORMAT('SOLID NODE',I10,' Y NORMAL STRESS')
60012 FORMAT('SOLID Z NORMAL STRESS')
70012 FORMAT('SOLID NODE',I10,' Z NORMAL STRESS')
60013 FORMAT('SOLID XY SHEAR STRESS')
70013 FORMAT('SOLID NODE',I10,' XY SHEAR STRESS')
60014 FORMAT('SOLID YZ SHEAR STRESS')
70014 FORMAT('SOLID NODE',I10,' YZ SHEAR STRESS')
60015 FORMAT('SOLID ZX SHEAR STRESS')
70015 FORMAT('SOLID NODE',I10,' ZX SHEAR STRESS')
60031 FORMAT('SOLID EQUIV STRESS')
70031 FORMAT('SOLID NODE',I10,' EQUIV STRESS')
60050 FORMAT('SOLID X NORMAL STRAIN')
70050 FORMAT('SOLID NODE',I10,' X NORMAL STRAIN')
60051 FORMAT('SOLID Y NORMAL STRAIN')
70051 FORMAT('SOLID NODE',I10,' Y NORMAL STRAIN')
60052 FORMAT('SOLID Z NORMAL STRAIN')
70052 FORMAT('SOLID NODE',I10,' Z NORMAL STRAIN')
60053 FORMAT('SOLID XY SHEAR STRAIN')
70053 FORMAT('SOLID NODE',I10,' XY SHEAR STRAIN')
60054 FORMAT('SOLID YZ SHEAR STRAIN')
70054 FORMAT('SOLID NODE',I10,' YZ SHEAR STRAIN')
60055 FORMAT('SOLID ZX SHEAR STRAIN')
70055 FORMAT('SOLID NODE',I10,' ZX SHEAR STRAIN')
60061 FORMAT('SOLID EQUIV STRAIN')
70061 FORMAT('SOLID NODE',I10,' EQUIV STRAIN')
60066 FORMAT('SOLID X NORMAL PLASTIC STRAIN')
70066 FORMAT('SOLID NODE',I10,' X NORMAL PLASTIC STRAIN')
60067 FORMAT('SOLID Y NORMAL PLASTIC STRAIN')
70067 FORMAT('SOLID NODE',I10,' Y NORMAL PLASTIC STRAIN')
60068 FORMAT('SOLID Z NORMAL PLASTIC STRAIN')
70068 FORMAT('SOLID NODE',I10,' Z NORMAL PLASTIC STRAIN')
60069 FORMAT('SOLID YZ SHEAR PLASTIC STRAIN')
70069 FORMAT('SOLID NODE',I10,' YZ SHEAR PLASTIC STRAIN')
60070 FORMAT('SOLID XZ SHEAR PLASTIC STRAIN')
70070 FORMAT('SOLID NODE',I10,' XZ SHEAR PLASTIC STRAIN')
60071 FORMAT('SOLID XY SHEAR PLASTIC STRAIN')
70071 FORMAT('SOLID NODE',I10,' XY SHEAR PLASTIC STRAIN')
60072 FORMAT('SOLID EQUIV PLASTIC STRAIN')
70072 FORMAT('SOLID NODE',I10,' EQUIV PLASTIC STRAIN')
60091 FORMAT('SOLID FAILURE DISTANCE TENSION')
70091 FORMAT('SOLID NODE',I10,' FAILURE DISTANCE TENSION')
60092 FORMAT('SOLID FAILURE DISTANCE COMPRESSION')
70092 FORMAT('SOLID NODE',I10,' FAILURE DISTANCE COMPRESSION')
60093 FORMAT('SOLID DEGRADATION')
70093 FORMAT('SOLID NODE',I10,' DEGRADATION')
60094 FORMAT('SOLID SF=D/(D-d) SAFETY FACTOR')
70094 FORMAT('SOLID NODE',I10,' SF=D/(D-d) SAFETY FACTOR')
! 60091 FORMAT('sSOLID X NORMAL TRANSFORMATION DIRECTION TENSOR')
! 70091 FORMAT('sSOLID NODE',I10,' X NORMAL TRANSFOR DIR. TENSOR')
! 60092 FORMAT('SOLID Y NORMAL TRANSFORMATION DIRECTION TENSOR')
! 70092 FORMAT('SOLID NODE',I10,' Y NORMAL TRANSFOR DIR. TENSOR')
! 60093 FORMAT('SOLID Z NORMAL TRANSFORMATION DIRECTION TENSOR')
! 70093 FORMAT('SOLID NODE',I10,' Z NORMAL TRANSFOR DIR. TENSOR')
! 60094 FORMAT('SOLID YZ SHEAR TRANSFORMATION DIRECTION TENSOR')
! 70094 FORMAT('SOLID NODE',I10,' YZ SHEAR TRANSFOR DIR. TENSOR')
! 60095 FORMAT('SOLID XZ SHEAR TRANSFORMATION DIRECTION TENSOR')
! 70095 FORMAT('SOLID NODE',I10,' XZ SHEAR TRANSFOR DIR. TENSOR')
! 60096 FORMAT('SOLID XY SHEAR TRANSFORMATION DIRECTION TENSOR')
! 70096 FORMAT('SOLID NODE',I10,' XY SHEAR TRANSFOR DIR. TENSOR')
67091 FORMAT('3D - DAMAGE')
77091 FORMAT('NODE',I10,' 3D-DAMAGE')
 1005 FORMAT('PAK CASE',I5)
 1006 FORMAT('CASE',I5,' TIME',1PE12.4)
 1010 FORMAT(3(1PE12.4,','))
 5000 FORMAT(I10,',',3(1PE12.4,','))
 5500 FORMAT(I2,',',3(1PE12.4,','))
      END
C=====================================================================        